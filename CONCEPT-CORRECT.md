# âœ… Duulair Correct Concept & Flow

**Last Updated:** 2025-01-17
**Status:** âœ… Confirmed - This is the CORRECT flow

---

## ğŸ¯ **Core Concept**

### **Main Flow: 1:1 Chat First**
Caregiver à¸ªà¸¡à¸±à¸„à¸£à¹à¸¥à¸°à¹ƒà¸Šà¹‰à¸‡à¸²à¸™à¸œà¹ˆà¸²à¸™ **LINE OA (1:1 chat)** à¹€à¸›à¹‡à¸™à¸«à¸¥à¸±à¸
Group à¹€à¸›à¹‡à¸™à¹€à¸à¸µà¸¢à¸‡ **optional feature** à¸ªà¸³à¸«à¸£à¸±à¸š family collaboration

---

## ğŸ“± **Complete User Journey**

### **Phase 1: Caregiver Registration (1:1)**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. Caregiver Add Friend à¸à¸±à¸š        â”‚
â”‚    Duulair LINE OA                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. Bot à¸ªà¹ˆà¸‡à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡à¸•à¹‰à¸­à¸™à¸£à¸±à¸š           â”‚
â”‚    à¸à¸£à¹‰à¸­à¸¡à¸¥à¸´à¸‡à¸à¹Œà¸¥à¸‡à¸—à¸°à¹€à¸šà¸µà¸¢à¸™              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. Caregiver à¸à¸”à¸¥à¸´à¸‡à¸à¹Œ â†’ LIFF à¹€à¸›à¸´à¸”   â”‚
â”‚    à¸à¸£à¸­à¸à¸Ÿà¸­à¸£à¹Œà¸¡ 1 à¸Ÿà¸­à¸£à¹Œà¸¡à¹€à¸”à¸µà¸¢à¸§:         â”‚
â”‚    â€¢ Caregiver Info (à¸•à¸±à¸§à¹€à¸­à¸‡)       â”‚
â”‚    â€¢ Patient Info (à¸œà¸¹à¹‰à¸›à¹ˆà¸§à¸¢)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. à¸šà¸±à¸™à¸—à¸¶à¸à¸¥à¸‡ Database:               â”‚
â”‚    âœ… users (caregiver)              â”‚
â”‚    âœ… caregiver_profiles             â”‚
â”‚    âœ… patient_profiles               â”‚
â”‚    âœ… patient_caregivers (link)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. âœ… à¸à¸£à¹‰à¸­à¸¡à¹ƒà¸Šà¹‰à¸‡à¸²à¸™!                  â”‚
â”‚    Caregiver à¹ƒà¸Šà¹‰ Rich Menu:        â”‚
â”‚    â€¢ à¸šà¸±à¸™à¸—à¸¶à¸à¸ªà¸¸à¸‚à¸ à¸²à¸                   â”‚
â”‚    â€¢ à¸”à¸¹à¸£à¸²à¸¢à¸‡à¸²à¸™                       â”‚
â”‚    â€¢ à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸œà¸¹à¹‰à¸›à¹ˆà¸§à¸¢                  â”‚
â”‚    â€¢ à¹à¸ˆà¹‰à¸‡à¹€à¸•à¸·à¸­à¸™                      â”‚
â”‚    â€¢ à¸¢à¸²                             â”‚
â”‚    â€¢ à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸²                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### **Phase 2: Using the System (1:1)**

**Caregiver à¸ªà¸²à¸¡à¸²à¸£à¸–à¸—à¸³à¹„à¸”à¹‰à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”à¸œà¹ˆà¸²à¸™ 1:1 chat:**

1. **à¸šà¸±à¸™à¸—à¸¶à¸à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ªà¸¸à¸‚à¸ à¸²à¸** - à¸„à¸§à¸²à¸¡à¸”à¸±à¸™, à¸™à¹‰à¸³à¸•à¸²à¸¥, à¸¢à¸², à¸™à¹‰à¸³, à¸­à¸²à¸«à¸²à¸£
2. **à¸”à¸¹à¸£à¸²à¸¢à¸‡à¸²à¸™** - à¸£à¸²à¸¢à¸§à¸±à¸™, à¸£à¸²à¸¢à¸ªà¸±à¸›à¸”à¸²à¸«à¹Œ
3. **à¸ˆà¸±à¸”à¸à¸²à¸£à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸œà¸¹à¹‰à¸›à¹ˆà¸§à¸¢** - à¸”à¸¹/à¹à¸à¹‰à¹„à¸‚ profile
4. **à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸²à¹à¸ˆà¹‰à¸‡à¹€à¸•à¸·à¸­à¸™** - à¹€à¸§à¸¥à¸²à¸à¸´à¸™à¸¢à¸², à¸”à¸·à¹ˆà¸¡à¸™à¹‰à¸³
5. **à¸ˆà¸±à¸”à¸à¸²à¸£à¸¢à¸²** - à¹€à¸à¸´à¹ˆà¸¡/à¸¥à¸š/à¹à¸à¹‰à¹„à¸‚à¸£à¸²à¸¢à¸à¸²à¸£à¸¢à¸²
6. **à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸²à¸£à¸°à¸šà¸š** - notifications, preferences

**Patient à¹„à¸¡à¹ˆà¸ˆà¸³à¹€à¸›à¹‡à¸™à¸•à¹‰à¸­à¸‡à¸¡à¸µ LINE account à¹ƒà¸™à¸Šà¹ˆà¸§à¸‡à¹à¸£à¸**

---

### **Phase 3: Optional Group Feature**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. Caregiver à¸ªà¸£à¹‰à¸²à¸‡ LINE Group      â”‚
â”‚    à¸ªà¸³à¸«à¸£à¸±à¸šà¸„à¸£à¸­à¸šà¸„à¸£à¸±à¸§                   â”‚
â”‚    (à¹€à¸Šà¹ˆà¸™ "à¸„à¸£à¸­à¸šà¸„à¸£à¸±à¸§à¸„à¸¸à¸“à¸¢à¸²à¸¢")          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. à¹€à¸Šà¸´à¸ Duulair Bot à¹€à¸‚à¹‰à¸²à¸à¸¥à¸¸à¹ˆà¸¡      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. Bot detect: Caregiver à¸¥à¸‡à¸—à¸°à¹€à¸šà¸µà¸¢à¸™ â”‚
â”‚    à¹à¸¥à¹‰à¸§à¸«à¸£à¸·à¸­à¸¢à¸±à¸‡?                     â”‚
â”‚                                     â”‚
â”‚    âœ… à¸¥à¸‡à¸—à¸°à¹€à¸šà¸µà¸¢à¸™à¹à¸¥à¹‰à¸§                 â”‚
â”‚    â†’ à¹€à¸Šà¸·à¹ˆà¸­à¸¡ group à¸à¸±à¸š patient       â”‚
â”‚    â†’ à¸à¸£à¹‰à¸­à¸¡à¹ƒà¸Šà¹‰à¸‡à¸²à¸™                    â”‚
â”‚                                     â”‚
â”‚    âŒ à¸¢à¸±à¸‡à¹„à¸¡à¹ˆà¸¥à¸‡à¸—à¸°à¹€à¸šà¸µà¸¢à¸™                â”‚
â”‚    â†’ à¸ªà¹ˆà¸‡à¸¥à¸´à¸‡à¸à¹Œà¸¥à¸‡à¸—à¸°à¹€à¸šà¸µà¸¢à¸™à¹ƒà¸™à¸à¸¥à¸¸à¹ˆà¸¡       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. âœ… Group à¸à¸£à¹‰à¸­à¸¡à¹ƒà¸Šà¹‰à¸‡à¸²à¸™!            â”‚
â”‚    Family members à¸ªà¸²à¸¡à¸²à¸£à¸–:          â”‚
â”‚    â€¢ à¸„à¸¸à¸¢à¸à¸±à¸š bot                     â”‚
â”‚    â€¢ à¸–à¸²à¸¡à¹€à¸à¸µà¹ˆà¸¢à¸§à¸à¸±à¸š patient           â”‚
â”‚    â€¢ à¸šà¸±à¸™à¸—à¸¶à¸à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ªà¸¸à¸‚à¸ à¸²à¸             â”‚
â”‚    â€¢ à¸”à¸¹à¸£à¸²à¸¢à¸‡à¸²à¸™ (read-only)          â”‚
â”‚                                     â”‚
â”‚    âŒ à¹à¸•à¹ˆà¸—à¸³à¹„à¸¡à¹ˆà¹„à¸”à¹‰:                  â”‚
â”‚    â€¢ à¹à¸à¹‰à¹„à¸‚à¸‚à¹‰à¸­à¸¡à¸¹à¸¥ patient            â”‚
â”‚    â€¢ à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸²à¸£à¸°à¸šà¸š                    â”‚
â”‚    â€¢ à¸ˆà¸±à¸”à¸à¸²à¸£à¸¢à¸²                       â”‚
â”‚    â†’ à¸•à¹‰à¸­à¸‡à¸—à¸³à¸œà¹ˆà¸²à¸™ caregiver 1:1      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ—„ï¸ **Database Schema Analysis**

### âœ… **Schema à¸£à¸­à¸‡à¸£à¸±à¸š concept à¸™à¸µà¹‰à¹à¸¥à¹‰à¸§:**

#### **1. Core Tables (1:1 Flow)**

```sql
-- Caregiver à¸ªà¸¡à¸±à¸„à¸£
users (line_user_id, role='caregiver')
  â†“
caregiver_profiles (user_id, first_name, last_name)

-- Caregiver à¸ªà¸£à¹‰à¸²à¸‡ patient
patient_profiles (id, first_name, last_name)
  â†‘ user_id NULLABLE - patient à¹„à¸¡à¹ˆà¸•à¹‰à¸­à¸‡à¸¡à¸µ LINE âœ…

-- à¹€à¸Šà¸·à¹ˆà¸­à¸¡à¸•à¹ˆà¸­à¸à¸±à¸™
patient_caregivers (patient_id, caregiver_id)
  â†‘ à¹„à¸¡à¹ˆà¸•à¹‰à¸­à¸‡à¸œà¹ˆà¸²à¸™ group âœ…
```

#### **2. Optional Group Tables**

```sql
-- à¸–à¹‰à¸²à¸¡à¸µ group (optional)
groups (line_group_id, patient_id, primary_caregiver_id)
  â†“
group_members (group_id, line_user_id, role)
  â†“
activity_logs (group_id, actor_line_user_id)
  â†‘ track à¸§à¹ˆà¸²à¹ƒà¸„à¸£à¹ƒà¸™ group log à¸‚à¹‰à¸­à¸¡à¸¹à¸¥ âœ…
```

### âœ… **Key Features Schema à¸£à¸­à¸‡à¸£à¸±à¸š:**

| Feature | Table | Support |
|---------|-------|---------|
| Caregiver 1:1 registration | users, caregiver_profiles | âœ… |
| Patient without LINE | patient_profiles.user_id NULLABLE | âœ… |
| Caregiver-Patient link | patient_caregivers | âœ… |
| Optional group | groups (can be NULL) | âœ… |
| Group activity tracking | activity_logs.group_id | âœ… |
| Actor tracking | activity_logs.actor_line_user_id | âœ… |

---

## ğŸ¨ **Rich Menu (6 Buttons)**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“ à¸šà¸±à¸™à¸—à¸¶à¸à¸ªà¸¸à¸‚à¸ à¸²à¸  â”‚   ğŸ“Š à¸”à¸¹à¸£à¸²à¸¢à¸‡à¸²à¸™     â”‚  ğŸ‘¤ à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸œà¸¹à¹‰à¸›à¹ˆà¸§à¸¢  â”‚
â”‚  Quick Reply     â”‚  à¸£à¸²à¸¢à¸§à¸±à¸™/à¸ªà¸±à¸›à¸”à¸²à¸«à¹Œ   â”‚  à¸”à¸¹/à¹à¸à¹‰à¹„à¸‚ LIFF   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ”” à¹à¸ˆà¹‰à¸‡à¹€à¸•à¸·à¸­à¸™     â”‚   ğŸ’Š à¸¢à¸²          â”‚  âš™ï¸ à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸²       â”‚
â”‚  à¹€à¸§à¸¥à¸²à¹€à¸•à¸·à¸­à¸™ LIFF  â”‚  à¸£à¸²à¸¢à¸à¸²à¸£à¸¢à¸² LIFF   â”‚  à¸à¸²à¸£à¹à¸ˆà¹‰à¸‡à¹€à¸•à¸·à¸­à¸™    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### **First-time User Detection:**

```javascript
// à¸—à¸¸à¸ Rich Menu button à¸•à¹‰à¸­à¸‡à¹€à¸Šà¹‡à¸„à¸à¹ˆà¸­à¸™
async function handleMenuClick(userId, action) {
  // 1. à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸§à¹ˆà¸² user à¸¥à¸‡à¸—à¸°à¹€à¸šà¸µà¸¢à¸™à¹à¸¥à¹‰à¸§à¸«à¸£à¸·à¸­à¸¢à¸±à¸‡
  const user = await checkUserExists(userId);

  if (!user.exists) {
    // 2. à¸¢à¸±à¸‡à¹„à¸¡à¹ˆà¸¥à¸‡à¸—à¸°à¹€à¸šà¸µà¸¢à¸™ â†’ redirect to registration
    return sendRegistrationLink(userId);
  }

  // 3. à¸¥à¸‡à¸—à¸°à¹€à¸šà¸µà¸¢à¸™à¹à¸¥à¹‰à¸§ â†’ à¸—à¸³à¸‡à¸²à¸™à¸•à¸²à¸¡ action
  if (action === 'patient-profile') {
    return openPatientProfileLIFF(userId);
  }
  // ... other actions
}
```

---

## ğŸ” **Permission Model**

### **Caregiver (1:1 Chat)**
- âœ… Full control over patient data
- âœ… Create/Read/Update patient profile
- âœ… Manage medications
- âœ… Configure notifications
- âœ… View all reports
- âœ… System settings

### **Group Members (Family)**
- âœ… Read patient info
- âœ… Log health activities (with actor tracking)
- âœ… Ask bot questions
- âœ… View reports
- âŒ Cannot edit patient profile
- âŒ Cannot manage medications
- âŒ Cannot change settings

**Rule:** Setup/Management = Caregiver 1:1 only

---

## ğŸ“Š **Data Flow**

### **Scenario 1: Caregiver logs medication (1:1)**
```sql
INSERT INTO activity_logs (
  patient_id,
  task_type = 'medication',
  source = '1:1',
  actor_line_user_id = caregiver_line_id,
  group_id = NULL  -- no group
)
```

### **Scenario 2: Family member logs medication (Group)**
```sql
INSERT INTO activity_logs (
  patient_id,
  task_type = 'medication',
  source = 'group',
  actor_line_user_id = family_member_line_id,
  actor_display_name = 'à¸¥à¸¹à¸à¸Šà¸²à¸¢',
  group_id = 'C123...'  -- has group
)
```

### **Scenario 3: Caregiver views report**
```sql
SELECT * FROM activity_logs
WHERE patient_id = ?
AND (source = '1:1' OR source = 'group')
-- Shows ALL activities from both sources
```

---

## âŒ **Common Misunderstandings**

| âŒ Wrong | âœ… Correct |
|---------|-----------|
| Group à¹€à¸›à¹‡à¸™ starting point | 1:1 Chat à¹€à¸›à¹‡à¸™ starting point |
| à¸•à¹‰à¸­à¸‡à¸ªà¸£à¹‰à¸²à¸‡ group à¸à¹ˆà¸­à¸™ | Group à¹€à¸›à¹‡à¸™ optional |
| Patient à¸•à¹‰à¸­à¸‡à¸¡à¸µ LINE | Patient à¹„à¸¡à¹ˆà¸ˆà¸³à¹€à¸›à¹‡à¸™à¸•à¹‰à¸­à¸‡à¸¡à¸µ LINE |
| Link code à¸ªà¸³à¸«à¸£à¸±à¸š caregiver-patient | Link code deprecated (à¹„à¸¡à¹ˆà¹ƒà¸Šà¹‰à¹à¸¥à¹‰à¸§) |
| Registration à¸•à¹‰à¸­à¸‡à¸¡à¸µ groupId | Registration à¹ƒà¸™ 1:1 (à¹„à¸¡à¹ˆà¸•à¹‰à¸­à¸‡à¸¡à¸µ groupId) |

---

## ğŸ› ï¸ **Implementation Checklist**

### **âœ… Already Done:**
- [x] Schema supports 1:1 registration
- [x] patient_profiles.user_id NULLABLE
- [x] patient_caregivers table
- [x] groups optional
- [x] activity_logs actor tracking

### **âŒ Need to Fix:**

- [ ] **handleFollow()** - à¹€à¸à¸´à¹ˆà¸¡à¸¥à¸´à¸‡à¸à¹Œà¸¥à¸‡à¸—à¸°à¹€à¸šà¸µà¸¢à¸™
- [ ] **Registration flow** - à¸—à¸³à¹ƒà¸«à¹‰ groupId à¹€à¸›à¹‡à¸™ optional
- [ ] **localStorage** - à¸šà¸±à¸™à¸—à¸¶à¸ caregiver_id à¹à¸—à¸™ patient_id
- [ ] **patient-profile.html** - à¹‚à¸«à¸¥à¸”à¸ˆà¸²à¸ caregiver â†’ patient
- [ ] **Rich Menu buttons** - first-time detection
- [ ] **TASK-002.md** - update flow diagram

---

## ğŸ“ **Next Steps**

1. âœ… à¸­à¹ˆà¸²à¸™ concept à¸™à¸µà¹‰à¹ƒà¸«à¹‰à¹€à¸‚à¹‰à¸²à¹ƒà¸ˆ
2. à¹à¸à¹‰à¹„à¸‚ handleFollow() à¹ƒà¸«à¹‰à¸ªà¹ˆà¸‡à¸¥à¸´à¸‡à¸à¹Œà¸¥à¸‡à¸—à¸°à¹€à¸šà¸µà¸¢à¸™
3. à¹à¸à¹‰à¹„à¸‚ registration flow (1:1 first)
4. à¹à¸à¹‰à¹„à¸‚ patient-profile.html
5. à¸—à¸”à¸ªà¸­à¸š 1:1 flow
6. à¸—à¸”à¸ªà¸­à¸š group feature (optional)

---

**Remember:**
- 1:1 = Main flow (Caregiver manages everything)
- Group = Optional add-on (Family helps log data)
- Setup/Management = Caregiver 1:1 only

**Document Version:** 1.0.0
**Last Updated:** 2025-01-17

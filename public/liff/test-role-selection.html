<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Test Role Selection</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      max-width: 600px;
      margin: 0 auto;
    }
    .role-card {
      border: 2px solid #ccc;
      padding: 20px;
      margin: 10px 0;
      border-radius: 10px;
      cursor: pointer;
      transition: all 0.3s;
    }
    .role-card:hover {
      border-color: #4CAF50;
      background: #f0f0f0;
    }
    button {
      width: 100%;
      padding: 15px;
      margin: 10px 0;
      font-size: 16px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
    }
    .btn-primary {
      background: #4CAF50;
      color: white;
    }
    .btn-secondary {
      background: #2196F3;
      color: white;
    }
    #logs {
      margin-top: 20px;
      padding: 10px;
      background: #f5f5f5;
      border: 1px solid #ddd;
      border-radius: 5px;
      max-height: 300px;
      overflow-y: auto;
      font-family: monospace;
      font-size: 12px;
    }
    .log-entry {
      margin: 2px 0;
    }
  </style>
</head>
<body>
  <h1>üß™ Test Role Selection</h1>

  <div>
    <h2>Cards:</h2>
    <div class="role-card" id="patientCard" style="opacity: 0.5;">
      <h3>üë¥ ‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢</h3>
      <p>‡∏â‡∏±‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á</p>
    </div>

    <div class="role-card" id="caregiverCard" style="opacity: 0.5;">
      <h3>üë®‚Äçüë©‚Äçüëß ‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•</h3>
      <p>‡∏â‡∏±‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏î‡∏π‡πÅ‡∏•‡πÅ‡∏•‡∏∞‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏ô‡πÉ‡∏ô‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß</p>
    </div>
  </div>

  <div id="actionButtons" style="display: none;">
    <h2>Buttons:</h2>
    <button class="btn-primary" onclick="selectRole('patient')" id="patientBtn">
      ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢
    </button>
    <button class="btn-secondary" onclick="selectRole('caregiver')" id="caregiverBtn">
      ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•
    </button>
  </div>

  <div>
    <h2>Controls:</h2>
    <button onclick="testEnableRoleSelection()" style="background: #FF9800; color: white;">
      üé® Enable Role Selection
    </button>
    <button onclick="clearLogs()" style="background: #f44336; color: white;">
      üóëÔ∏è Clear Logs
    </button>
  </div>

  <div id="logs">
    <div class="log-entry">üìã Console logs will appear here...</div>
  </div>

  <script>
    // Mock liffProfile for testing
    let liffProfile = null;

    function log(message) {
      const logsDiv = document.getElementById('logs');
      const entry = document.createElement('div');
      entry.className = 'log-entry';
      entry.textContent = `${new Date().toLocaleTimeString()} - ${message}`;
      logsDiv.appendChild(entry);
      logsDiv.scrollTop = logsDiv.scrollHeight;
      console.log(message);
    }

    function clearLogs() {
      document.getElementById('logs').innerHTML = '<div class="log-entry">üìã Logs cleared</div>';
    }

    function testEnableRoleSelection() {
      log('üé® Testing enableRoleSelection()...');

      // Mock LIFF profile
      liffProfile = {
        userId: 'TEST_USER_123',
        displayName: 'Test User',
        pictureUrl: 'https://example.com/pic.jpg'
      };
      log('‚úÖ Mock LIFF profile created: ' + JSON.stringify(liffProfile));

      enableRoleSelection();
    }

    function enableRoleSelection() {
      log('üé® Enabling role selection...');

      const patientCard = document.getElementById('patientCard');
      const caregiverCard = document.getElementById('caregiverCard');

      log('üìã Patient card: ' + (patientCard ? 'Found' : 'NOT FOUND'));
      log('üìã Caregiver card: ' + (caregiverCard ? 'Found' : 'NOT FOUND'));

      if (patientCard) {
        patientCard.style.opacity = '1';
        patientCard.onclick = () => {
          log('üñ±Ô∏è Patient card clicked');
          selectRole('patient');
        };
        log('‚úÖ Patient card enabled');
      }

      if (caregiverCard) {
        caregiverCard.style.opacity = '1';
        caregiverCard.onclick = () => {
          log('üñ±Ô∏è Caregiver card clicked');
          selectRole('caregiver');
        };
        log('‚úÖ Caregiver card enabled');
      }

      const actionButtons = document.getElementById('actionButtons');
      log('üîò Action buttons: ' + (actionButtons ? 'Found' : 'NOT FOUND'));

      if (actionButtons) {
        actionButtons.style.display = 'block';
        log('‚úÖ Action buttons displayed');
      }

      log('‚úÖ Role selection enabled complete');
    }

    function selectRole(role) {
      log('üéØ selectRole called with: ' + role);
      log('üë§ Current LIFF Profile: ' + JSON.stringify(liffProfile));

      if (!liffProfile) {
        log('‚ùå LIFF Profile not loaded');
        alert('LIFF Profile not loaded - Click "Enable Role Selection" first');
        return;
      }

      log('üíæ Would save to sessionStorage: role=' + role);
      log('üìç Would redirect to: /liff/' + role + '-registration.html');

      alert(`‚úÖ Success!\nRole: ${role}\nWould redirect to: /liff/${role}-registration.html`);
    }

    // Auto-log page load
    window.addEventListener('DOMContentLoaded', () => {
      log('üìÑ Page loaded');
      log('üîç Testing elements...');
      log('  - patientCard: ' + (document.getElementById('patientCard') ? 'Found' : 'NOT FOUND'));
      log('  - caregiverCard: ' + (document.getElementById('caregiverCard') ? 'Found' : 'NOT FOUND'));
      log('  - actionButtons: ' + (document.getElementById('actionButtons') ? 'Found' : 'NOT FOUND'));
      log('  - patientBtn: ' + (document.getElementById('patientBtn') ? 'Found' : 'NOT FOUND'));
      log('  - caregiverBtn: ' + (document.getElementById('caregiverBtn') ? 'Found' : 'NOT FOUND'));
      log('‚úÖ Ready to test!');
    });
  </script>
</body>
</html>

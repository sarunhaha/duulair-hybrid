import{r as q,j as e}from"./vendor-query-OvJu5Khy.js";import{y as P,a2 as z,Q as I,ac as M,g as d,W as g,L as j,e as n,f as i,M as N,a3 as T,E as r,I as v,S as E,ad as H,a as O,J as D,$ as A}from"./index-BGVZEKvN.js";import"./vendor-react-qkC6yhPU.js";import"./vendor-ui-CtDXHM8m.js";const F=[{value:"poor",label:"‡πÅ‡∏¢‡πà",score:1,icon:"üò¥",color:"bg-red-100 text-red-600 border-red-300"},{value:"fair",label:"‡∏û‡∏≠‡πÉ‡∏ä‡πâ",score:2,icon:"üòê",color:"bg-yellow-100 text-yellow-600 border-yellow-300"},{value:"good",label:"‡∏î‡∏µ",score:3,icon:"üòä",color:"bg-green-100 text-green-600 border-green-300"},{value:"excellent",label:"‡∏î‡∏µ‡∏°‡∏≤‡∏Å",score:4,icon:"üòÑ",color:"bg-emerald-100 text-emerald-600 border-emerald-300"}],Q=[{value:4,label:"4 ‡∏ä‡∏°."},{value:5,label:"5 ‡∏ä‡∏°."},{value:6,label:"6 ‡∏ä‡∏°."},{value:7,label:"7 ‡∏ä‡∏°."},{value:8,label:"8 ‡∏ä‡∏°."},{value:9,label:"9 ‡∏ä‡∏°."},{value:10,label:"10+ ‡∏ä‡∏°."}],R={sleep_hours:null,sleep_quality:"",sleep_quality_score:null,sleep_time:"22:00",wake_time:"06:00",notes:""};function W(){const[,m]=P(),{isLoading:f,ensurePatient:w}=z(),{toast:c}=I(),x=M(),[a,o]=q.useState(R),u=(s,l)=>{const[t,C]=s.split(":").map(Number),[S,L]=l.split(":").map(Number);let b=t*60+C,p=S*60+L;return p<b&&(p+=1440),Math.round((p-b)/60*10)/10},h=(s,l)=>{const t={...a,[s]:l};t.sleep_time&&t.wake_time&&(t.sleep_hours=u(t.sleep_time,t.wake_time)),o(t)},_=s=>{o(l=>({...l,sleep_quality:s.value,sleep_quality_score:s.score}))},y=s=>{o(l=>({...l,sleep_hours:s}))},k=async()=>{if(!a.sleep_hours&&!a.sleep_time){c({title:"‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á‡∏ô‡∏≠‡∏ô",variant:"destructive"});return}try{const s=await w();if(!s){c({title:"‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå‡πÑ‡∏î‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á",variant:"destructive"});return}await x.mutateAsync({patientId:s,sleep_hours:a.sleep_hours||void 0,sleep_quality:a.sleep_quality||void 0,sleep_quality_score:a.sleep_quality_score||void 0,sleep_time:a.sleep_time||void 0,wake_time:a.wake_time||void 0,notes:a.notes||void 0}),c({title:"‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ô‡∏≠‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß"}),m("/settings")}catch(s){console.error("Error logging sleep:",s),c({title:"‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏î‡πâ",variant:"destructive"})}};return f?e.jsxs("div",{className:"min-h-screen pb-8 font-sans bg-background",children:[e.jsxs("header",{className:"bg-card pt-12 pb-4 px-6 sticky top-0 z-20 flex items-center gap-4 border-b border-border",children:[e.jsx(d,{variant:"ghost",size:"icon",onClick:()=>m("/settings"),children:e.jsx(g,{className:"w-5 h-5"})}),e.jsx("h1",{className:"text-xl font-bold text-foreground flex-1",children:"‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ô‡∏≠‡∏ô"})]}),e.jsx("main",{className:"max-w-md mx-auto px-4 py-6",children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 space-y-3",children:[e.jsx(j,{className:"w-8 h-8 animate-spin text-primary"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î..."})]})})]}):e.jsxs("div",{className:"min-h-screen pb-8 font-sans bg-background",children:[e.jsxs("header",{className:"bg-card pt-12 pb-4 px-6 sticky top-0 z-20 flex items-center gap-4 border-b border-border",children:[e.jsx(d,{variant:"ghost",size:"icon",onClick:()=>m("/settings"),children:e.jsx(g,{className:"w-5 h-5"})}),e.jsx("h1",{className:"text-xl font-bold text-foreground flex-1",children:"‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ô‡∏≠‡∏ô"})]}),e.jsxs("main",{className:"max-w-md mx-auto px-4 py-6 space-y-4",children:[e.jsx(n,{className:"border-none shadow-lg bg-gradient-to-br from-indigo-500 to-purple-600 text-white overflow-hidden",children:e.jsxs(i,{className:"p-6 relative",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-white/10 rounded-full -translate-y-1/2 translate-x-1/2"}),e.jsxs("div",{className:"relative z-10 flex items-center gap-4",children:[e.jsx(N,{className:"w-12 h-12"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-white/80",children:"‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ô‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏ö"}),e.jsx("p",{className:"text-2xl font-bold",children:a.sleep_hours?`${a.sleep_hours} ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á`:"‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•"})]})]})]})}),e.jsx(n,{className:"border-none shadow-sm bg-card",children:e.jsxs(i,{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{className:"w-5 h-5 text-primary"}),e.jsx(r,{className:"text-base font-bold",children:"‡πÄ‡∏ß‡∏•‡∏≤‡∏ô‡∏≠‡∏ô - ‡πÄ‡∏ß‡∏•‡∏≤‡∏ï‡∏∑‡πà‡∏ô"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-muted/30 rounded-xl p-4 space-y-2",children:[e.jsxs(r,{className:"text-sm text-muted-foreground flex items-center gap-2",children:[e.jsx(N,{className:"w-4 h-4 text-indigo-500"}),e.jsx("span",{children:"‡πÄ‡∏Ç‡πâ‡∏≤‡∏ô‡∏≠‡∏ô"})]}),e.jsx(v,{type:"time",value:a.sleep_time,onChange:s=>h("sleep_time",s.target.value),className:"text-xl h-12 font-medium"})]}),e.jsxs("div",{className:"bg-muted/30 rounded-xl p-4 space-y-2",children:[e.jsxs(r,{className:"text-sm text-muted-foreground flex items-center gap-2",children:[e.jsx(E,{className:"w-4 h-4 text-amber-500"}),e.jsx("span",{children:"‡∏ï‡∏∑‡πà‡∏ô‡∏ô‡∏≠‡∏ô"})]}),e.jsx(v,{type:"time",value:a.wake_time,onChange:s=>h("wake_time",s.target.value),className:"text-xl h-12 font-medium"})]})]}),a.sleep_time&&a.wake_time&&e.jsxs("div",{className:"text-center p-4 bg-primary/10 rounded-xl",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"‡∏£‡∏ß‡∏°‡πÄ‡∏ß‡∏•‡∏≤‡∏ô‡∏≠‡∏ô"}),e.jsxs("p",{className:"text-3xl font-bold text-primary",children:[u(a.sleep_time,a.wake_time)," ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á"]})]})]})}),e.jsx(n,{className:"border-none shadow-sm bg-card",children:e.jsxs(i,{className:"p-4 space-y-3",children:[e.jsx(r,{className:"text-base font-bold",children:"‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Q.map(s=>e.jsx(d,{type:"button",variant:a.sleep_hours===s.value?"default":"outline",size:"sm",onClick:()=>y(s.value),children:s.label},s.value))})]})}),e.jsx(n,{className:"border-none shadow-sm bg-card",children:e.jsxs(i,{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(H,{className:"w-5 h-5 text-primary"}),e.jsx(r,{className:"text-base font-bold",children:"‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏£‡∏ô‡∏≠‡∏ô"})]}),e.jsx("div",{className:"grid grid-cols-4 gap-2",children:F.map(s=>e.jsxs("button",{type:"button",onClick:()=>_(s),className:O("p-3 rounded-xl border-2 transition-all flex flex-col items-center gap-1",a.sleep_quality===s.value?s.color+" border-current":"bg-muted/50 border-transparent hover:bg-muted"),children:[e.jsx("span",{className:"text-2xl",children:s.icon}),e.jsx("span",{className:"text-xs font-medium",children:s.label})]},s.value))})]})}),e.jsx(n,{className:"border-none shadow-sm bg-card",children:e.jsxs(i,{className:"p-4 space-y-2",children:[e.jsx(r,{className:"text-base font-bold",children:"‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)"}),e.jsx(D,{value:a.notes,onChange:s=>o(l=>({...l,notes:s.target.value})),placeholder:"‡πÄ‡∏ä‡πà‡∏ô ‡∏ï‡∏∑‡πà‡∏ô‡∏Å‡∏•‡∏≤‡∏á‡∏î‡∏∂‡∏Å 2 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á, ‡∏ù‡∏±‡∏ô‡∏£‡πâ‡∏≤‡∏¢",rows:2})]})}),e.jsxs(d,{className:"w-full gap-2",size:"lg",onClick:k,disabled:x.isPending,children:[x.isPending?e.jsx(j,{className:"w-5 h-5 animate-spin"}):e.jsx(A,{className:"w-5 h-5"}),"‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ô‡∏≠‡∏ô"]})]})]})}export{W as default};

import{r,j as e}from"./vendor-query-OvJu5Khy.js";import{c as ve,y as ke,Q as Ce,a2 as De,am as Se,an as Le,ao as Ee,ap as Pe,aq as Me,ar as Te,as as Ie,at as Fe,au as He,n as ne,_ as ie,P as T,av as I,M as de,aj as y,o as ze,g as o,aw as Oe,m as K,a as p,a9 as f,L as U,a3 as _e,a4 as Re,C as Z,e as Ae,f as Be,q as $,r as ee,s as te,t as se,v as ae,X as re,b as Ve,B as We,ax as qe,ay as Ge,az as Qe,aA as Xe,aB as Ye,aC as Je,aD as Ke,aE as Ue}from"./index-jn_wS4g5.js";import{C as Ze}from"./chevron-down-CaKKyVkx.js";import{C as $e}from"./clipboard-list-6M48qplZ.js";import"./vendor-react-qkC6yhPU.js";import"./vendor-ui-CYcp45lG.js";const et=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],tt=ve("ellipsis",et),le={vitals:{icon:y,color:"text-blue-500",bg:"bg-blue-50 dark:bg-blue-950/30"},health:{icon:y,color:"text-blue-500",bg:"bg-blue-50 dark:bg-blue-950/30"},sleep:{icon:de,color:"text-indigo-500",bg:"bg-indigo-50 dark:bg-indigo-950/30"},symptoms:{icon:I,color:"text-red-500",bg:"bg-red-50 dark:bg-red-950/30"},medications:{icon:T,color:"text-orange-500",bg:"bg-orange-50 dark:bg-orange-950/30"},meds:{icon:T,color:"text-orange-500",bg:"bg-orange-50 dark:bg-orange-950/30"},water:{icon:ie,color:"text-sky-500",bg:"bg-sky-50 dark:bg-sky-950/30"},exercise:{icon:ne,color:"text-purple-500",bg:"bg-purple-50 dark:bg-purple-950/30"}},oe=[{id:7,label:"7 วัน",shortLabel:"7 วัน"},{id:14,label:"14 วัน",shortLabel:"14 วัน"},{id:30,label:"30 วัน",shortLabel:"30 วัน"},{id:90,label:"3 เดือน",shortLabel:"3 เดือน"},{id:-1,label:"กำหนดเอง",shortLabel:"กำหนดเอง"}];function it(){const[,ce]=ke(),[n,h]=r.useState("all"),[c,F]=r.useState(7),[j,N]=r.useState(!1),[me,w]=r.useState(!1),[m,H]=r.useState(""),[x,z]=r.useState(""),[u,v]=r.useState(null),[xe,k]=r.useState(!1),[O,C]=r.useState(null),{toast:_}=Ce(),R=De(),{patientId:g,isLoading:A}=R,D=Se(),B=Le(),V=Ee(),W=Pe(),q=Me(),S=Te(),G=Ie(),Q=Fe(),ue=t=>({health:D,vitals:D,symptoms:B,exercise:V,mood:W,medical_notes:q,meds:S,medications:S,sleep:G,water:Q})[t],X=D.isPending||B.isPending||V.isPending||W.isPending||q.isPending||S.isPending||G.isPending||Q.isPending,pe=c===-1&&m&&x?{startDate:m,endDate:x}:void 0,{data:he,isLoading:ge,refetch:L}=He(g,c===-1?30:c,pe),be=async t=>{if(!g)return;const s=Y.find(M=>M.id===t.id);if(!s)return;const a=s.rawId;if(!a)return;const b=ue(t.type);if(b)try{await b.mutateAsync({id:a,patientId:g}),_({description:"ลบข้อมูลเรียบร้อยแล้ว"}),C(null),L()}catch(M){console.error("Error deleting history item:",M),_({description:"เกิดข้อผิดพลาดในการลบข้อมูล",variant:"destructive"})}},[fe,ye]=r.useState(!1);!A&&!g&&!fe&&(ye(!0),R.ensurePatient());const je=[{id:1,type:"symptoms",title:"อาการ",detail:"ปวดหัว (ระดับ 3)",time:"10:30 น.",date:"วันนี้",icon:I,color:"text-red-500",bg:"bg-red-50 dark:bg-red-950/30"},{id:2,type:"health",title:"ความดัน",detail:"128/82 mmHg",time:"08:15 น.",date:"วันนี้",icon:y,color:"text-blue-500",bg:"bg-blue-50 dark:bg-blue-950/30"},{id:3,type:"meds",title:"ยาเช้า",detail:"ทานครบตามรายการ",time:"08:00 น.",date:"วันนี้",icon:T,color:"text-orange-500",bg:"bg-orange-50 dark:bg-orange-950/30"},{id:4,type:"sleep",title:"การนอน",detail:"6.5 ชม. (หลับดี)",time:"07:00 น.",date:"วันนี้",icon:de,color:"text-indigo-500",bg:"bg-indigo-50 dark:bg-indigo-950/30"},{id:5,type:"water",title:"น้ำ",detail:"8 แก้ว",time:"18:00 น.",date:"เมื่อวาน",icon:ie,color:"text-sky-500",bg:"bg-sky-50 dark:bg-sky-950/30"},{id:6,type:"exercise",title:"ออกกำลังกาย",detail:"เดินเร็ว 20 นาที",time:"17:45 น.",date:"เมื่อวาน",icon:ne,color:"text-purple-500",bg:"bg-purple-50 dark:bg-purple-950/30"},{id:7,type:"mood",title:"อารมณ์",detail:"สดชื่น แจ่มใส",time:"09:00 น.",date:"เมื่อวาน",icon:ze,color:"text-yellow-500",bg:"bg-yellow-50 dark:bg-yellow-950/30"},{id:8,type:"other",title:"บันทึกทั่วไป",detail:"นัดหมอฟันเลื่อนเป็นอาทิตย์หน้า",time:"14:20 น.",date:"15 ม.ค.",icon:tt,color:"text-gray-500",bg:"bg-gray-50 dark:bg-gray-950/30"},{id:9,type:"health",title:"ความดัน",detail:"135/88 mmHg (สูงนิดหน่อย)",time:"18:30 น.",date:"15 ม.ค.",icon:y,color:"text-blue-500",bg:"bg-blue-50 dark:bg-blue-950/30"},{id:10,type:"symptoms",title:"อาการ",detail:"เวียนหัว บ้านหมุน",time:"15:00 น.",date:"14 ม.ค.",icon:I,color:"text-red-500",bg:"bg-red-50 dark:bg-red-950/30"}],Y=(he||[]).map((t,s)=>{const a=le[t.type]||le.health,b={vitals:"health",medications:"meds"};return{id:s+1,rawId:t.id,type:b[t.type]||t.type,title:t.title,detail:t.detail,time:t.time,date:t.date,icon:a.icon,color:a.color,bg:a.bg}}),i=n==="example",E=A||ge,J=i?je:Y,P=n==="all"||n==="example"?J:J.filter(t=>t.type===n),d=()=>{k(!0),setTimeout(()=>{k(!1),v(null),L()},1500)},l=()=>{v(null),k(!1),L()},Ne=()=>{if(!u)return null;switch({health:"vitals",meds:"medications"}[u.type]||u.type){case"vitals":return e.jsx(Ue,{onSuccess:d,onCancel:l});case"water":return e.jsx(Ke,{onSuccess:d,onCancel:l});case"medications":return e.jsx(Je,{onSuccess:d,onCancel:l});case"symptoms":return e.jsx(Ye,{onSuccess:d,onCancel:l});case"sleep":return e.jsx(Xe,{onSuccess:d,onCancel:l});case"exercise":return e.jsx(Qe,{onSuccess:d,onCancel:l});case"mood":return e.jsx(Ge,{onSuccess:d,onCancel:l});case"medical_notes":return e.jsx(qe,{onSuccess:d,onCancel:l});default:return e.jsx("div",{className:"p-4 bg-muted/20 rounded-2xl text-center text-muted-foreground text-sm",children:"แบบฟอร์มสำหรับประเภทนี้ยังไม่พร้อมใช้งาน"})}},we=()=>u?{health:"ความดัน/ชีพจร",vitals:"ความดัน/ชีพจร",meds:"ยา",medications:"ยา",sleep:"การนอน",water:"การดื่มน้ำ",exercise:"ออกกำลังกาย",symptoms:"อาการ",mood:"อารมณ์",medical_notes:"โน้ต/บันทึกแพทย์"}[u.type]||u.title:"";return e.jsxs("div",{className:"min-h-screen bg-background pb-32 font-sans relative z-10",children:[e.jsxs("header",{className:"bg-card pt-12 pb-4 px-6 sticky top-0 z-20 border-b border-border",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(o,{variant:"ghost",size:"icon",className:"rounded-full -ml-2",onClick:()=>ce("/records"),children:e.jsx(Oe,{className:"w-6 h-6 text-foreground"})}),e.jsx("h1",{className:"text-xl font-bold text-foreground",children:"ประวัติการบันทึก"})]}),e.jsxs(o,{variant:"outline",size:"sm",className:"rounded-full gap-1.5 px-3 h-9",onClick:()=>N(!j),children:[e.jsx(K,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs font-medium",children:c===-1?"กำหนดเอง":oe.find(t=>t.id===c)?.shortLabel}),e.jsx(Ze,{className:p("w-3 h-3 transition-transform",j&&"rotate-180")})]})]}),j&&e.jsx("div",{className:"mt-3 flex gap-2 flex-wrap animate-in slide-in-from-top-2 duration-200",children:oe.map(t=>e.jsx("button",{onClick:()=>{t.id===-1?(w(!0),N(!1)):(F(t.id),N(!1))},className:p("flex-1 min-w-[70px] py-2 px-3 rounded-xl text-xs font-bold transition-all border",c===t.id?"bg-primary text-primary-foreground border-primary shadow-md shadow-primary/20":"bg-card text-muted-foreground border-border hover:border-primary/50"),children:t.label},t.id))}),c===-1&&m&&x&&e.jsxs("div",{className:"mt-2 text-xs text-muted-foreground text-center",children:[new Date(m).toLocaleDateString("th-TH",{day:"numeric",month:"short",year:"2-digit"})," - ",new Date(x).toLocaleDateString("th-TH",{day:"numeric",month:"short",year:"2-digit"})]})]}),e.jsxs("main",{className:"max-w-md mx-auto px-4 py-6 space-y-6",children:[e.jsxs("div",{className:"flex gap-2 overflow-x-auto pb-2 no-scrollbar",children:[e.jsx("button",{onClick:()=>h("all"),className:p("px-4 py-1.5 rounded-full text-xs font-bold whitespace-nowrap transition-all border",n==="all"?"bg-foreground text-background border-foreground":"bg-card text-muted-foreground border-border"),children:"ทั้งหมด"}),[{id:"symptoms",label:"อาการ"},{id:"health",label:"ความดัน"},{id:"meds",label:"ยา"},{id:"water",label:"น้ำ"},{id:"sleep",label:"การนอน"}].map(t=>e.jsx("button",{onClick:()=>h(t.id),className:p("px-4 py-1.5 rounded-full text-xs font-bold whitespace-nowrap transition-all border",n===t.id?"bg-primary text-primary-foreground border-primary shadow-md shadow-primary/20":"bg-card text-muted-foreground border-border"),children:t.label},t.id)),e.jsxs("button",{onClick:()=>h("example"),className:p("px-4 py-1.5 rounded-full text-xs font-bold whitespace-nowrap transition-all border flex items-center gap-1",n==="example"?"bg-amber-500 text-white border-amber-500 shadow-md shadow-amber-500/20":"bg-card text-muted-foreground border-border"),children:[e.jsx(f,{className:"w-3 h-3"}),"ตัวอย่าง"]})]}),E&&!i&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 space-y-3",children:[e.jsx(U,{className:"w-8 h-8 animate-spin text-primary"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"กำลังโหลด..."})]}),(!E||i)&&e.jsx("div",{className:"space-y-2",children:P.map(t=>e.jsxs("div",{className:"flex items-center justify-between bg-muted/50 rounded-xl p-3 cursor-pointer active:scale-[0.99] transition-transform group",onClick:()=>!i&&O!==t.id&&v(t),children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[e.jsx("div",{className:p("w-10 h-10 rounded-xl flex items-center justify-center shrink-0",t.bg),children:e.jsx(t.icon,{className:p("w-5 h-5",t.color)})}),e.jsxs("div",{className:"space-y-1 flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_e,{className:"w-3 h-3 text-muted-foreground shrink-0"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:t.time}),e.jsx("span",{className:"text-[10px] font-medium text-muted-foreground bg-muted/50 px-2 py-0.5 rounded-full whitespace-nowrap",children:t.date})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:t.title}),e.jsx("span",{className:"text-sm font-bold text-foreground truncate",children:t.detail})]})]})]}),!i&&(O===t.id?e.jsxs("div",{className:"flex items-center gap-1 shrink-0",children:[e.jsx(o,{variant:"destructive",size:"sm",className:"h-7 px-2 text-xs",onClick:s=>{s.stopPropagation(),be(t)},disabled:X,children:X?e.jsx(U,{className:"w-3 h-3 animate-spin"}):"ลบ"}),e.jsx(o,{variant:"ghost",size:"sm",className:"h-7 px-2 text-xs",onClick:s=>{s.stopPropagation(),C(null)},children:"ยกเลิก"})]}):e.jsxs("div",{className:"flex items-center gap-1 shrink-0",children:[e.jsx(o,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 text-muted-foreground hover:text-destructive opacity-40 group-hover:opacity-100 transition-opacity",onClick:s=>{s.stopPropagation(),C(t.id)},children:e.jsx(Re,{className:"w-4 h-4"})}),e.jsx(Z,{className:"w-4 h-4 text-muted-foreground/50 group-hover:text-muted-foreground group-hover:translate-x-0.5 transition-all"})]})),i&&e.jsx(Z,{className:"w-4 h-4 text-muted-foreground/50 shrink-0"})]},t.id))}),P.length===0&&!E&&e.jsx(Ae,{className:"border-none shadow-sm",children:e.jsx(Be,{className:"py-12 flex flex-col items-center text-center space-y-4",children:i?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-16 h-16 bg-amber-100 dark:bg-amber-950/30 rounded-full flex items-center justify-center",children:e.jsx(f,{className:"w-8 h-8 text-amber-500"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"font-bold text-foreground",children:"ข้อมูลตัวอย่าง"}),e.jsx("p",{className:"text-sm text-muted-foreground max-w-[250px]",children:"นี่คือตัวอย่างข้อมูลที่จะแสดงเมื่อมีการบันทึกจริง"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-16 h-16 bg-muted rounded-full flex items-center justify-center",children:e.jsx($e,{className:"w-8 h-8 text-muted-foreground"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"font-bold text-foreground",children:"ยังไม่มีข้อมูล"}),e.jsx("p",{className:"text-sm text-muted-foreground max-w-[250px]",children:n==="all"?"เริ่มบันทึกสุขภาพประจำวันโดยพิมพ์คุยกับน้องอุ่นใน LINE Chat":"ยังไม่มีประวัติการบันทึกในหมวดนี้"})]}),e.jsxs(o,{variant:"outline",className:"mt-2",onClick:()=>h("example"),children:[e.jsx(f,{className:"w-4 h-4 mr-2"}),"ดูตัวอย่างข้อมูล"]})]})})}),i&&P.length>0&&e.jsxs("div",{className:"bg-amber-50 dark:bg-amber-950/20 border border-amber-200 dark:border-amber-800 rounded-xl p-3 flex items-center gap-3",children:[e.jsx(f,{className:"w-5 h-5 text-amber-600 dark:text-amber-400 shrink-0"}),e.jsx("p",{className:"text-xs text-amber-700 dark:text-amber-300",children:"นี่คือข้อมูลตัวอย่าง ไม่ใช่ข้อมูลจริงจากการบันทึกของคุณ"})]})]}),e.jsx($,{open:u!==null,onOpenChange:t=>!t&&l(),children:e.jsxs(ee,{className:"max-h-[90vh]",children:[e.jsxs(te,{className:"flex items-center justify-between px-6",children:[e.jsx(se,{className:"text-xl font-bold",children:we()}),e.jsx(ae,{asChild:!0,children:e.jsx(o,{variant:"ghost",size:"icon",className:"rounded-full h-10 w-10",children:e.jsx(re,{className:"w-5 h-5"})})})]}),e.jsx("div",{className:"px-6 overflow-y-auto max-h-[calc(90vh-80px)]",children:xe?e.jsxs("div",{className:"py-12 flex flex-col items-center text-center space-y-6 animate-in zoom-in-95 duration-300",children:[e.jsx("div",{className:"w-20 h-20 bg-emerald-100 dark:bg-emerald-950/30 text-emerald-600 rounded-full flex items-center justify-center",children:e.jsx(Ve,{className:"w-10 h-10 stroke-[3px]"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"อัปเดตเรียบร้อย!"}),e.jsx("p",{className:"text-muted-foreground text-sm leading-relaxed px-8",children:"ข้อมูลของคุณถูกอัปเดตแล้ว"})]})]}):Ne()})]})}),e.jsx($,{open:me,onOpenChange:w,children:e.jsxs(ee,{className:"max-h-[85vh]",children:[e.jsxs(te,{className:"flex items-center justify-between px-6",children:[e.jsx(se,{className:"text-xl font-bold",children:"กำหนดช่วงวันที่"}),e.jsx(ae,{asChild:!0,children:e.jsx(o,{variant:"ghost",size:"icon",className:"rounded-full h-10 w-10",children:e.jsx(re,{className:"w-5 h-5"})})})]}),e.jsxs("div",{className:"px-6 pb-8 space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"วันเริ่มต้น"}),e.jsx("input",{type:"date",value:m,onChange:t=>H(t.target.value),max:x||new Date().toISOString().split("T")[0],className:"w-full h-12 px-4 rounded-xl border border-border bg-card text-foreground focus:outline-none focus:ring-2 focus:ring-primary"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"วันสิ้นสุด"}),e.jsx("input",{type:"date",value:x,onChange:t=>z(t.target.value),min:m,max:new Date().toISOString().split("T")[0],className:"w-full h-12 px-4 rounded-xl border border-border bg-card text-foreground focus:outline-none focus:ring-2 focus:ring-primary"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"เลือกด่วน"}),e.jsx("div",{className:"flex gap-2 flex-wrap",children:[{label:"สัปดาห์นี้",days:7},{label:"เดือนนี้",days:30},{label:"3 เดือน",days:90},{label:"6 เดือน",days:180}].map(t=>e.jsx("button",{onClick:()=>{const s=new Date,a=new Date;a.setDate(a.getDate()-t.days),H(a.toISOString().split("T")[0]),z(s.toISOString().split("T")[0])},className:"px-4 py-2 rounded-xl text-xs font-medium bg-muted hover:bg-muted/80 transition-colors",children:t.label},t.days))})]}),e.jsxs(o,{className:"w-full h-14 rounded-2xl font-bold text-lg",disabled:!m||!x,onClick:()=>{F(-1),w(!1)},children:[e.jsx(K,{className:"w-5 h-5 mr-2"}),"ใช้ช่วงวันที่นี้"]})]})]})}),e.jsx(We,{})]})}export{it as default};

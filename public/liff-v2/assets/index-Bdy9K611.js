import{r as u,b as H,j as a}from"./vendor-query-OvJu5Khy.js";import{k as tt,l as Z,u as at,a as we,m as _e,H as st,P as rt,M as nt,n as lt,o as ot,D as it,p as dt,L as ct,e as oe,f as fe,q as ut,r as mt,s as xt,t as ft,v as ht,w as pt,g as he,X as yt,x as Se,B as vt}from"./index-BLJvRp2V.js";import{S as Ae,a as gt,c as Oe,s as bt,b as Fe,d as Be,e as jt,f as Dt,p as Nt,r as ve,D as We,u as qe,R as kt,g as wt,h as _t,i as He,j as St,k as At,l as Ze,C as Q,m as Et,Z as Ve,L as ne,G as Mt,n as Lt,o as ee,q as z,t as ue,v as Ee,w as Pt,J as Ct,x as ie,y as It,z as Tt,A as $t,B as zt,E as Kt,F as Ot,H as Ft,I as Bt,K as Ge,M as Wt,N as qt,O as Ht,P as Zt,Q as Vt,T as Gt,U as Yt,V as Jt,W as Xt,X as Ut,Y as Qt,_ as Rt,$ as me,a0 as Ye,a1 as Je,a2 as de,a3 as pe,a4 as P,a5 as C,a6 as I,a7 as T,a8 as ce,a9 as U,aa as te,ab as ae}from"./th-DpmnvcUj.js";import{I as ea}from"./info-a1aZRNM8.js";import{M as ta}from"./message-circle-heart-_odWOyAv.js";import"./vendor-react-qkC6yhPU.js";import"./vendor-ui-CYcp45lG.js";var aa=["option","isActive"];function re(){return re=Object.assign?Object.assign.bind():function(s){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(s[r]=t[r])}return s},re.apply(null,arguments)}function sa(s,e){if(s==null)return{};var t,r,n=ra(s,e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(s);for(r=0;r<l.length;r++)t=l[r],e.indexOf(t)===-1&&{}.propertyIsEnumerable.call(s,t)&&(n[t]=s[t])}return n}function ra(s,e){if(s==null)return{};var t={};for(var r in s)if({}.hasOwnProperty.call(s,r)){if(e.indexOf(r)!==-1)continue;t[r]=s[r]}return t}function na(s){var{option:e,isActive:t}=s,r=sa(s,aa);return typeof e=="string"?u.createElement(Ae,re({option:u.createElement(gt,re({type:e},r)),isActive:t,shapeType:"symbols"},r)):u.createElement(Ae,re({option:e,isActive:t,shapeType:"symbols"},r))}var la=(s,e,t,r,n,l,d)=>Fe(s,"xAxis",e,d),oa=(s,e,t,r,n,l,d)=>Be(s,"xAxis",e,d),ia=(s,e,t,r,n,l,d)=>Fe(s,"yAxis",t,d),da=(s,e,t,r,n,l,d)=>Be(s,"yAxis",t,d),ca=(s,e,t,r)=>jt(s,"zAxis",r,!1),ua=(s,e,t,r,n)=>n,ma=(s,e,t,r,n,l)=>l,xa=(s,e,t,r,n,l,d)=>bt(s,void 0,void 0,d),fa=Oe([Dt,ua],(s,e)=>s.filter(t=>t.type==="scatter").find(t=>t.id===e)),ha=Oe([xa,la,oa,ia,da,ca,fa,ma],(s,e,t,r,n,l,d,i)=>{var{chartData:c,dataStartIndex:o,dataEndIndex:f}=s;if(d!=null){var m;if(d?.data!=null&&d.data.length>0?m=d.data:m=c?.slice(o,f+1),!(m==null||e==null||r==null||t==null||n==null||t?.length===0||n?.length===0))return Ea({displayedData:m,xAxis:e,yAxis:r,zAxis:l,scatterSettings:d,xAxisTicks:t,yAxisTicks:n,cells:i})}}),pa=["id"],ya=["onMouseEnter","onClick","onMouseLeave"],va=["animationBegin","animationDuration","animationEasing","hide","isAnimationActive","legendType","lineJointType","lineType","shape","xAxisId","yAxisId","zAxisId"];function ye(s,e){if(s==null)return{};var t,r,n=ga(s,e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(s);for(r=0;r<l.length;r++)t=l[r],e.indexOf(t)===-1&&{}.propertyIsEnumerable.call(s,t)&&(n[t]=s[t])}return n}function ga(s,e){if(s==null)return{};var t={};for(var r in s)if({}.hasOwnProperty.call(s,r)){if(e.indexOf(r)!==-1)continue;t[r]=s[r]}return t}function q(){return q=Object.assign?Object.assign.bind():function(s){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(s[r]=t[r])}return s},q.apply(null,arguments)}function Me(s,e){var t=Object.keys(s);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(s);e&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(s,n).enumerable})),t.push.apply(t,r)}return t}function E(s){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Me(Object(t),!0).forEach(function(r){ba(s,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(t)):Me(Object(t)).forEach(function(r){Object.defineProperty(s,r,Object.getOwnPropertyDescriptor(t,r))})}return s}function ba(s,e,t){return(e=ja(e))in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}function ja(s){var e=Da(s,"string");return typeof e=="symbol"?e:e+""}function Da(s,e){if(typeof s!="object"||!s)return s;var t=s[Symbol.toPrimitive];if(t!==void 0){var r=t.call(s,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(s)}var Na=s=>{var{dataKey:e,name:t,fill:r,legendType:n,hide:l}=s;return[{inactive:l,dataKey:e,type:n,color:r,value:He(t,e),payload:s}]},ka=u.memo(s=>{var{dataKey:e,points:t,stroke:r,strokeWidth:n,fill:l,name:d,hide:i,tooltipType:c,id:o}=s,f={dataDefinedOnItem:t?.map(m=>m.tooltipPayload),positions:t?.map(m=>m.tooltipPosition),settings:{stroke:r,strokeWidth:n,fill:l,nameKey:void 0,dataKey:e,name:He(d,e),hide:i,type:c,color:l,unit:"",graphicalItemId:o}};return u.createElement(Et,{tooltipEntrySettings:f})});function wa(s){var{points:e,props:t}=s,{line:r,lineType:n,lineJointType:l}=t;if(!r)return null;var d=Ge(t),i=Zt(r),c,o;if(n==="joint")c=e.map(v=>{var x,g;return{x:(x=v.cx)!==null&&x!==void 0?x:null,y:(g=v.cy)!==null&&g!==void 0?g:null}});else if(n==="fitting"){var{xmin:f,xmax:m,a:p,b:j}=Vt(e),b=v=>p*v+j;c=[{x:f,y:b(f)},{x:m,y:b(m)}]}var y=E(E(E({},d),{},{fill:"none",stroke:d&&d.fill},i),{},{points:c});return u.isValidElement(r)?o=u.cloneElement(r,y):typeof r=="function"?o=r(y):o=u.createElement(Gt,q({},y,{type:l})),u.createElement(ne,{className:"recharts-scatter-line",key:"recharts-scatter-line"},o)}function _a(s){var{showLabels:e,points:t,children:r}=s,n=Tt(),l=u.useMemo(()=>t?.map(d=>{var i,c,o={x:(i=d.x)!==null&&i!==void 0?i:0,y:(c=d.y)!==null&&c!==void 0?c:0,width:d.width,height:d.height,lowerWidth:d.width,upperWidth:d.width};return E(E({},o),{},{value:void 0,payload:d.payload,viewBox:o,parentViewBox:n,fill:void 0})}),[n,t]);return u.createElement($t,{value:e?l:void 0},r)}function Sa(s){var{points:e,allOtherScatterProps:t}=s,{shape:r,activeShape:n,dataKey:l}=t,{id:d}=t,i=ye(t,pa),c=Ze(zt),{onMouseEnter:o,onClick:f,onMouseLeave:m}=t,p=ye(t,ya),j=Kt(o,l,d),b=Ot(m),y=Ft(f,l,d);if(!Bt(e))return null;var v=Ge(i);return u.createElement(u.Fragment,null,u.createElement(wa,{points:e,props:i}),e.map((x,g)=>{var _=n!=null&&n!==!1,A=_&&c===String(g),O=_&&A?n:r,M=E(E(E({},v),x),{},{[qt]:g,[Wt]:String(d)});return u.createElement(Ve,{key:"symbol-".concat(x?.cx,"-").concat(x?.cy,"-").concat(x?.size,"-").concat(g),zIndex:A?We.activeDot:void 0},u.createElement(ne,q({className:"recharts-scatter-symbol"},Ht(p,x,g),{onMouseEnter:j(x,g),onMouseLeave:b(x,g),onClick:y(x,g)}),u.createElement(na,q({option:O,isActive:A},M))))}))}function Aa(s){var{previousPointsRef:e,props:t}=s,{points:r,isAnimationActive:n,animationBegin:l,animationDuration:d,animationEasing:i}=t,c=e.current,o=Pt(t,"recharts-scatter-"),[f,m]=u.useState(!1),p=u.useCallback(()=>{m(!1)},[]),j=u.useCallback(()=>{m(!0)},[]),b=!f;return u.createElement(_a,{showLabels:b,points:r},t.children,u.createElement(Ct,{animationId:o,begin:l,duration:d,isActive:n,easing:i,onAnimationEnd:p,onAnimationStart:j,key:o},y=>{var v=y===1?r:r?.map((x,g)=>{var _=c&&c[g];return _?E(E({},x),{},{cx:x.cx==null?void 0:ie(_.cx,x.cx,y),cy:x.cy==null?void 0:ie(_.cy,x.cy,y),size:ie(_.size,x.size,y)}):E(E({},x),{},{size:ie(0,x.size,y)})});return y>0&&(e.current=v),u.createElement(ne,null,u.createElement(Sa,{points:v,allOtherScatterProps:t,showLabels:b}))}),u.createElement(It,{label:t.label}))}function Ea(s){var{displayedData:e,xAxis:t,yAxis:r,zAxis:n,scatterSettings:l,xAxisTicks:d,yAxisTicks:i,cells:c}=s,o=ee(t.dataKey)?l.dataKey:t.dataKey,f=ee(r.dataKey)?l.dataKey:r.dataKey,m=n&&n.dataKey,p=n?n.range:z.range,j=p&&p[0],b=t.scale.bandwidth?t.scale.bandwidth():0,y=r.scale.bandwidth?r.scale.bandwidth():0;return e.map((v,x)=>{var g=ue(v,o),_=ue(v,f),A=!ee(m)&&ue(v,m)||"-",O=[{name:ee(t.dataKey)?l.name:t.name||String(t.dataKey),unit:t.unit||"",value:g,payload:v,dataKey:o,type:l.tooltipType},{name:ee(r.dataKey)?l.name:r.name||String(r.dataKey),unit:r.unit||"",value:_,payload:v,dataKey:f,type:l.tooltipType}];A!=="-"&&O.push({name:n.name||n.dataKey,unit:n.unit||"",value:A,payload:v,dataKey:m,type:l.tooltipType});var M=Ee({axis:t,ticks:d,bandSize:b,entry:v,index:x,dataKey:o}),F=Ee({axis:r,ticks:i,bandSize:y,entry:v,index:x,dataKey:f}),R=A!=="-"?n.scale(A):j,B=Math.sqrt(Math.max(R,0)/Math.PI);return E(E({},v),{},{cx:M,cy:F,x:M==null?void 0:M-B,y:F==null?void 0:F-B,width:2*B,height:2*B,size:R,node:{x:g,y:_,z:A},tooltipPayload:O,tooltipPosition:{x:M,y:F},payload:v},c&&c[x]&&c[x].props)})}var Ma=(s,e,t)=>({x:s.cx,y:s.cy,value:Number(t==="x"?s.node.x:s.node.y),errorVal:ue(s,e)});function La(s){var{hide:e,points:t,className:r,needClip:n,xAxisId:l,yAxisId:d,id:i}=s,c=u.useRef(null);if(e)return null;var o=tt("recharts-scatter",r),f=i;return u.createElement(Ve,{zIndex:s.zIndex},u.createElement(ne,{className:o,clipPath:n?"url(#clipPath-".concat(f,")"):void 0,id:i},n&&u.createElement("defs",null,u.createElement(Mt,{clipPathId:f,xAxisId:l,yAxisId:d})),u.createElement(Lt,{xAxisId:l,yAxisId:d,data:t,dataPointFormatter:Ma,errorBarOffset:0},u.createElement(ne,{key:"recharts-scatter-symbols"},u.createElement(Aa,{props:s,previousPointsRef:c})))))}var Xe={xAxisId:0,yAxisId:0,zAxisId:0,label:!1,line:!1,legendType:"circle",lineType:"joint",lineJointType:"linear",shape:"circle",hide:!1,isAnimationActive:"auto",animationBegin:0,animationDuration:400,animationEasing:"linear",zIndex:We.scatter};function Pa(s){var e=ve(s,Xe),{animationBegin:t,animationDuration:r,animationEasing:n,hide:l,isAnimationActive:d,legendType:i,lineJointType:c,lineType:o,shape:f,xAxisId:m,yAxisId:p,zAxisId:j}=e,b=ye(e,va),{needClip:y}=St(m,p),v=u.useMemo(()=>At(s.children,Q),[s.children]),x=qe(),g=Ze(_=>ha(_,m,p,j,s.id,v,x));return y==null||g==null?null:u.createElement(u.Fragment,null,u.createElement(ka,{dataKey:s.dataKey,points:g,stroke:s.stroke,strokeWidth:s.strokeWidth,fill:s.fill,name:s.name,hide:s.hide,tooltipType:s.tooltipType,id:s.id}),u.createElement(La,q({},b,{xAxisId:m,yAxisId:p,zAxisId:j,lineType:o,lineJointType:c,legendType:i,shape:f,hide:l,isAnimationActive:d,animationBegin:t,animationDuration:r,animationEasing:n,points:g,needClip:y})))}function Ca(s){var e=ve(s,Xe),t=qe();return u.createElement(kt,{id:e.id,type:"scatter"},r=>u.createElement(u.Fragment,null,u.createElement(wt,{legendPayload:Na(e)}),u.createElement(_t,{type:"scatter",id:r,data:e.data,xAxisId:e.xAxisId,yAxisId:e.yAxisId,zAxisId:e.zAxisId,dataKey:e.dataKey,hide:e.hide,name:e.name,tooltipType:e.tooltipType,isPanorama:t}),u.createElement(Pa,q({},e,{id:r}))))}var Ue=u.memo(Ca,Nt);Ue.displayName="Scatter";function Ia(s){var e=Yt(),t=u.useRef(null);return u.useLayoutEffect(()=>{t.current===null?e(Jt(s)):t.current!==s&&e(Xt({prev:t.current,next:s})),t.current=s},[s,e]),u.useLayoutEffect(()=>()=>{t.current&&(e(Ut(t.current)),t.current=null)},[e]),null}var Ta={zAxisId:0,range:z.range,scale:z.scale,type:z.type};function Qe(s){var e=ve(s,Ta);return u.createElement(Ia,{domain:e.domain,id:e.zAxisId,dataKey:e.dataKey,name:e.name,unit:e.unit,range:e.range,scale:e.scale,type:e.type,allowDuplicatedCategory:z.allowDuplicatedCategory,allowDataOverflow:z.allowDataOverflow,reversed:z.reversed,includeHidden:z.includeHidden})}Qe.displayName="ZAxis";var $a=["item"],za=u.forwardRef((s,e)=>u.createElement(Qt,{chartName:"ScatterChart",defaultTooltipEventType:"item",validateTooltipEventTypes:$a,tooltipPayloadSearcher:Rt,categoricalChartProps:s,ref:e}));function V(s){const e=new Date;return Array.from({length:s},(t,r)=>{const n=Je(e,s-1-r);return me(n,"d MMM",{locale:Ye})})}function G(s){const e=new Date;return Array.from({length:s},(t,r)=>{const n=Je(e,s-1-r);return me(n,"yyyy-MM-dd")})}const Y={"7d":7,"15d":15,"30d":30,custom:0},k={all:["trends"],vitals:(s,e)=>[...k.all,"vitals",s,e],meds:(s,e)=>[...k.all,"meds",s,e],sleep:(s,e)=>[...k.all,"sleep",s,e],exercise:(s,e)=>[...k.all,"exercise",s,e],mood:(s,e)=>[...k.all,"mood",s,e],water:(s,e)=>[...k.all,"water",s,e],glucose:(s,e)=>[...k.all,"glucose",s,e]};function Ka(s,e,t){const r=s?e==="custom"&&t?[...k.vitals(s,e),t.startDate,t.endDate]:k.vitals(s,e):["trends","vitals","none"];return H({queryKey:r,queryFn:async()=>{if(!s)return Le(e,t);try{let n=`/trends/vitals/${s}?range=${e}`;return e==="custom"&&t&&(n+=`&startDate=${t.startDate}&endDate=${t.endDate}`),await Z.get(n)}catch{return console.warn("Vitals trend API not available, using mock data"),Le(e,t)}},enabled:!0,staleTime:60*1e3})}function Oa(s,e,t){const r=s?e==="custom"&&t?[...k.meds(s,e),t.startDate,t.endDate]:k.meds(s,e):["trends","meds","none"];return H({queryKey:r,queryFn:async()=>{if(!s)return Pe(e,t);try{let n=`/trends/meds/${s}?range=${e}`;return e==="custom"&&t&&(n+=`&startDate=${t.startDate}&endDate=${t.endDate}`),await Z.get(n)}catch{return console.warn("Meds trend API not available, using mock data"),Pe(e,t)}},enabled:!0,staleTime:60*1e3})}function Fa(s,e,t){const r=s?e==="custom"&&t?[...k.sleep(s,e),t.startDate,t.endDate]:k.sleep(s,e):["trends","sleep","none"];return H({queryKey:r,queryFn:async()=>{if(!s)return Ce(e,t);try{let n=`/trends/sleep/${s}?range=${e}`;return e==="custom"&&t&&(n+=`&startDate=${t.startDate}&endDate=${t.endDate}`),await Z.get(n)}catch{return console.warn("Sleep trend API not available, using mock data"),Ce(e,t)}},enabled:!0,staleTime:60*1e3})}function K(s,e){const t=new Date(s),r=new Date(e);return Math.ceil((r.getTime()-t.getTime())/(1e3*60*60*24))+1}function J(s,e){const t=K(s,e),r=new Date(s),n=[],l=[];for(let d=0;d<t;d++){const i=new Date(r);i.setDate(i.getDate()+d),n.push(me(i,"yyyy-MM-dd")),l.push(me(i,"d MMM",{locale:Ye}))}return{dates:n,labels:l}}function Le(s,e){let t,r,n;if(s==="custom"&&e){t=K(e.startDate,e.endDate);const o=J(e.startDate,e.endDate);r=o.labels,n=o.dates}else t=Y[s]||7,r=V(t),n=G(t);const l=r.map((o,f)=>{const m=118+Math.floor(Math.random()*25),p=73+Math.floor(Math.random()*15),j=68+Math.floor(Math.random()*18),b=122+Math.floor(Math.random()*25),y=76+Math.floor(Math.random()*15),v=72+Math.floor(Math.random()*20),x=b,g=y,_=v,A=x>=140||g>=90;return{day:o,date:n[f],systolic:x,diastolic:g,pulse:_,sys_am:m,dia_am:p,pulse_am:j,sys_pm:b,dia_pm:y,pulse_pm:v,event:A?"สูง":void 0,note:A&&Math.random()>.5?"ความดันสูงกว่าปกติ":void 0}}),d=Math.round(l.reduce((o,f)=>o+(f.systolic||0),0)/l.length),i=Math.round(l.reduce((o,f)=>o+(f.diastolic||0),0)/l.length),c=l.filter(o=>o.systolic!==null).length;return{data:l,summary:{avg:`${d}/${i}`,label1:"ค่าเฉลี่ย",count:`วัดแล้ว ${c}/${t} วัน`,label2:"วันที่มีการวัด"},insight:Ba(d,i,s)}}function Pe(s,e){let t,r,n;if(s==="custom"&&e){t=K(e.startDate,e.endDate);const c=J(e.startDate,e.endDate);r=c.labels,n=c.dates}else t=Y[s]||7,r=V(t),n=G(t);const l=r.map((c,o)=>{const m=Math.random()>.2?2:Math.random()>.5?1:0,p=Math.round(m/2*100);return{day:c,date:n[o],target:2,done:m,percent:p,event:m===0?"ลืม":m<2?"พลาด":void 0,note:m<2?m===0?"ลืมทั้งวัน":"พลาดบางมื้อ":void 0}}),d=Math.round(l.reduce((c,o)=>c+(o.percent||0),0)/l.length),i=l.filter(c=>c.percent===100).length;return{data:l,summary:{avg:`${d}%`,label1:"% กินยาครบ",count:`กินครบ ${i}/${t} วัน`,label2:"วันกินครบ"},insight:Wa(d)}}function Ce(s,e){let t,r,n;if(s==="custom"&&e){t=K(e.startDate,e.endDate);const c=J(e.startDate,e.endDate);r=c.labels,n=c.dates}else t=Y[s]||7,r=V(t),n=G(t);const l=r.map((c,o)=>{const f=parseFloat((5+Math.random()*3.5).toFixed(1)),m=f<6;return{day:c,date:n[o],hours:f,event:m?"น้อย":void 0,note:m?"นอนน้อยกว่าเกณฑ์":void 0}}),d=(l.reduce((c,o)=>c+(o.hours||0),0)/l.length).toFixed(1),i=l.filter(c=>c.hours!==null).length;return{data:l,summary:{avg:`${d} ชม.`,label1:"ชม.นอนเฉลี่ย",count:`บันทึก ${i}/${t} คืน`,label2:"คืนที่บันทึก"},insight:qa(parseFloat(d))}}function Ba(s,e,t){return s>=140||e>=90?"ความดันโดยเฉลี่ยสูงกว่าปกติ ควรปรึกษาแพทย์เพื่อปรับยา":s>=130||e>=80?"ความดันอยู่ในระดับสูงกว่าปกติเล็กน้อย ควรระวังเรื่องอาหารเค็มและพักผ่อนให้เพียงพอ":`ความดัน${t==="7d"?"สัปดาห์นี้":t==="15d"?"15 วันที่ผ่านมา":"เดือนนี้"}อยู่ในเกณฑ์ดี ควบคุมได้ต่อเนื่อง`}function Wa(s,e,t){return s>=95?"กินยาครบถ้วนมาก สุดยอดครับ!":s>=80?"กินยาได้ดี แต่ยังพลาดบ้าง ลองตั้งเตือนเพิ่มไหมครับ":s>=60?"ช่วงนี้พลาดกินยาบ่อย ลองหาวิธีจดจำที่เหมาะกับคุณนะครับ":"ต้องปรับปรุงการกินยา ลองตั้งนาฬิกาเตือนหรือบอกคนใกล้ชิดให้ช่วยเตือน"}function qa(s,e){return s>=7?"พักผ่อนเพียงพอ สุขภาพโดยรวมจะดีครับ":s>=6?"นอนได้พอประมาณ ลองเข้านอนเร็วขึ้นอีกสัก 30 นาทีจะดีมากครับ":"นอนน้อยกว่าเกณฑ์ ลองพักงีบช่วงบ่าย และเข้านอนเร็วขึ้นนะครับ"}function Ha(s,e,t){const r=s?e==="custom"&&t?[...k.exercise(s,e),t.startDate,t.endDate]:k.exercise(s,e):["trends","exercise","none"];return H({queryKey:r,queryFn:async()=>{if(!s)return Ie(e,t);try{let n=`/trends/exercise/${s}?range=${e}`;return e==="custom"&&t&&(n+=`&startDate=${t.startDate}&endDate=${t.endDate}`),await Z.get(n)}catch{return console.warn("Exercise trend API not available, using mock data"),Ie(e,t)}},enabled:!0,staleTime:60*1e3})}function Za(s,e,t){const r=s?e==="custom"&&t?[...k.mood(s,e),t.startDate,t.endDate]:k.mood(s,e):["trends","mood","none"];return H({queryKey:r,queryFn:async()=>{if(!s)return Te(e,t);try{let n=`/trends/mood/${s}?range=${e}`;return e==="custom"&&t&&(n+=`&startDate=${t.startDate}&endDate=${t.endDate}`),await Z.get(n)}catch{return console.warn("Mood trend API not available, using mock data"),Te(e,t)}},enabled:!0,staleTime:60*1e3})}function Va(s,e,t){const r=s?e==="custom"&&t?[...k.water(s,e),t.startDate,t.endDate]:k.water(s,e):["trends","water","none"];return H({queryKey:r,queryFn:async()=>{if(!s)return $e(e,t);try{let n=`/trends/water/${s}?range=${e}`;return e==="custom"&&t&&(n+=`&startDate=${t.startDate}&endDate=${t.endDate}`),await Z.get(n)}catch{return console.warn("Water trend API not available, using mock data"),$e(e,t)}},enabled:!0,staleTime:60*1e3})}function Ie(s,e){let t,r,n;if(s==="custom"&&e){t=K(e.startDate,e.endDate);const o=J(e.startDate,e.endDate);r=o.labels,n=o.dates}else t=Y[s]||7,r=V(t),n=G(t);const l=["เดิน","วิ่ง","ว่ายน้ำ","ปั่นจักรยาน","โยคะ"],d=r.map((o,f)=>{const m=Math.random()>.3,p=m?Math.floor(15+Math.random()*45):null,j=m?l[Math.floor(Math.random()*l.length)]:void 0;return{day:o,date:n[f],duration:p,exerciseType:j,event:p&&p>=30?"ดี":void 0,note:j}}),i=d.filter(o=>o.duration!==null).length,c=i>0?Math.round(d.reduce((o,f)=>o+(f.duration||0),0)/i):0;return{data:d,summary:{avg:i>0?`${c} นาที`:"-",label1:"เวลาเฉลี่ย",count:`ออกกำลังกาย ${i}/${t} วัน`,label2:"วันที่ออกกำลังกาย"},insight:Ga(i,t,c)}}function Ga(s,e,t){const r=s/e;return r>=.7&&t>=30?"ออกกำลังกายสม่ำเสมอมาก สุขภาพแข็งแรงแน่นอนครับ!":r>=.5?"ออกกำลังกายได้ดี ลองเพิ่มเวลาออกกำลังกายอีกนิดจะยิ่งดีครับ":r>=.3?"ออกกำลังกายบ้าง ลองตั้งเป้าอย่างน้อยวันละ 30 นาที 5 วัน/สัปดาห์นะครับ":"ช่วงนี้ออกกำลังกายน้อย ลองเริ่มจากเดินวันละ 15-20 นาทีก่อนนะครับ"}function Te(s,e){let t,r,n;if(s==="custom"&&e){t=K(e.startDate,e.endDate);const m=J(e.startDate,e.endDate);r=m.labels,n=m.dates}else t=Y[s]||7,r=V(t),n=G(t);const l=["happy","calm","neutral","sad","anxious"],d={happy:"มีความสุข",calm:"สงบ",neutral:"เฉยๆ",sad:"เศร้า",anxious:"กังวล"},i={happy:5,calm:4,neutral:3,sad:2,anxious:1},c=r.map((m,p)=>{const j=Math.random()>.2,b=j?l[Math.floor(Math.random()*l.length)]:null,y=b?i[b]:null,v=j?Math.floor(1+Math.random()*5):null;return{day:m,date:n[p],mood:b,moodScore:y,stressLevel:v,event:y&&y<=2?"ต่ำ":void 0,note:b?d[b]:void 0}}),o=c.filter(m=>m.moodScore!==null).length,f=o>0?(c.reduce((m,p)=>m+(p.moodScore||0),0)/o).toFixed(1):"0";return{data:c,summary:{avg:o>0?`${f}/5`:"-",label1:"คะแนนอารมณ์เฉลี่ย",count:`บันทึก ${o}/${t} วัน`,label2:"วันที่บันทึก"},insight:Ya(parseFloat(f),o)}}function Ya(s,e,t){return e===0?"ยังไม่มีการบันทึกอารมณ์ ลองบันทึกทุกวันเพื่อติดตามสุขภาพจิตนะครับ":s>=4?"อารมณ์ดีสม่ำเสมอ ยอดเยี่ยมครับ! รักษาความสุขนี้ไว้นะครับ":s>=3?"อารมณ์โดยรวมปกติดี ลองหากิจกรรมที่ชอบทำเพื่อเพิ่มความสุขนะครับ":s>=2?"ช่วงนี้อารมณ์อาจไม่ค่อยดี ลองพูดคุยกับคนใกล้ชิดหรือทำกิจกรรมผ่อนคลายนะครับ":"ดูเหมือนช่วงนี้อารมณ์ไม่ค่อยดี หากรู้สึกหนักใจ ลองปรึกษาผู้เชี่ยวชาญนะครับ"}function $e(s,e){let t,r,n;if(s==="custom"&&e){t=K(e.startDate,e.endDate);const c=J(e.startDate,e.endDate);r=c.labels,n=c.dates}else t=Y[s]||7,r=V(t),n=G(t);const l=r.map((c,o)=>{const f=Math.floor(4+Math.random()*6),m=f*250,p=f<6;return{day:c,date:n[o],glasses:f,ml:m,event:p?"น้อย":f>=8?"ดี":void 0,note:p?"ดื่มน้ำน้อย":f>=8?"ดื่มน้ำได้ดี":void 0}}),d=Math.round(l.reduce((c,o)=>c+(o.glasses||0),0)/l.length),i=l.filter(c=>(c.glasses||0)>=8).length;return{data:l,summary:{avg:`${d} แก้ว`,label1:"เฉลี่ย/วัน",count:`ดื่มครบ ${i}/${t} วัน`,label2:"วันดื่มครบ 8 แก้ว"},insight:Ja(d)}}function Ja(s,e,t){return s>=8?"ดื่มน้ำได้ตามเป้าหมาย สุขภาพดีแน่นอนครับ!":s>=6?"ดื่มน้ำได้ดี ลองเพิ่มอีก 2-3 แก้วต่อวันจะยิ่งดีครับ":s>=4?"ดื่มน้ำน้อยไป ลองพกขวดน้ำติดตัวเพื่อเตือนให้ดื่มบ่อยขึ้นนะครับ":"ดื่มน้ำน้อยมาก ร่างกายต้องการน้ำอย่างน้อย 8 แก้ว/วันนะครับ"}function Xa(s,e,t){const r=s?e==="custom"&&t?[...k.glucose(s,e),t.startDate,t.endDate]:k.glucose(s,e):["trends","glucose","none"];return H({queryKey:r,queryFn:async()=>{if(!s)return ze(e,t);try{let n=`/trends/glucose/${s}?range=${e}`;return e==="custom"&&t&&(n+=`&startDate=${t.startDate}&endDate=${t.endDate}`),await Z.get(n)}catch{return console.warn("Glucose trend API not available, using mock data"),ze(e,t)}},enabled:!0,staleTime:60*1e3})}function ze(s,e){let t,r,n;if(s==="custom"&&e){t=K(e.startDate,e.endDate);const p=J(e.startDate,e.endDate);r=p.labels,n=p.dates}else t=Y[s]||7,r=V(t),n=G(t);const l=["fasting","post_meal_1h","post_meal_2h","before_bed"],d=["06:30","08:00","12:30","13:30","18:30","21:00"];let i=0;const c=r.map((p,j)=>{const b=Math.random()>.2?1+Math.floor(Math.random()*3):0,y=[];for(let x=0;x<b;x++)y.push({glucose:85+Math.floor(Math.random()*55),mealContext:l[x%l.length],time:d[x*2]||"12:00"});i+=y.length;const v=y.length>0?Math.round(y.reduce((x,g)=>x+g.glucose,0)/y.length):null;return{day:p,date:n[j],glucose:v,mealContext:y.length>0?y[y.length-1].mealContext:null,glucoseReadings:y.length>0?y:void 0}}),o=c.flatMap(p=>p.glucoseReadings||[]),f=o.length>0?Math.round(o.reduce((p,j)=>p+j.glucose,0)/o.length):0,m=c.filter(p=>p.glucoseReadings&&p.glucoseReadings.length>0).length;return{data:c,summary:{avg:o.length>0?`${f} mg/dL`:"-",label1:"ค่าเฉลี่ย",count:`วัดแล้ว ${m}/${t} วัน (${o.length} ครั้ง)`,label2:"จำนวนการวัด"},insight:Ua(f,m)}}function Ua(s,e){return e===0?"ยังไม่มีข้อมูลน้ำตาลในช่วงนี้ ลองวัดระดับน้ำตาลเพื่อติดตามสุขภาพนะครับ":s>=126?"ระดับน้ำตาลเฉลี่ยสูงกว่าปกติ ควรปรึกษาแพทย์เพื่อปรับยาหรือพฤติกรรม":s>=100?"ระดับน้ำตาลอยู่ในช่วงเสี่ยง ควรลดอาหารหวานและออกกำลังกายสม่ำเสมอ":"ระดับน้ำตาลอยู่ในเกณฑ์ปกติ ดีมากครับ รักษาพฤติกรรมนี้ต่อไป"}const Ke={data:[{day:"จ",date:"2026-01-06",systolic:122,diastolic:80,pulse:72,sys_am:118,dia_am:76,pulse_am:68,sys_pm:122,dia_pm:80,pulse_pm:72},{day:"อ",date:"2026-01-07",systolic:125,diastolic:82,pulse:75,sys_am:120,dia_am:78,pulse_am:70,sys_pm:125,dia_pm:82,pulse_pm:75,event:"สูงนิดหน่อย"},{day:"พ",date:"2026-01-08",systolic:118,diastolic:78,pulse:70,sys_am:115,dia_am:74,pulse_am:66,sys_pm:118,dia_pm:78,pulse_pm:70},{day:"พฤ",date:"2026-01-09",systolic:120,diastolic:79,pulse:73,sys_am:117,dia_am:75,pulse_am:69,sys_pm:120,dia_pm:79,pulse_pm:73},{day:"ศ",date:"2026-01-10",systolic:123,diastolic:81,pulse:74,sys_am:119,dia_am:77,pulse_am:70,sys_pm:123,dia_pm:81,pulse_pm:74,note:"ตื่นมาเหนื่อย"},{day:"ส",date:"2026-01-11",systolic:119,diastolic:77,pulse:71,sys_am:116,dia_am:73,pulse_am:67,sys_pm:119,dia_pm:77,pulse_pm:71},{day:"อา",date:"2026-01-12",systolic:121,diastolic:80,pulse:72,sys_am:118,dia_am:76,pulse_am:68,sys_pm:121,dia_pm:80,pulse_pm:72}],summary:{avg:"121/79",count:"7/7 วัน",label1:"ค่าเฉลี่ย",label2:"บันทึกครบ"},insight:"ความดันคุณอยู่ในเกณฑ์ปกติตลอดสัปดาห์ ยอดเยี่ยม!"},Qa={data:[{day:"จ",date:"2026-01-06",percent:100,target:3,done:3},{day:"อ",date:"2026-01-07",percent:67,target:3,done:2,note:"ลืมมื้อเที่ยง"},{day:"พ",date:"2026-01-08",percent:100,target:3,done:3},{day:"พฤ",date:"2026-01-09",percent:100,target:3,done:3},{day:"ศ",date:"2026-01-10",percent:100,target:3,done:3},{day:"ส",date:"2026-01-11",percent:33,target:3,done:1,note:"ลืม 2 มื้อ"},{day:"อา",date:"2026-01-12",percent:100,target:3,done:3}],summary:{avg:"86%",count:"5/7 วัน",label1:"อัตราครบ",label2:"กินครบทั้งวัน"},insight:"สัปดาห์นี้คุณลืมยา 2 วัน ลองตั้งเตือนเพิ่มช่วงเที่ยงนะคะ"},Ra={data:[{day:"จ",date:"2026-01-06",hours:7.5},{day:"อ",date:"2026-01-07",hours:6.2,note:"นอนดึก"},{day:"พ",date:"2026-01-08",hours:7},{day:"พฤ",date:"2026-01-09",hours:5.5,note:"ตื่นกลางดึก"},{day:"ศ",date:"2026-01-10",hours:8},{day:"ส",date:"2026-01-11",hours:7.2},{day:"อา",date:"2026-01-12",hours:6.8}],summary:{avg:"6.9 ชม.",count:"7/7 วัน",label1:"เฉลี่ย/คืน",label2:"บันทึกครบ"},insight:"สัปดาห์นี้คุณนอนเฉลี่ย 6.9 ชม. ลองนอนก่อน 22:00 จะดีขึ้นนะคะ"},se=(s=0)=>{const e=new Date;return e.setDate(e.getDate()-s),`${e.getFullYear()}-${(e.getMonth()+1).toString().padStart(2,"0")}-${e.getDate().toString().padStart(2,"0")}`};function os(){const{context:s,user:e}=at(),t=s.patientId||(e.role==="patient"?e.profileId:null),[r,n]=u.useState("7d"),[l,d]=u.useState("heart"),[i,c]=u.useState(null),[o,f]=u.useState({startDate:se(30),endDate:se(0)}),[m,p]=u.useState(!1),[j,b]=u.useState(o.startDate),[y,v]=u.useState(o.endDate),{data:x,isLoading:g}=Ka(t,r,r==="custom"?o:void 0),{data:_,isLoading:A}=Oa(t,r,r==="custom"?o:void 0),{data:O,isLoading:M}=Fa(t,r,r==="custom"?o:void 0),{data:F,isLoading:R}=Ha(t,r,r==="custom"?o:void 0),{data:B,isLoading:ge}=Za(t,r,r==="custom"?o:void 0),{data:be,isLoading:je}=Va(t,r,r==="custom"?o:void 0),{data:De,isLoading:Ne}=Xa(t,r,r==="custom"?o:void 0),D=u.useMemo(()=>{switch(l){case"heart":return x||Ke;case"meds":return _||Qa;case"sleep":return O||Ra;case"exercise":return F;case"mood":return B;case"water":return be;case"glucose":return De;default:return x||Ke}},[l,x,_,O,F,B,be,De]),ke=u.useMemo(()=>{switch(l){case"heart":return g;case"meds":return A;case"sleep":return M;case"exercise":return R;case"mood":return ge;case"water":return je;case"glucose":return Ne;default:return!1}},[l,g,A,M,R,ge,je,Ne]);u.useEffect(()=>{c(null)},[r,l]);const Re=[{id:"heart",label:"ความดัน",icon:st},{id:"meds",label:"ยา",icon:rt},{id:"sleep",label:"นอน",icon:nt},{id:"exercise",label:"ออกกำลัง",icon:lt},{id:"mood",label:"อารมณ์",icon:ot},{id:"water",label:"น้ำ",icon:it},{id:"glucose",label:"ระดับน้ำตาล",icon:dt}],$=h=>{h&&h.activePayload&&h.activePayload[0]&&c(h.activePayload[0].payload)};return a.jsxs("div",{className:"min-h-screen pb-32 font-sans overflow-x-hidden relative z-10 bg-background",children:[a.jsx("header",{className:"bg-card pt-12 pb-4 px-6 sticky top-0 z-20 flex justify-between items-center border-b border-border",children:a.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"แนวโน้ม"})}),a.jsxs("main",{className:"max-w-md mx-auto px-4 py-6 space-y-6 animate-in fade-in duration-500",children:[a.jsx("div",{className:"flex bg-muted/50 p-1 rounded-xl gap-1",children:["7d","15d","30d","custom"].map((h,w)=>{const X=["7 วัน","15 วัน","30 วัน","กำหนดเอง"],L=r===h;return a.jsxs("button",{onClick:()=>{n(h),h==="custom"&&(b(o.startDate),v(o.endDate),p(!0))},className:we("flex-1 py-2 text-xs font-semibold rounded-lg transition-all flex items-center justify-center gap-1",L?"bg-primary/10 text-primary shadow-sm border border-primary/30":"text-muted-foreground"),children:[h==="custom"&&a.jsx(_e,{className:"w-3 h-3"}),X[w]]},h)})}),r==="custom"&&a.jsxs("button",{onClick:()=>{b(o.startDate),v(o.endDate),p(!0)},className:"flex items-center justify-center gap-2 text-xs text-primary bg-primary/5 px-3 py-2 rounded-lg border border-primary/20",children:[a.jsx(_e,{className:"w-3.5 h-3.5"}),a.jsxs("span",{children:[new Date(o.startDate).toLocaleDateString("th-TH",{day:"numeric",month:"short"})," - ",new Date(o.endDate).toLocaleDateString("th-TH",{day:"numeric",month:"short",year:"2-digit"})]})]}),a.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 no-scrollbar",children:Re.map(h=>{const w=l===h.id;return a.jsxs("button",{onClick:()=>d(h.id),className:we("flex items-center gap-1.5 px-4 py-1.5 rounded-full text-xs font-bold whitespace-nowrap transition-all border",w?"bg-primary text-primary-foreground border-primary shadow-md shadow-primary/20":"bg-card text-muted-foreground border-border"),children:[a.jsx(h.icon,{className:"w-3.5 h-3.5"}),h.label]},h.id)})}),ke&&a.jsx("div",{className:"flex items-center justify-center py-12",children:a.jsx(ct,{className:"w-8 h-8 animate-spin text-primary"})}),!ke&&D&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"grid grid-cols-2 gap-3 transition-all",children:[a.jsx(oe,{className:"border-none shadow-sm bg-card hover:shadow-md transition-shadow",children:a.jsxs(fe,{className:"p-4",children:[a.jsx("p",{className:"text-[10px] font-bold text-muted-foreground uppercase tracking-wider mb-1",children:D.summary.label1}),a.jsx("p",{className:"text-xl font-bold text-foreground",children:D.summary.avg})]})}),a.jsx(oe,{className:"border-none shadow-sm bg-card hover:shadow-md transition-shadow",children:a.jsxs(fe,{className:"p-4",children:[a.jsx("p",{className:"text-[10px] font-bold text-muted-foreground uppercase tracking-wider mb-1",children:D.summary.label2}),a.jsx("p",{className:"text-xl font-bold text-foreground",children:D.summary.count})]})})]}),a.jsxs(oe,{className:"border-none shadow-sm bg-card p-6 relative",children:[l==="heart"&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"text-xs font-bold text-muted-foreground uppercase tracking-wider mb-3 flex items-center gap-1.5",children:[a.jsx("div",{className:"w-2 h-2 rounded-full bg-[#EF4444]"}),"ความดันช่วงเช้า (AM)"]}),a.jsxs("div",{className:"flex flex-wrap gap-3 mb-2 text-[10px] font-bold uppercase tracking-wider",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("div",{className:"w-3 h-1 bg-[#EF4444] rounded"}),a.jsx("span",{className:"text-muted-foreground",children:"SYS"})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("div",{className:"w-3 h-1 bg-[#3B82F6] rounded"}),a.jsx("span",{className:"text-muted-foreground",children:"DIA"})]})]}),a.jsx("div",{className:"h-[180px] w-full",children:a.jsx(de,{width:"100%",height:"100%",children:a.jsxs(pe,{data:D.data,margin:{top:10,right:10,left:-25,bottom:0},onClick:$,children:[a.jsx(P,{strokeDasharray:"3 3",vertical:!1,stroke:"hsl(var(--muted))"}),a.jsx(C,{dataKey:"day",axisLine:!1,tickLine:!1,tick:{fontSize:10,fill:"hsl(var(--muted-foreground))"},dy:10}),a.jsx(I,{axisLine:!1,tickLine:!1,tick:{fontSize:10,fill:"hsl(var(--muted-foreground))"},domain:[50,180]}),a.jsx(T,{contentStyle:{borderRadius:"12px",fontSize:"12px",border:"1px solid hsl(var(--border))"}}),a.jsx(ce,{y:135,stroke:"#EF4444",strokeDasharray:"6 4",strokeOpacity:.4}),a.jsx(U,{type:"monotone",dataKey:"sys_am",name:"SYS เช้า",stroke:"#EF4444",strokeWidth:2.5,dot:{r:3,fill:"white",strokeWidth:2,stroke:"#EF4444"},activeDot:{r:5,strokeWidth:0,fill:"#EF4444"},connectNulls:!0}),a.jsx(U,{type:"monotone",dataKey:"dia_am",name:"DIA เช้า",stroke:"#3B82F6",strokeWidth:2,dot:{r:3,fill:"white",strokeWidth:2,stroke:"#3B82F6"},activeDot:{r:5,strokeWidth:0,fill:"#3B82F6"},connectNulls:!0})]})})})]}),a.jsxs("div",{children:[a.jsxs("h3",{className:"text-xs font-bold text-muted-foreground uppercase tracking-wider mb-3 flex items-center gap-1.5",children:[a.jsx("div",{className:"w-2 h-2 rounded-full bg-[#991B1B]"}),"ความดันช่วงเย็น (PM)"]}),a.jsxs("div",{className:"flex flex-wrap gap-3 mb-2 text-[10px] font-bold uppercase tracking-wider",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("div",{className:"w-3 h-1 bg-[#991B1B] rounded"}),a.jsx("span",{className:"text-muted-foreground",children:"SYS"})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("div",{className:"w-3 h-1 bg-[#1E3A8A] rounded"}),a.jsx("span",{className:"text-muted-foreground",children:"DIA"})]})]}),a.jsx("div",{className:"h-[180px] w-full",children:a.jsx(de,{width:"100%",height:"100%",children:a.jsxs(pe,{data:D.data,margin:{top:10,right:10,left:-25,bottom:0},onClick:$,children:[a.jsx(P,{strokeDasharray:"3 3",vertical:!1,stroke:"hsl(var(--muted))"}),a.jsx(C,{dataKey:"day",axisLine:!1,tickLine:!1,tick:{fontSize:10,fill:"hsl(var(--muted-foreground))"},dy:10}),a.jsx(I,{axisLine:!1,tickLine:!1,tick:{fontSize:10,fill:"hsl(var(--muted-foreground))"},domain:[50,180]}),a.jsx(T,{contentStyle:{borderRadius:"12px",fontSize:"12px",border:"1px solid hsl(var(--border))"}}),a.jsx(ce,{y:135,stroke:"#991B1B",strokeDasharray:"6 4",strokeOpacity:.4}),a.jsx(U,{type:"monotone",dataKey:"sys_pm",name:"SYS เย็น",stroke:"#991B1B",strokeWidth:2.5,dot:{r:3,fill:"white",strokeWidth:2,stroke:"#991B1B"},activeDot:{r:5,strokeWidth:0,fill:"#991B1B"},connectNulls:!0}),a.jsx(U,{type:"monotone",dataKey:"dia_pm",name:"DIA เย็น",stroke:"#1E3A8A",strokeWidth:2,dot:{r:3,fill:"white",strokeWidth:2,stroke:"#1E3A8A"},activeDot:{r:5,strokeWidth:0,fill:"#1E3A8A"},connectNulls:!0})]})})})]}),a.jsxs("div",{children:[a.jsxs("h3",{className:"text-xs font-bold text-muted-foreground uppercase tracking-wider mb-3 flex items-center gap-1.5",children:[a.jsx("div",{className:"w-2 h-2 rounded-full bg-[#F59E0B]"}),"ชีพจร (Heart Rate)"]}),a.jsxs("div",{className:"flex flex-wrap gap-3 mb-2 text-[10px] font-bold uppercase tracking-wider",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("div",{className:"w-3 h-1 border-t-2 border-dashed border-[#F59E0B]"}),a.jsx("span",{className:"text-muted-foreground",children:"เช้า"})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("div",{className:"w-3 h-1 bg-[#F97316] rounded"}),a.jsx("span",{className:"text-muted-foreground",children:"เย็น"})]})]}),a.jsx("div",{className:"h-[150px] w-full",children:a.jsx(de,{width:"100%",height:"100%",children:a.jsxs(pe,{data:D.data,margin:{top:10,right:10,left:-25,bottom:0},onClick:$,children:[a.jsx(P,{strokeDasharray:"3 3",vertical:!1,stroke:"hsl(var(--muted))"}),a.jsx(C,{dataKey:"day",axisLine:!1,tickLine:!1,tick:{fontSize:10,fill:"hsl(var(--muted-foreground))"},dy:10}),a.jsx(I,{axisLine:!1,tickLine:!1,tick:{fontSize:10,fill:"hsl(var(--muted-foreground))"},domain:[40,120]}),a.jsx(T,{contentStyle:{borderRadius:"12px",fontSize:"12px",border:"1px solid hsl(var(--border))"}}),a.jsx(U,{type:"monotone",dataKey:"pulse_am",name:"HR เช้า",stroke:"#F59E0B",strokeWidth:2,strokeDasharray:"5 5",dot:{r:3,fill:"white",strokeWidth:2,stroke:"#F59E0B"},activeDot:{r:5,strokeWidth:0,fill:"#F59E0B"},connectNulls:!0}),a.jsx(U,{type:"monotone",dataKey:"pulse_pm",name:"HR เย็น",stroke:"#F97316",strokeWidth:2.5,dot:{r:3,fill:"white",strokeWidth:2,stroke:"#F97316"},activeDot:{r:5,strokeWidth:0,fill:"#F97316"},connectNulls:!0})]})})})]})]}),l==="glucose"&&a.jsxs("div",{className:"flex flex-wrap gap-3 mb-2 text-[10px] font-bold uppercase tracking-wider",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-[#6366f1]"}),a.jsx("span",{className:"text-muted-foreground",children:"ตื่นนอน"})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-[#f97316]"}),a.jsx("span",{className:"text-muted-foreground",children:"หลังอาหาร 1 ชม."})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-[#f59e0b]"}),a.jsx("span",{className:"text-muted-foreground",children:"หลังอาหาร 2 ชม."})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-[#8b5cf6]"}),a.jsx("span",{className:"text-muted-foreground",children:"ก่อนนอน"})]})]}),l!=="heart"&&a.jsx("div",{className:"h-[240px] w-full",children:a.jsx(de,{width:"100%",height:"100%",children:l==="meds"?a.jsxs(te,{data:D.data,margin:{top:10,right:10,left:-25,bottom:0},onClick:$,children:[a.jsx(P,{strokeDasharray:"3 3",vertical:!1,stroke:"hsl(var(--muted))"}),a.jsx(C,{dataKey:"day",axisLine:!1,tickLine:!1,tick:{fontSize:10,fill:"hsl(var(--muted-foreground))"},dy:10}),a.jsx(I,{axisLine:!1,tickLine:!1,tick:{fontSize:10,fill:"hsl(var(--muted-foreground))"},domain:[0,100]}),a.jsx(T,{cursor:{fill:"rgba(0,0,0,0.05)"},contentStyle:{borderRadius:"12px",fontSize:"12px",border:"1px solid hsl(var(--border))"}}),a.jsx(ae,{dataKey:"percent",radius:[6,6,0,0],children:D.data.map((h,w)=>a.jsx(Q,{fill:h.percent===100?"#10b981":h.percent===0?"#ef4444":"#f97316"},`cell-${w}`))})]}):l==="sleep"?a.jsxs(te,{data:D.data,margin:{top:10,right:10,left:-25,bottom:0},onClick:$,children:[a.jsx(P,{strokeDasharray:"3 3",vertical:!1,stroke:"hsl(var(--muted))"}),a.jsx(C,{dataKey:"day",axisLine:!1,tickLine:!1,tick:{fontSize:10,fill:"hsl(var(--muted-foreground))"},dy:10}),a.jsx(I,{axisLine:!1,tickLine:!1,tick:{fontSize:10,fill:"hsl(var(--muted-foreground))"},domain:[0,10]}),a.jsx(T,{cursor:{fill:"rgba(0,0,0,0.05)"},contentStyle:{borderRadius:"12px",fontSize:"12px",border:"1px solid hsl(var(--border))"}}),a.jsx(ae,{dataKey:"hours",radius:[6,6,0,0],children:D.data.map((h,w)=>a.jsx(Q,{fill:h.hours&&h.hours<6?"#f97316":"#8b5cf6"},`cell-${w}`))})]}):l==="exercise"?a.jsxs(te,{data:D.data,margin:{top:10,right:10,left:-25,bottom:0},onClick:$,children:[a.jsx(P,{strokeDasharray:"3 3",vertical:!1,stroke:"hsl(var(--muted))"}),a.jsx(C,{dataKey:"day",axisLine:!1,tickLine:!1,tick:{fontSize:10,fill:"hsl(var(--muted-foreground))"},dy:10}),a.jsx(I,{axisLine:!1,tickLine:!1,tick:{fontSize:10,fill:"hsl(var(--muted-foreground))"},domain:[0,60]}),a.jsx(T,{cursor:{fill:"rgba(0,0,0,0.05)"},contentStyle:{borderRadius:"12px",fontSize:"12px",border:"1px solid hsl(var(--border))"}}),a.jsx(ae,{dataKey:"duration",radius:[6,6,0,0],children:D.data.map((h,w)=>a.jsx(Q,{fill:h.duration==null?"#e5e7eb":(h.duration??0)>=30?"#10b981":"#f97316"},`cell-${w}`))})]}):l==="mood"?a.jsxs(te,{data:D.data,margin:{top:10,right:10,left:-25,bottom:0},onClick:$,children:[a.jsx(P,{strokeDasharray:"3 3",vertical:!1,stroke:"hsl(var(--muted))"}),a.jsx(C,{dataKey:"day",axisLine:!1,tickLine:!1,tick:{fontSize:10,fill:"hsl(var(--muted-foreground))"},dy:10}),a.jsx(I,{axisLine:!1,tickLine:!1,tick:{fontSize:10,fill:"hsl(var(--muted-foreground))"},domain:[0,5]}),a.jsx(T,{cursor:{fill:"rgba(0,0,0,0.05)"},contentStyle:{borderRadius:"12px",fontSize:"12px",border:"1px solid hsl(var(--border))"}}),a.jsx(ae,{dataKey:"moodScore",radius:[6,6,0,0],children:D.data.map((h,w)=>a.jsx(Q,{fill:h.moodScore==null?"#e5e7eb":(h.moodScore??0)>=4?"#10b981":(h.moodScore??0)>=3?"#f59e0b":"#ef4444"},`cell-${w}`))})]}):l==="glucose"?(()=>{const h={fasting:"#6366f1",post_meal_1h:"#f97316",post_meal_2h:"#f59e0b",before_bed:"#8b5cf6"},w={fasting:"ตื่นนอน",post_meal_1h:"หลังอาหาร 1 ชม.",post_meal_2h:"หลังอาหาร 2 ชม.",before_bed:"ก่อนนอน"},X=[];D.data.forEach((N,S)=>{N.glucoseReadings&&N.glucoseReadings.forEach((W,le)=>{const xe=N.glucoseReadings.length>1?(le-(N.glucoseReadings.length-1)/2)*.15:0;X.push({dayIndex:S+xe,glucose:W.glucose,mealContext:W.mealContext||"fasting",time:W.time,day:N.day,date:N.date})})});const L={};X.forEach(N=>{const S=N.mealContext;L[S]||(L[S]=[]),L[S].push(N)});const et=D.data.map(N=>N.day);return a.jsxs(za,{margin:{top:10,right:10,left:-25,bottom:0},children:[a.jsx(P,{strokeDasharray:"3 3",vertical:!1,stroke:"hsl(var(--muted))"}),a.jsx(C,{type:"number",dataKey:"dayIndex",domain:[-.5,D.data.length-.5],ticks:D.data.map((N,S)=>S),tickFormatter:N=>et[Math.round(N)]||"",axisLine:!1,tickLine:!1,tick:{fontSize:10,fill:"hsl(var(--muted-foreground))"},dy:10}),a.jsx(I,{type:"number",dataKey:"glucose",axisLine:!1,tickLine:!1,tick:{fontSize:10,fill:"hsl(var(--muted-foreground))"},domain:[50,250]}),a.jsx(Qe,{range:[80,80]}),a.jsx(ce,{y:100,stroke:"#f59e0b",strokeDasharray:"6 4",strokeOpacity:.5,label:{value:"เสี่ยง 100",position:"insideTopLeft",fontSize:9,fill:"#f59e0b"}}),a.jsx(ce,{y:126,stroke:"#ef4444",strokeDasharray:"6 4",strokeOpacity:.5,label:{value:"สูง 126",position:"insideTopLeft",fontSize:9,fill:"#ef4444"}}),a.jsx(T,{content:({payload:N})=>{if(!N||!N[0])return null;const S=N[0].payload;return a.jsxs("div",{className:"bg-card border border-border rounded-xl px-3 py-2 shadow-md text-xs space-y-0.5",children:[a.jsxs("p",{className:"font-bold",children:[S.day," (",S.date,")"]}),a.jsxs("p",{className:"font-bold text-base",style:{color:h[S.mealContext]||"#ec4899"},children:[S.glucose," mg/dL"]}),a.jsxs("p",{className:"text-muted-foreground",children:[w[S.mealContext]||S.mealContext," · ",S.time]})]})}}),Object.entries(L).map(([N,S])=>a.jsx(Ue,{name:w[N]||N,data:S,fill:h[N]||"#ec4899",stroke:"white",strokeWidth:2,onClick:W=>{if(W&&W.date){const le=D.data.find(xe=>xe.date===W.date);le&&c(le)}},cursor:"pointer"},N))]})})():a.jsxs(te,{data:D.data,margin:{top:10,right:10,left:-25,bottom:0},onClick:$,children:[a.jsx(P,{strokeDasharray:"3 3",vertical:!1,stroke:"hsl(var(--muted))"}),a.jsx(C,{dataKey:"day",axisLine:!1,tickLine:!1,tick:{fontSize:10,fill:"hsl(var(--muted-foreground))"},dy:10}),a.jsx(I,{axisLine:!1,tickLine:!1,tick:{fontSize:10,fill:"hsl(var(--muted-foreground))"},domain:[0,12]}),a.jsx(T,{cursor:{fill:"rgba(0,0,0,0.05)"},contentStyle:{borderRadius:"12px",fontSize:"12px",border:"1px solid hsl(var(--border))"}}),a.jsx(ae,{dataKey:"glasses",radius:[6,6,0,0],children:D.data.map((h,w)=>a.jsx(Q,{fill:(h.glasses||0)>=8?"#3b82f6":(h.glasses||0)>=6?"#60a5fa":"#93c5fd"},`cell-${w}`))})]})})}),a.jsx("div",{className:"mt-4 flex justify-center",children:a.jsxs("p",{className:"text-[10px] text-muted-foreground font-medium bg-muted/30 px-3 py-1 rounded-full flex items-center gap-1.5",children:[a.jsx(ea,{className:"w-3 h-3"})," แตะจุดบนกราฟเพื่อดูรายละเอียด"]})}),i&&a.jsxs("div",{className:"mt-4 pt-4 border-t border-muted/50 animate-in fade-in slide-in-from-top-2",children:[a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-xs font-bold text-muted-foreground",children:i.day}),l==="heart"&&a.jsxs("div",{className:"space-y-2 mt-1",children:[(i.sys_am||i.pulse_am)&&a.jsxs("div",{className:"flex items-baseline gap-2",children:[a.jsx("span",{className:"text-[10px] font-bold text-muted-foreground w-8",children:"เช้า"}),a.jsxs("p",{className:"text-base font-bold text-[#EF4444]",children:[i.sys_am,"/",i.dia_am," ",a.jsx("span",{className:"text-[10px] font-normal text-muted-foreground",children:"mmHg"})]}),a.jsxs("p",{className:"text-sm font-bold text-[#F59E0B]",children:[i.pulse_am," ",a.jsx("span",{className:"text-[10px] font-normal text-muted-foreground",children:"bpm"})]})]}),(i.sys_pm||i.pulse_pm)&&a.jsxs("div",{className:"flex items-baseline gap-2",children:[a.jsx("span",{className:"text-[10px] font-bold text-muted-foreground w-8",children:"เย็น"}),a.jsxs("p",{className:"text-base font-bold text-[#991B1B]",children:[i.sys_pm,"/",i.dia_pm," ",a.jsx("span",{className:"text-[10px] font-normal text-muted-foreground",children:"mmHg"})]}),a.jsxs("p",{className:"text-sm font-bold text-[#F97316]",children:[i.pulse_pm," ",a.jsx("span",{className:"text-[10px] font-normal text-muted-foreground",children:"bpm"})]})]})]}),l==="meds"&&a.jsx("div",{className:"mt-1",children:a.jsxs("p",{className:"text-sm font-bold text-foreground",children:["ตั้งไว้ ",i.target," ช่วง | ทำได้ ",i.done," ช่วง |"," ","= ",i.percent,"%"]})}),l==="sleep"&&a.jsx("div",{className:"mt-1",children:a.jsxs("p",{className:"text-xl font-bold text-indigo-600",children:[i.hours," ",a.jsx("span",{className:"text-xs font-normal text-muted-foreground",children:"ชม."})]})}),l==="exercise"&&a.jsxs("div",{className:"mt-1",children:[a.jsx("p",{className:"text-xl font-bold text-emerald-600",children:i.duration!==null?a.jsxs(a.Fragment,{children:[i.duration," ",a.jsx("span",{className:"text-xs font-normal text-muted-foreground",children:"นาที"})]}):a.jsx("span",{className:"text-muted-foreground text-base",children:"ไม่ได้ออกกำลังกาย"})}),i.exerciseType&&a.jsx("p",{className:"text-xs text-muted-foreground mt-0.5",children:i.exerciseType})]}),l==="mood"&&a.jsxs("div",{className:"mt-1",children:[a.jsx("p",{className:"text-xl font-bold text-amber-600",children:i.moodScore!==null?a.jsxs(a.Fragment,{children:[i.moodScore,"/5"," ",a.jsx("span",{className:"text-xs font-normal text-muted-foreground",children:"คะแนน"})]}):a.jsx("span",{className:"text-muted-foreground text-base",children:"ไม่ได้บันทึก"})}),i.note&&a.jsx("p",{className:"text-xs text-muted-foreground mt-0.5",children:i.note})]}),l==="water"&&a.jsxs("div",{className:"mt-1",children:[a.jsxs("p",{className:"text-xl font-bold text-blue-600",children:[i.glasses," ",a.jsx("span",{className:"text-xs font-normal text-muted-foreground",children:"แก้ว"})]}),i.ml&&a.jsxs("p",{className:"text-xs text-muted-foreground mt-0.5",children:["≈ ",i.ml," ml"]})]}),l==="glucose"&&a.jsx("div",{className:"mt-1 space-y-2",children:i.glucoseReadings&&i.glucoseReadings.length>0?a.jsxs(a.Fragment,{children:[a.jsxs("p",{className:"text-[10px] font-bold text-muted-foreground uppercase tracking-wider",children:["วัด ",i.glucoseReadings.length," ครั้ง · เฉลี่ย ",i.glucose," mg/dL"]}),i.glucoseReadings.map((h,w)=>{const X={fasting:"ตื่นนอน",post_meal_1h:"หลังอาหาร 1 ชม.",post_meal_2h:"หลังอาหาร 2 ชม.",before_bed:"ก่อนนอน"},L={fasting:"#6366f1",post_meal_1h:"#f97316",post_meal_2h:"#f59e0b",before_bed:"#8b5cf6"};return a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-2 h-2 rounded-full shrink-0",style:{backgroundColor:L[h.mealContext||""]||"#ec4899"}}),a.jsx("span",{className:"text-base font-bold",style:{color:L[h.mealContext||""]||"#ec4899"},children:h.glucose}),a.jsx("span",{className:"text-[10px] text-muted-foreground",children:"mg/dL"}),a.jsxs("span",{className:"text-[10px] text-muted-foreground",children:[X[h.mealContext||""]||h.mealContext," · ",h.time]})]},w)})]}):a.jsx("p",{className:"text-muted-foreground text-base",children:"ไม่ได้วัด"})})]}),i.note&&a.jsxs("div",{className:"bg-yellow-50 dark:bg-yellow-950/30 px-3 py-2 rounded-xl text-xs font-medium text-yellow-700 dark:text-yellow-400 max-w-[150px]",children:['"',i.note,'"']})]}),i.event&&!i.note&&a.jsxs("div",{className:"mt-2 inline-flex items-center gap-1.5 bg-red-50 dark:bg-red-950/30 text-red-600 dark:text-red-400 px-2.5 py-1 rounded-full",children:[a.jsx(ut,{className:"w-3 h-3"}),a.jsx("span",{className:"text-[10px] font-bold",children:i.event})]})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("h2",{className:"text-sm font-bold text-foreground flex items-center gap-2 pl-1",children:[a.jsx("div",{className:"w-1 h-4 bg-accent rounded-full"}),"อุ่นใจสังเกตให้"]}),a.jsx(oe,{className:"border-none shadow-sm bg-accent/5 overflow-hidden group hover:bg-accent/10 transition-colors",children:a.jsxs(fe,{className:"p-5 flex gap-4 items-start",children:[a.jsx("div",{className:"bg-accent/10 p-3 rounded-2xl text-accent group-hover:scale-110 transition-transform",children:a.jsx(ta,{className:"w-6 h-6"})}),a.jsx("div",{className:"flex-1 space-y-2",children:a.jsxs("p",{className:"text-sm leading-relaxed font-semibold text-foreground",children:['"',D.insight,'"']})})]})})]})]})]}),a.jsx(mt,{open:m,onOpenChange:p,children:a.jsxs(xt,{className:"max-h-[85vh]",children:[a.jsxs(ft,{className:"flex items-center justify-between px-6",children:[a.jsx(ht,{className:"text-xl font-bold",children:"เลือกช่วงวันที่"}),a.jsx(pt,{asChild:!0,children:a.jsx(he,{variant:"ghost",size:"icon",className:"rounded-full h-10 w-10",children:a.jsx(yt,{className:"w-5 h-5"})})})]}),a.jsxs("div",{className:"px-6 pb-8 space-y-6",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"วันเริ่มต้น"}),a.jsx(Se,{value:j,onChange:b,maxDate:y})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"วันสิ้นสุด"}),a.jsx(Se,{value:y,onChange:v,minDate:j,maxDate:se(0)})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("p",{className:"text-xs font-medium text-muted-foreground",children:"เลือกด่วน"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:[{label:"7 วันที่แล้ว",days:7},{label:"14 วันที่แล้ว",days:14},{label:"30 วันที่แล้ว",days:30},{label:"60 วันที่แล้ว",days:60},{label:"90 วันที่แล้ว",days:90}].map(h=>a.jsx("button",{onClick:()=>{b(se(h.days-1)),v(se(0))},className:"px-3 py-1.5 text-xs font-medium rounded-full bg-muted hover:bg-muted/80 text-muted-foreground transition-colors",children:h.label},h.days))})]}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[a.jsx(he,{variant:"ghost",className:"flex-1 h-12 rounded-xl",onClick:()=>p(!1),children:"ยกเลิก"}),a.jsx(he,{className:"flex-1 h-12 rounded-xl bg-primary text-primary-foreground",onClick:()=>{f({startDate:j,endDate:y}),p(!1)},children:"ยืนยัน"})]})]})]})}),a.jsx(vt,{})]})}export{os as default};

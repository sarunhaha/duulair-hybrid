# üß™ Testing Steps - ‡∏´‡∏•‡∏±‡∏á‡πÅ‡∏Å‡πâ Vercel Config

## ‚úÖ Code Changes ‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß:

1. **Fix: Critical bug in quick-register** (b91607e)
   - ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡πá‡∏Ñ `patientResult.success`
   - ‡∏ñ‡πâ‡∏≤ patient creation ‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß‡∏à‡∏∞ throw error ‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ return success: true

2. **Fix: Show detailed error message** (235af7a)
   - ‡πÅ‡∏™‡∏î‡∏á error message ‡∏à‡∏≤‡∏Å API ‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡πÅ‡∏Ñ‡πà HTTP status
   - ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô error ‡∏ó‡∏µ‡πà‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô ‡πÄ‡∏ä‡πà‡∏ô "Relationship is required"

3. **Add: Debug tools**
   - `/api/debug-env` - ‡πÄ‡∏ä‡πá‡∏Ñ Supabase connection
   - `debug-v3.html` - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ó‡∏µ‡∏•‡∏∞ step
   - `clear-data.html` - ‡∏•‡πâ‡∏≤‡∏á localStorage

4. **Vercel Config**: ‡∏ä‡∏µ‡πâ‡πÑ‡∏õ‡∏ó‡∏µ‡πà Supabase project ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
   - Old: `xibtslxxjxossybxisdr` (‡∏ú‡∏¥‡∏î)
   - New: `mqxklnzxfrupwwkwlwwc` (‡∏ñ‡∏π‡∏Å) ‚úÖ

---

## üìã Testing Steps (‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏ï‡∏≤‡∏°‡∏•‡∏≥‡∏î‡∏±‡∏ö):

### Step 1: ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ Vercel Deployment ‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß

‡∏£‡∏≠‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì **2-3 ‡∏ô‡∏≤‡∏ó‡∏µ** ‡∏´‡∏•‡∏±‡∏á‡πÅ‡∏Å‡πâ config

---

### Step 2: ‚úÖ ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ß‡πà‡∏≤‡∏ä‡∏µ‡πâ Supabase project ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á

**‡πÄ‡∏õ‡∏¥‡∏î:**
```
https://duulair.vercel.app/api/debug-env
```

**‡∏ú‡∏•‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏î‡πâ:**
```json
{
  "supabaseUrl": "https://mqxklnzxfrupwwkwlwwc.supabase.co",
  "hasServiceKey": true,
  "nodeEnv": "production"
}
```

‚úÖ **Pass**: ‡∏ñ‡πâ‡∏≤ URL ‡πÄ‡∏õ‡πá‡∏ô `mqxklnzxfrupwwkwlwwc`
‚ùå **Fail**: ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÄ‡∏õ‡πá‡∏ô `xibtslxxjxossybxisdr` ‡∏´‡∏£‡∏∑‡∏≠‡∏≠‡∏∑‡πà‡∏ô‡πÜ

---

### Step 3: ‚úÖ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ User ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö

**‡πÄ‡∏õ‡∏¥‡∏î:**
```
https://duulair.vercel.app/api/check-user?lineUserId=Uf65220907317686ebc96aaf94021b2e6
```

**‡∏ú‡∏•‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏î‡πâ:**
```json
{
  "isRegistered": false,
  "userId": null,
  "role": null
}
```

‚úÖ **Pass**: ‡∏ñ‡πâ‡∏≤ `isRegistered: false` (database ‡πÉ‡∏´‡∏°‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•)
‚ùå **Fail**: ‡∏ñ‡πâ‡∏≤ `isRegistered: true` (‡πÅ‡∏™‡∏î‡∏á‡∏ß‡πà‡∏≤‡∏¢‡∏±‡∏á‡∏ä‡∏µ‡πâ project ‡∏ú‡∏¥‡∏î)

---

### Step 4: ‚úÖ ‡∏•‡πâ‡∏≤‡∏á localStorage (‡∏ö‡∏ô Mobile)

**‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ô LINE app:**
```
https://duulair.vercel.app/liff/clear-data.html
```

**‡∏ó‡∏≥:**
1. ‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• localStorage ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà
2. ‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° "üóëÔ∏è ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î"
3. ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô
4. ‡∏à‡∏∞ redirect ‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥

‚úÖ **Pass**: localStorage ‡∏ñ‡∏π‡∏Å‡∏•‡πâ‡∏≤‡∏á redirect ‡πÑ‡∏î‡πâ
‚ùå **Fail**: ‡∏°‡∏µ error

---

### Step 5: ‚úÖ ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÉ‡∏´‡∏°‡πà

**‡∏´‡∏ô‡πâ‡∏≤:**
```
https://duulair.vercel.app/liff/group-registration
```

**‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:**
- ‚úÖ ‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•
- ‚úÖ **‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡∏Å‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢** (‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å - ‡∏≠‡∏¢‡πà‡∏≤‡πÄ‡∏ß‡πâ‡∏ô‡∏ß‡πà‡∏≤‡∏á)
- ‚úÖ ‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢
- ‚úÖ ‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢ (‡∏Ñ.‡∏®.)
- ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡πÅ‡∏•‡∏∞‡πÇ‡∏£‡∏Ñ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß (optional)

**‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°:** "‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡∏∞‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô"

**‡∏ú‡∏•‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏î‡πâ:**

‚úÖ **Success**:
```
‚úÖ ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!

Caregiver ID: xxxxxxxx...
Patient ID: xxxxxxxx...

‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢
```
‚Üí LIFF ‡∏õ‡∏¥‡∏î‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ ‡∏´‡∏£‡∏∑‡∏≠ redirect ‡πÑ‡∏õ dashboard

‚ùå **Fail - ‡∏ñ‡πâ‡∏≤‡πÑ‡∏î‡πâ error**:
- ‡∏ñ‡πà‡∏≤‡∏¢‡∏†‡∏≤‡∏û error message ‡∏ó‡∏µ‡πà‡∏Ç‡∏∂‡πâ‡∏ô
- ‡∏ö‡∏≠‡∏Å‡∏ß‡πà‡∏≤ error ‡∏≠‡∏∞‡πÑ‡∏£ (‡πÄ‡∏ä‡πà‡∏ô "Relationship is required")

---

### Step 6: ‚úÖ ‡∏ó‡∏î‡∏™‡∏≠‡∏ö Debug Page (‡∏ñ‡πâ‡∏≤ Step 5 ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à)

**‡πÄ‡∏õ‡∏¥‡∏î:**
```
https://duulair.vercel.app/liff/debug-v3.html
```

**‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ó‡∏∏‡∏Å Step:**

**Step 1: LIFF Initialization**
- ‚úÖ ‡∏Ñ‡∏ß‡∏£‡∏Ç‡∏∂‡πâ‡∏ô: "‚úÖ LIFF ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à"

**Step 2: localStorage Data**
- ‚úÖ ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏´‡πá‡∏ô `duulair_user` ‡πÅ‡∏•‡∏∞ `duulair_context`
- ‚úÖ ‡∏°‡∏µ `profile_id` (Patient ID)

**Step 3: LINE Profile**
- ‚úÖ ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏´‡πá‡∏ô User ID: `Uf65220907317686ebc96aaf94021b2e6`
- ‚úÖ ‡∏°‡∏µ Display Name ‡πÅ‡∏•‡∏∞ Picture URL

**Step 4: API Endpoint Test**
- ‚úÖ ‡∏Ñ‡∏ß‡∏£‡∏Ç‡∏∂‡πâ‡∏ô: "‚úÖ API ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!"
- ‚úÖ HTTP Status: 200
- ‚úÖ ‡∏°‡∏µ patient profile data

**Step 5: Error Logs**
- ‚úÖ ‡∏Ñ‡∏ß‡∏£‡∏Ç‡∏∂‡πâ‡∏ô: "‚úÖ ‡πÑ‡∏°‡πà‡∏°‡∏µ errors"

---

### Step 7: ‚úÖ ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢

**‡πÄ‡∏õ‡∏¥‡∏î:**
```
https://duulair.vercel.app/liff/patient-profile
```

**‡∏ú‡∏•‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏î‡πâ:**
- ‚úÖ ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡πÑ‡∏î‡πâ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
- ‚úÖ ‡πÄ‡∏´‡πá‡∏ô‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•, ‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î, ‡∏≠‡∏≤‡∏¢‡∏∏
- ‚úÖ ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ

‚ùå **Fail**: ‡∏ñ‡πâ‡∏≤‡∏Ç‡∏∂‡πâ‡∏ô "‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ"

---

### Step 8: ‚úÖ ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤

**‡πÄ‡∏õ‡∏¥‡∏î:**
```
https://duulair.vercel.app/liff/settings
```

**‡∏ú‡∏•‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏î‡πâ:**
- ‚úÖ ‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÑ‡∏î‡πâ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
- ‚úÖ ‡πÄ‡∏´‡πá‡∏ô toggle switches
- ‚úÖ ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÑ‡∏î‡πâ

‚ùå **Fail**: ‡∏ñ‡πâ‡∏≤‡∏Ç‡∏∂‡πâ‡∏ô "‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ"

---

## üìä ‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö:

‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ö‡∏≠‡∏Å‡∏ú‡∏•‡πÅ‡∏ï‡πà‡∏•‡∏∞ Step:

```
Step 1 (Debug Env): ‚úÖ / ‚ùå
Step 2 (Check User): ‚úÖ / ‚ùå
Step 3 (Clear Data): ‚úÖ / ‚ùå
Step 4 (Registration): ‚úÖ / ‚ùå + [error message ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ]
Step 5 (Debug v3): ‚úÖ / ‚ùå
Step 6 (Patient Profile): ‚úÖ / ‚ùå
Step 7 (Settings): ‚úÖ / ‚ùå
```

---

## üêõ ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ Error:

1. **‡∏ñ‡πà‡∏≤‡∏¢‡∏†‡∏≤‡∏û error message**
2. **‡∏ö‡∏≠‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏Å‡∏¥‡∏î‡∏ó‡∏µ‡πà step ‡πÑ‡∏´‡∏ô**
3. **‡∏™‡πà‡∏á‡∏ú‡∏• debug-v3.html** (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)

---

## üéØ Expected Outcome:

**‡∏ñ‡πâ‡∏≤‡∏ó‡∏∏‡∏Å step ‡∏ú‡πà‡∏≤‡∏ô** = ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå! ‚úÖ

**‡∏ñ‡πâ‡∏≤‡∏°‡∏µ step ‡πÑ‡∏´‡∏ô‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß** = ‡∏à‡∏∞‡∏£‡∏π‡πâ‡πÑ‡∏î‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡∏ß‡πà‡∏≤‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏≠‡∏¢‡∏π‡πà‡∏ï‡∏£‡∏á‡πÑ‡∏´‡∏ô ‡πÅ‡∏•‡πâ‡∏ß‡πÅ‡∏Å‡πâ‡∏ï‡πà‡∏≠

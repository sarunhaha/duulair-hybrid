# OONJ.AI Rich Menu Implementation Guide

## ğŸ¯ Overview

Rich Menu à¸ªà¸³à¸«à¸£à¸±à¸š OONJ.AI à¸›à¸£à¸°à¸à¸­à¸šà¸”à¹‰à¸§à¸¢ 5 à¹€à¸¡à¸™à¸¹à¸«à¸¥à¸±à¸ à¸­à¸­à¸à¹à¸šà¸šà¹ƒà¸«à¹‰à¹€à¸£à¸µà¸¢à¸šà¸‡à¹ˆà¸²à¸¢ à¹€à¸«à¸¡à¸²à¸°à¸à¸±à¸šà¸œà¸¹à¹‰à¸ªà¸¹à¸‡à¸­à¸²à¸¢à¸¸

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                            â”‚
â”‚  ğŸ‘¤ à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸‚à¸­à¸‡à¸„à¸¸à¸“   ğŸ©º à¸šà¸±à¸™à¸—à¸¶à¸à¸ªà¸¸à¸‚à¸ à¸²à¸   ğŸ“Š à¸£à¸²à¸¢à¸‡à¸²à¸™à¸ªà¸¸à¸‚à¸ à¸²à¸   ğŸ”” à¹à¸ˆà¹‰à¸‡à¹€à¸•à¸·à¸­à¸™   âš™ï¸ à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸²  â”‚
â”‚                                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“‹ Menu Structure

### 1. ğŸ‘¤ à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸‚à¸­à¸‡à¸„à¸¸à¸“ (Your Information)

**Purpose:** à¸”à¸¹à¹à¸¥à¸°à¹à¸à¹‰à¹„à¸‚à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ªà¹ˆà¸§à¸™à¸•à¸±à¸§, à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ªà¸¸à¸‚à¸ à¸²à¸à¸à¸·à¹‰à¸™à¸à¸²à¸™, à¸£à¸²à¸¢à¸à¸²à¸£à¸¢à¸²

**Action Type:** `uri` â†’ LIFF Page

**LIFF URL:** `https://liff.line.me/{LIFF_ID}/profile`

#### Sub-sections:

```
ğŸ‘¤ à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸‚à¸­à¸‡à¸„à¸¸à¸“
â”œâ”€â”€ ğŸ“ à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ªà¹ˆà¸§à¸™à¸•à¸±à¸§
â”‚   â”œâ”€â”€ à¸Šà¸·à¹ˆà¸­-à¸™à¸²à¸¡à¸ªà¸à¸¸à¸¥
â”‚   â”œâ”€â”€ à¸Šà¸·à¹ˆà¸­à¹€à¸¥à¹ˆà¸™
â”‚   â”œâ”€â”€ à¸§à¸±à¸™à¹€à¸à¸´à¸” / à¸­à¸²à¸¢à¸¸
â”‚   â”œâ”€â”€ à¹€à¸à¸¨
â”‚   â”œâ”€â”€ à¸™à¹‰à¸³à¸«à¸™à¸±à¸ / à¸ªà¹ˆà¸§à¸™à¸ªà¸¹à¸‡
â”‚   â””â”€â”€ à¸à¸£à¸¸à¹Šà¸›à¹€à¸¥à¸·à¸­à¸”
â”‚
â”œâ”€â”€ ğŸ¥ à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸—à¸²à¸‡à¸à¸²à¸£à¹à¸à¸—à¸¢à¹Œ
â”‚   â”œâ”€â”€ à¹‚à¸£à¸„à¸›à¸£à¸°à¸ˆà¸³à¸•à¸±à¸§
â”‚   â”œâ”€â”€ à¹à¸à¹‰à¸¢à¸²
â”‚   â”œâ”€â”€ à¹à¸à¹‰à¸­à¸²à¸«à¸²à¸£
â”‚   â””â”€â”€ à¸«à¸¡à¸²à¸¢à¹€à¸«à¸•à¸¸à¸—à¸²à¸‡à¸à¸²à¸£à¹à¸à¸—à¸¢à¹Œ
â”‚
â”œâ”€â”€ ğŸ’Š à¸£à¸²à¸¢à¸à¸²à¸£à¸¢à¸²à¸›à¸£à¸°à¸ˆà¸³
â”‚   â”œâ”€â”€ à¸”à¸¹à¸£à¸²à¸¢à¸à¸²à¸£à¸¢à¸²à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”
â”‚   â”œâ”€â”€ à¹€à¸à¸´à¹ˆà¸¡à¸¢à¸²à¹ƒà¸«à¸¡à¹ˆ
â”‚   â”œâ”€â”€ à¹à¸à¹‰à¹„à¸‚à¸¢à¸²
â”‚   â””â”€â”€ à¸¥à¸šà¸¢à¸²
â”‚
â”œâ”€â”€ ğŸ¨ à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹‚à¸£à¸‡à¸à¸¢à¸²à¸šà¸²à¸¥/à¸«à¸¡à¸­
â”‚   â”œâ”€â”€ à¸Šà¸·à¹ˆà¸­à¹‚à¸£à¸‡à¸à¸¢à¸²à¸šà¸²à¸¥
â”‚   â”œâ”€â”€ à¸—à¸µà¹ˆà¸­à¸¢à¸¹à¹ˆ / à¹€à¸šà¸­à¸£à¹Œà¹‚à¸—à¸£
â”‚   â”œâ”€â”€ à¸Šà¸·à¹ˆà¸­à¸«à¸¡à¸­à¸›à¸£à¸°à¸ˆà¸³à¸•à¸±à¸§
â”‚   â””â”€â”€ à¹€à¸šà¸­à¸£à¹Œà¸«à¸¡à¸­
â”‚
â””â”€â”€ ğŸ“ à¸œà¸¹à¹‰à¸•à¸´à¸”à¸•à¹ˆà¸­à¸‰à¸¸à¸à¹€à¸‰à¸´à¸™
    â”œâ”€â”€ à¸Šà¸·à¹ˆà¸­
    â”œâ”€â”€ à¸„à¸§à¸²à¸¡à¸ªà¸±à¸¡à¸à¸±à¸™à¸˜à¹Œ
    â””â”€â”€ à¹€à¸šà¸­à¸£à¹Œà¹‚à¸—à¸£
```

#### Database Tables Used:
- `patient_profiles`
- `medications` / `patient_medications`
- `allergies`
- `emergency_contacts`

#### API Endpoints:
```
GET    /api/patient/[patientId]/profile
PUT    /api/patient/[patientId]/profile
GET    /api/patient/[patientId]/medications
POST   /api/patient/[patientId]/medications
PUT    /api/patient/[patientId]/medications/[medicationId]
DELETE /api/patient/[patientId]/medications/[medicationId]
GET    /api/patient/[patientId]/allergies
POST   /api/patient/[patientId]/allergies
GET    /api/patient/[patientId]/emergency-contacts
PUT    /api/patient/[patientId]/emergency-contacts
```

---

### 2. ğŸ©º à¸šà¸±à¸™à¸—à¸¶à¸à¸ªà¸¸à¸‚à¸ à¸²à¸ (Health Logging) - NEW

**Purpose:** à¸šà¸±à¸™à¸—à¸¶à¸à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ªà¸¸à¸‚à¸ à¸²à¸à¸›à¸£à¸°à¸ˆà¸³à¸§à¸±à¸™ à¸„à¸£à¸­à¸šà¸„à¸¥à¸¸à¸¡à¸—à¸¸à¸à¸¡à¸´à¸•à¸´ (à¸¢à¸², à¸„à¸§à¸²à¸¡à¸”à¸±à¸™, à¸™à¹‰à¸³, à¸­à¸²à¸à¸²à¸£)

**Action Type:** `uri` â†’ LIFF Page (health-log.html)

**LIFF URL:** `https://liff.line.me/{LIFF_ID}/health-log.html`

**Backup Trigger Message:** `à¸šà¸±à¸™à¸—à¸¶à¸à¸ªà¸¸à¸‚à¸ à¸²à¸` à¸«à¸£à¸·à¸­ `#à¸šà¸±à¸™à¸—à¸¶à¸` (à¸ªà¸³à¸«à¸£à¸±à¸š group chat à¸—à¸µà¹ˆà¹„à¸¡à¹ˆà¸¡à¸µ LIFF)

#### User Flow Options:

**Flow A: Flex Message Quick Select (Primary)**
```
User à¸à¸” "ğŸ©º à¸šà¸±à¸™à¸—à¸¶à¸à¸ªà¸¸à¸‚à¸ à¸²à¸"
  â†“
Bot à¹à¸ªà¸”à¸‡ Flex Message:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    ğŸ©º à¸šà¸±à¸™à¸—à¸¶à¸à¸ªà¸¸à¸‚à¸ à¸²à¸à¸§à¸±à¸™à¸™à¸µà¹‰      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ’Š à¸à¸´à¸™à¸¢à¸²      â”‚ ğŸ’‰ à¸„à¸§à¸²à¸¡à¸”à¸±à¸™   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ’§ à¸”à¸·à¹ˆà¸¡à¸™à¹‰à¸³     â”‚ ğŸƒ à¸­à¸­à¸à¸à¸³à¸¥à¸±à¸‡  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ˜´ à¸à¸²à¸£à¸™à¸­à¸™    â”‚ ğŸ¤’ à¸­à¸²à¸à¸²à¸£à¸›à¹ˆà¸§à¸¢ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ˜Š à¸­à¸²à¸£à¸¡à¸“à¹Œ     â”‚ âœï¸ à¸à¸´à¸¡à¸à¹Œà¹€à¸­à¸‡  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Flow B: Chat-based (Natural Conversation)**
```
User: "à¸§à¸±à¸™à¸™à¸µà¹‰à¸à¸´à¸™à¸¢à¸²à¹à¸¥à¹‰à¸§ à¸„à¸§à¸²à¸¡à¸”à¸±à¸™ 130/85 à¸£à¸¹à¹‰à¸ªà¸¶à¸à¹€à¸«à¸™à¸·à¹ˆà¸­à¸¢à¸™à¸´à¸”à¸«à¸™à¹ˆà¸­à¸¢"
  â†“
AI Extract & Save â†’ multiple tables
  â†“
Bot: "à¸šà¸±à¸™à¸—à¸¶à¸à¹ƒà¸«à¹‰à¹à¸¥à¹‰à¸§à¸„à¹ˆà¸° âœ…
      â€¢ ğŸ’Š à¸à¸´à¸™à¸¢à¸²à¹à¸¥à¹‰à¸§
      â€¢ ğŸ’‰ à¸„à¸§à¸²à¸¡à¸”à¸±à¸™ 130/85 (à¸›à¸à¸•à¸´)
      â€¢ ğŸ¤’ à¸­à¸²à¸à¸²à¸£: à¹€à¸«à¸™à¸·à¹ˆà¸­à¸¢ (à¹€à¸¥à¹‡à¸à¸™à¹‰à¸­à¸¢)"
```

**Flow C: Quick Commands (Shortcuts)**
```
User: "à¸à¸´à¸™à¸¢à¸²à¹à¸¥à¹‰à¸§"           â†’ à¸šà¸±à¸™à¸—à¸¶à¸ medication
User: "à¸„à¸§à¸²à¸¡à¸”à¸±à¸™ 120/80"      â†’ à¸šà¸±à¸™à¸—à¸¶à¸ vitals
User: "à¸”à¸·à¹ˆà¸¡à¸™à¹‰à¸³ 2 à¹à¸à¹‰à¸§"       â†’ à¸šà¸±à¸™à¸—à¸¶à¸ water
User: "à¹€à¸”à¸´à¸™ 30 à¸™à¸²à¸—à¸µ"        â†’ à¸šà¸±à¸™à¸—à¸¶à¸ exercise
User: "à¸™à¸­à¸™ 7 à¸Šà¸±à¹ˆà¸§à¹‚à¸¡à¸‡"       â†’ à¸šà¸±à¸™à¸—à¸¶à¸ sleep
User: "à¸§à¸±à¸™à¸™à¸µà¹‰à¸›à¸§à¸”à¸«à¸±à¸§"        â†’ à¸šà¸±à¸™à¸—à¸¶à¸ symptom
User: "à¸£à¸¹à¹‰à¸ªà¸¶à¸à¸”à¸µà¸¡à¸²à¸"         â†’ à¸šà¸±à¸™à¸—à¸¶à¸ mood
```

#### Health Logging Categories:

| Category | Icon | Thai | Database Table | Examples |
|----------|------|------|----------------|----------|
| Medication | ğŸ’Š | à¸à¸´à¸™à¸¢à¸² | activity_logs | à¸à¸´à¸™à¸¢à¸²à¹à¸¥à¹‰à¸§, à¸¢à¸²à¹€à¸Šà¹‰à¸², à¸¢à¸²à¹€à¸¢à¹‡à¸™ |
| Vitals | ğŸ’‰ | à¸„à¸§à¸²à¸¡à¸”à¸±à¸™/à¸Šà¸µà¸à¸ˆà¸£ | vitals_logs | à¸„à¸§à¸²à¸¡à¸”à¸±à¸™ 120/80, à¸Šà¸µà¸à¸ˆà¸£ 72 |
| Water | ğŸ’§ | à¸”à¸·à¹ˆà¸¡à¸™à¹‰à¸³ | water_intake_logs | à¸”à¸·à¹ˆà¸¡à¸™à¹‰à¸³ 2 à¹à¸à¹‰à¸§, 500ml |
| Exercise | ğŸƒ | à¸­à¸­à¸à¸à¸³à¸¥à¸±à¸‡à¸à¸²à¸¢ | exercise_logs | à¹€à¸”à¸´à¸™ 30 à¸™à¸²à¸—à¸µ, à¸§à¸´à¹ˆà¸‡ 5 à¸à¸¡. |
| Sleep | ğŸ˜´ | à¸à¸²à¸£à¸™à¸­à¸™ | sleep_logs | à¸™à¸­à¸™ 7 à¸Šà¸¡., à¸™à¸­à¸™à¸«à¸¥à¸±à¸šà¸”à¸µ |
| Symptom | ğŸ¤’ | à¸­à¸²à¸à¸²à¸£à¸›à¹ˆà¸§à¸¢ | symptoms | à¸›à¸§à¸”à¸«à¸±à¸§, à¹„à¸­, à¹€à¸ˆà¹‡à¸šà¸„à¸­ |
| Mood | ğŸ˜Š | à¸­à¸²à¸£à¸¡à¸“à¹Œ | mood_logs | à¸£à¸¹à¹‰à¸ªà¸¶à¸à¸”à¸µ, à¹€à¸„à¸£à¸µà¸¢à¸”, à¹€à¸«à¸™à¸·à¹ˆà¸­à¸¢ |

#### Symptom Sub-Categories (for ğŸ¤’ à¸­à¸²à¸à¸²à¸£à¸›à¹ˆà¸§à¸¢):

| Category | Thai | Examples |
|----------|------|----------|
| Head | à¸«à¸±à¸§ | à¸›à¸§à¸”à¸«à¸±à¸§, à¸¡à¸¶à¸™à¸«à¸±à¸§, à¸§à¸´à¸‡à¹€à¸§à¸µà¸¢à¸™ |
| Respiratory | à¸—à¸²à¸‡à¹€à¸”à¸´à¸™à¸«à¸²à¸¢à¹ƒà¸ˆ | à¹„à¸­, à¹€à¸ˆà¹‡à¸šà¸„à¸­, à¸«à¸²à¸¢à¹ƒà¸ˆà¸¥à¸³à¸šà¸²à¸, à¸¡à¸µà¹€à¸ªà¸¡à¸«à¸° |
| Digestive | à¸—à¸²à¸‡à¹€à¸”à¸´à¸™à¸­à¸²à¸«à¸²à¸£ | à¸„à¸¥à¸·à¹ˆà¸™à¹„à¸ªà¹‰, à¸­à¸²à¹€à¸ˆà¸µà¸¢à¸™, à¸—à¹‰à¸­à¸‡à¹€à¸ªà¸µà¸¢, à¸—à¹‰à¸­à¸‡à¸œà¸¹à¸ |
| Fever | à¹„à¸‚à¹‰ | à¹„à¸‚à¹‰à¸ªà¸¹à¸‡, à¸«à¸™à¸²à¸§à¸ªà¸±à¹ˆà¸™, à¹€à¸«à¸‡à¸·à¹ˆà¸­à¸­à¸­à¸ |
| Pain | à¸›à¸§à¸” | à¸›à¸§à¸”à¸«à¸¥à¸±à¸‡, à¸›à¸§à¸”à¸‚à¹‰à¸­, à¸›à¸§à¸”à¸à¸¥à¹‰à¸²à¸¡à¹€à¸™à¸·à¹‰à¸­ |
| Fatigue | à¹€à¸«à¸™à¸·à¹ˆà¸­à¸¢à¸¥à¹‰à¸² | à¸­à¹ˆà¸­à¸™à¹€à¸à¸¥à¸µà¸¢, à¹„à¸¡à¹ˆà¸¡à¸µà¹à¸£à¸‡, à¹€à¸«à¸™à¸·à¹ˆà¸­à¸¢à¸‡à¹ˆà¸²à¸¢ |
| Skin | à¸œà¸´à¸§à¸«à¸™à¸±à¸‡ | à¸œà¸·à¹ˆà¸™, à¸„à¸±à¸™, à¸šà¸§à¸¡ |
| Other | à¸­à¸·à¹ˆà¸™à¹† | à¸™à¸­à¸™à¹„à¸¡à¹ˆà¸«à¸¥à¸±à¸š, à¹ƒà¸ˆà¸ªà¸±à¹ˆà¸™, à¸•à¸²à¸à¸£à¹ˆà¸² |

#### Severity Scale (for symptoms):

| Level | Thai | Description |
|-------|------|-------------|
| 1 | à¹€à¸¥à¹‡à¸à¸™à¹‰à¸­à¸¢à¸¡à¸²à¸ | à¸£à¸¹à¹‰à¸ªà¸¶à¸à¹„à¸”à¹‰à¹à¸•à¹ˆà¹„à¸¡à¹ˆà¸à¸£à¸°à¸—à¸šà¸Šà¸µà¸§à¸´à¸•à¸›à¸£à¸°à¸ˆà¸³à¸§à¸±à¸™ |
| 2 | à¹€à¸¥à¹‡à¸à¸™à¹‰à¸­à¸¢ | à¸£à¸¹à¹‰à¸ªà¸¶à¸à¹„à¸¡à¹ˆà¸ªà¸šà¸²à¸¢ à¹à¸•à¹ˆà¸¢à¸±à¸‡à¸—à¸³à¸à¸´à¸ˆà¸à¸£à¸£à¸¡à¹„à¸”à¹‰ |
| 3 | à¸›à¸²à¸™à¸à¸¥à¸²à¸‡ | à¸à¸£à¸°à¸—à¸šà¸à¸²à¸£à¸—à¸³à¸à¸´à¸ˆà¸à¸£à¸£à¸¡à¸šà¹‰à¸²à¸‡ |
| 4 | à¸¡à¸²à¸ | à¸à¸£à¸°à¸—à¸šà¸à¸²à¸£à¸—à¸³à¸à¸´à¸ˆà¸à¸£à¸£à¸¡à¸­à¸¢à¹ˆà¸²à¸‡à¸¡à¸²à¸ |
| 5 | à¸£à¸¸à¸™à¹à¸£à¸‡à¸¡à¸²à¸ | à¸—à¸³à¸à¸´à¸ˆà¸à¸£à¸£à¸¡à¹„à¸¡à¹ˆà¹„à¸”à¹‰ / à¸•à¹‰à¸­à¸‡à¸à¸²à¸£à¸„à¸§à¸²à¸¡à¸Šà¹ˆà¸§à¸¢à¹€à¸«à¸¥à¸·à¸­ |

#### AI Features:

- **Natural Language Understanding**: à¹€à¸‚à¹‰à¸²à¹ƒà¸ˆà¸ à¸²à¸©à¸²à¹„à¸—à¸¢à¹à¸šà¸šà¸˜à¸£à¸£à¸¡à¸Šà¸²à¸•à¸´
  - "à¸§à¸±à¸™à¸™à¸µà¹‰à¸£à¸¹à¹‰à¸ªà¸¶à¸à¹€à¸ˆà¹‡à¸šà¸„à¸­à¸™à¸´à¸”à¹†" â†’ severity: 2, location: throat
  - "à¸›à¸§à¸”à¸«à¸±à¸§à¸¡à¸²à¸à¹€à¸¥à¸¢ à¸—à¸™à¹„à¸¡à¹ˆà¹„à¸«à¸§" â†’ severity: 4-5, location: head

- **Smart Alerts**: à¹à¸ˆà¹‰à¸‡à¹€à¸•à¸·à¸­à¸™à¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´
  - à¸­à¸²à¸à¸²à¸£à¸‹à¹‰à¸³ > 3 à¸§à¸±à¸™ â†’ à¹à¸™à¸°à¸™à¸³à¸à¸šà¹à¸à¸—à¸¢à¹Œ
  - à¸­à¸²à¸à¸²à¸£à¸£à¸¸à¸™à¹à¸£à¸‡ (4-5) â†’ à¹à¸ˆà¹‰à¸‡ caregiver à¸—à¸±à¸™à¸—à¸µ
  - à¸­à¸²à¸à¸²à¸£à¸‰à¸¸à¸à¹€à¸‰à¸´à¸™ â†’ à¹à¸ªà¸”à¸‡à¹€à¸šà¸­à¸£à¹Œ 1669

- **Pattern Recognition**: à¸•à¸´à¸”à¸•à¸²à¸¡à¹à¸™à¸§à¹‚à¸™à¹‰à¸¡
  - à¸­à¸²à¸à¸²à¸£à¸—à¸µà¹ˆà¹€à¸à¸´à¸”à¸‹à¹‰à¸³à¸šà¹ˆà¸­à¸¢
  - à¸„à¸§à¸²à¸¡à¸ªà¸±à¸¡à¸à¸±à¸™à¸˜à¹Œà¸à¸±à¸šà¸¢à¸²/à¸à¸´à¸ˆà¸à¸£à¸£à¸¡
  - à¹à¸™à¸§à¹‚à¸™à¹‰à¸¡à¸”à¸µà¸‚à¸¶à¹‰à¸™/à¹à¸¢à¹ˆà¸¥à¸‡

#### Database Tables Used:
- `symptoms` (primary)
- `health_events` (linking table)
- `conversation_logs` (raw text)

#### Database Schema - `symptoms`:
```sql
CREATE TABLE symptoms (
  id uuid PRIMARY KEY,
  patient_id uuid NOT NULL,
  activity_log_id uuid,
  conversation_log_id uuid,

  -- Symptom Data
  symptom_name varchar NOT NULL,      -- 'à¸›à¸§à¸”à¸«à¸±à¸§', 'à¹„à¸­', 'à¹€à¸ˆà¹‡à¸šà¸„à¸­'
  symptom_name_en varchar,            -- 'headache', 'cough', 'sore_throat'
  severity_1to5 integer,              -- 1-5
  body_location varchar,              -- 'head', 'throat', 'chest'
  body_location_th varchar,           -- 'à¸«à¸±à¸§', 'à¸„à¸­', 'à¸«à¸™à¹‰à¸²à¸­à¸'

  -- Duration
  duration_text varchar,              -- '2 à¸§à¸±à¸™', '3-4 à¸Šà¸±à¹ˆà¸§à¹‚à¸¡à¸‡'
  duration_minutes integer,
  started_at timestamptz,

  -- Context
  time_of_day varchar,                -- 'morning', 'afternoon', 'evening'
  triggers text,                      -- à¸ªà¸²à¹€à¸«à¸•à¸¸à¸—à¸µà¹ˆà¹€à¸›à¹‡à¸™à¹„à¸›à¹„à¸”à¹‰
  associated_symptoms text[],         -- à¸­à¸²à¸à¸²à¸£à¸£à¹ˆà¸§à¸¡ ['à¹„à¸‚à¹‰', 'à¸«à¸™à¸²à¸§à¸ªà¸±à¹ˆà¸™']

  -- AI Metadata
  ai_confidence decimal(3,2),
  raw_text text,

  notes text,
  created_at timestamptz DEFAULT now()
);
```

#### API Endpoints:
```
GET    /api/patient/[patientId]/symptoms
GET    /api/patient/[patientId]/symptoms?from=YYYY-MM-DD&to=YYYY-MM-DD
POST   /api/patient/[patientId]/symptoms
GET    /api/patient/[patientId]/symptoms/[symptomId]
PUT    /api/patient/[patientId]/symptoms/[symptomId]
DELETE /api/patient/[patientId]/symptoms/[symptomId]
GET    /api/patient/[patientId]/symptoms/summary  # à¸ªà¸£à¸¸à¸›à¸­à¸²à¸à¸²à¸£à¸—à¸µà¹ˆà¸à¸šà¸šà¹ˆà¸­à¸¢
```

#### NLU Integration:

```typescript
// NLU extracts symptom data from natural conversation
interface SymptomHealthData {
  symptom: string;           // "à¹€à¸ˆà¹‡à¸šà¸„à¸­"
  severity?: 'mild' | 'moderate' | 'severe';
  duration?: string;         // "2 à¸§à¸±à¸™"
  location?: string;         // "throat"
  notes?: string;
}

// Example NLU result
{
  intent: "health_log",
  subIntent: "symptom",
  healthData: {
    type: "symptom",
    symptom: {
      symptom: "à¹€à¸ˆà¹‡à¸šà¸„à¸­, à¹„à¸­à¸¡à¸µà¹€à¸ªà¸¡à¸«à¸°",
      severity: "mild",
      location: "throat",
      notes: "à¸§à¸±à¸™à¸™à¸µà¹‰à¸£à¸¹à¹‰à¸ªà¸¶à¸à¹€à¸ˆà¹‡à¸šà¸„à¸­à¸™à¸´à¸”à¹† à¹„à¸­à¸¡à¸µà¹€à¸ªà¸¡à¸«à¸°"
    }
  },
  action: {
    type: "save",
    target: "symptoms"
  },
  response: "à¸šà¸±à¸™à¸—à¸¶à¸à¸­à¸²à¸à¸²à¸£à¹à¸¥à¹‰à¸§à¸„à¹ˆà¸°..."
}
```

---

### 3. ğŸ“Š à¸£à¸²à¸¢à¸‡à¸²à¸™à¸ªà¸¸à¸‚à¸ à¸²à¸ (Health Reports)

**Purpose:** à¸”à¸¹à¸ªà¸£à¸¸à¸›à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ªà¸¸à¸‚à¸ à¸²à¸ à¸£à¸²à¸¢à¸§à¸±à¸™/à¸ªà¸±à¸›à¸”à¸²à¸«à¹Œ/à¹€à¸”à¸·à¸­à¸™ à¸à¸£à¹‰à¸­à¸¡à¸à¸£à¸²à¸Ÿ

**Action Type:** `message` â†’ à¸ªà¹ˆà¸‡ Flex Message à¹ƒà¸«à¹‰à¹€à¸¥à¸·à¸­à¸à¸›à¸£à¸°à¹€à¸ à¸—à¸£à¸²à¸¢à¸‡à¸²à¸™

**Trigger Message:** `#à¸£à¸²à¸¢à¸‡à¸²à¸™` à¸«à¸£à¸·à¸­ `à¸”à¸¹à¸£à¸²à¸¢à¸‡à¸²à¸™`

#### Flex Message Options:

```
ğŸ“Š à¹€à¸¥à¸·à¸­à¸à¸›à¸£à¸°à¹€à¸ à¸—à¸£à¸²à¸¢à¸‡à¸²à¸™
â”œâ”€â”€ ğŸ“… à¸£à¸²à¸¢à¸‡à¸²à¸™à¸§à¸±à¸™à¸™à¸µà¹‰
â”‚   â””â”€â”€ Action: message â†’ "#à¸£à¸²à¸¢à¸‡à¸²à¸™à¸§à¸±à¸™à¸™à¸µà¹‰"
â”‚
â”œâ”€â”€ ğŸ“ˆ à¸£à¸²à¸¢à¸‡à¸²à¸™à¸ªà¸±à¸›à¸”à¸²à¸«à¹Œ
â”‚   â””â”€â”€ Action: message â†’ "#à¸£à¸²à¸¢à¸‡à¸²à¸™à¸ªà¸±à¸›à¸”à¸²à¸«à¹Œ"
â”‚
â”œâ”€â”€ ğŸ“Š à¸£à¸²à¸¢à¸‡à¸²à¸™à¹€à¸”à¸·à¸­à¸™
â”‚   â””â”€â”€ Action: message â†’ "#à¸£à¸²à¸¢à¸‡à¸²à¸™à¹€à¸”à¸·à¸­à¸™"
â”‚
â””â”€â”€ ğŸ“‰ à¸£à¸²à¸¢à¸‡à¸²à¸™à¸à¸£à¹‰à¸­à¸¡à¸à¸£à¸²à¸Ÿ
    â””â”€â”€ Action: uri â†’ LIFF "/reports"
```

#### Report Contents:

**à¸£à¸²à¸¢à¸‡à¸²à¸™à¸§à¸±à¸™à¸™à¸µà¹‰:**
- à¸ªà¸£à¸¸à¸›à¸à¸´à¸ˆà¸à¸£à¸£à¸¡à¸§à¸±à¸™à¸™à¸µà¹‰
- à¸„à¹ˆà¸²à¸„à¸§à¸²à¸¡à¸”à¸±à¸™/à¸Šà¸µà¸à¸ˆà¸£à¸¥à¹ˆà¸²à¸ªà¸¸à¸”
- à¸ªà¸–à¸²à¸™à¸°à¸à¸²à¸£à¸—à¸²à¸™à¸¢à¸²
- à¸›à¸£à¸´à¸¡à¸²à¸“à¸™à¹‰à¸³à¸—à¸µà¹ˆà¸”à¸·à¹ˆà¸¡
- **à¸­à¸²à¸à¸²à¸£à¸—à¸µà¹ˆà¹à¸ˆà¹‰à¸‡ (à¸–à¹‰à¸²à¸¡à¸µ)** â† à¸£à¸§à¸¡ symptoms
- à¸­à¸²à¸£à¸¡à¸“à¹Œ/à¸„à¸§à¸²à¸¡à¸£à¸¹à¹‰à¸ªà¸¶à¸

**à¸£à¸²à¸¢à¸‡à¸²à¸™à¸ªà¸±à¸›à¸”à¸²à¸«à¹Œ:**
- à¸ªà¸£à¸¸à¸› 7 à¸§à¸±à¸™à¸¢à¹‰à¸­à¸™à¸«à¸¥à¸±à¸‡
- à¸„à¹ˆà¸²à¹€à¸‰à¸¥à¸µà¹ˆà¸¢à¸„à¸§à¸²à¸¡à¸”à¸±à¸™/à¸Šà¸µà¸à¸ˆà¸£
- % à¸à¸²à¸£à¸—à¸²à¸™à¸¢à¸²à¸•à¸£à¸‡à¹€à¸§à¸¥à¸²
- à¹à¸™à¸§à¹‚à¸™à¹‰à¸¡à¸ªà¸¸à¸‚à¸ à¸²à¸
- **à¸­à¸²à¸à¸²à¸£à¸—à¸µà¹ˆà¹€à¸à¸´à¸”à¸‹à¹‰à¸³** â† à¸ªà¸£à¸¸à¸›à¸ˆà¸²à¸ symptoms

**à¸£à¸²à¸¢à¸‡à¸²à¸™à¹€à¸”à¸·à¸­à¸™:**
- à¸ªà¸£à¸¸à¸› 30 à¸§à¸±à¸™à¸¢à¹‰à¸­à¸™à¸«à¸¥à¸±à¸‡
- à¸ªà¸–à¸´à¸•à¸´à¸ à¸²à¸à¸£à¸§à¸¡
- AI insights
- à¸„à¸³à¹à¸™à¸°à¸™à¸³à¸ˆà¸²à¸à¸£à¸°à¸šà¸š
- **Pattern à¸­à¸²à¸à¸²à¸£à¸—à¸µà¹ˆà¸à¸š** â† à¸§à¸´à¹€à¸„à¸£à¸²à¸°à¸«à¹Œà¸ˆà¸²à¸ symptoms

**à¸£à¸²à¸¢à¸‡à¸²à¸™à¸à¸£à¹‰à¸­à¸¡à¸à¸£à¸²à¸Ÿ (LIFF):**
- à¸à¸£à¸²à¸Ÿà¸„à¸§à¸²à¸¡à¸”à¸±à¸™à¹‚à¸¥à¸«à¸´à¸•
- à¸à¸£à¸²à¸Ÿà¸Šà¸µà¸à¸ˆà¸£
- à¸à¸£à¸²à¸Ÿà¸™à¹‰à¸³à¸«à¸™à¸±à¸
- à¸›à¸à¸´à¸—à¸´à¸™à¸à¸²à¸£à¸—à¸²à¸™à¸¢à¸²
- **Timeline à¸­à¸²à¸à¸²à¸£** â† à¹à¸ªà¸”à¸‡ symptoms à¸šà¸™ timeline
- Export PDF/CSV

#### Database Tables Used:
- `vitals_logs`
- `medication_logs`
- `mood_logs`
- `sleep_logs`
- `symptoms` â† NEW
- `water_intake_logs`
- `exercise_logs`
- `daily_patient_summaries`
- `health_events`

#### API Endpoints:
```
GET /api/reports/[patientId]/daily?date=YYYY-MM-DD
GET /api/reports/[patientId]/weekly?startDate=YYYY-MM-DD
GET /api/reports/[patientId]/monthly?month=YYYY-MM
GET /api/reports/[patientId]/vitals?from=YYYY-MM-DD&to=YYYY-MM-DD
GET /api/reports/[patientId]/symptoms?from=YYYY-MM-DD&to=YYYY-MM-DD
GET /api/reports/[patientId]/export?format=pdf|csv&from=&to=
```

---

### 4. ğŸ”” à¹à¸ˆà¹‰à¸‡à¹€à¸•à¸·à¸­à¸™ (Reminders)

**Purpose:** à¸ˆà¸±à¸”à¸à¸²à¸£à¸à¸²à¸£à¹à¸ˆà¹‰à¸‡à¹€à¸•à¸·à¸­à¸™à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸” (à¸¢à¸², à¸™à¹‰à¸³, à¸­à¸­à¸à¸à¸³à¸¥à¸±à¸‡à¸à¸²à¸¢, à¸£à¸²à¸¢à¸‡à¸²à¸™)

**Action Type:** `uri` â†’ LIFF Page

**LIFF URL:** `https://liff.line.me/{LIFF_ID}/reminders`

#### Sub-sections:

```
ğŸ”” à¹à¸ˆà¹‰à¸‡à¹€à¸•à¸·à¸­à¸™
â”œâ”€â”€ ğŸ’Š à¹€à¸•à¸·à¸­à¸™à¸—à¸²à¸™à¸¢à¸²
â”‚   â”œâ”€â”€ à¹€à¸›à¸´à¸”/à¸›à¸´à¸” à¸à¸²à¸£à¹à¸ˆà¹‰à¸‡à¹€à¸•à¸·à¸­à¸™
â”‚   â”œâ”€â”€ à¸£à¸²à¸¢à¸à¸²à¸£à¸¢à¸²à¹à¸¥à¸°à¹€à¸§à¸¥à¸²
â”‚   â”‚   â”œâ”€â”€ à¸¢à¸² A - 08:00, 20:00
â”‚   â”‚   â”œâ”€â”€ à¸¢à¸² B - 12:00
â”‚   â”‚   â””â”€â”€ + à¹€à¸à¸´à¹ˆà¸¡à¸¢à¸²
â”‚   â””â”€â”€ à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸²à¸à¸²à¸£à¹€à¸•à¸·à¸­à¸™à¸¥à¹ˆà¸§à¸‡à¸«à¸™à¹‰à¸² (5/10/15 à¸™à¸²à¸—à¸µ)
â”‚
â”œâ”€â”€ ğŸ’§ à¹€à¸•à¸·à¸­à¸™à¸”à¸·à¹ˆà¸¡à¸™à¹‰à¸³
â”‚   â”œâ”€â”€ à¹€à¸›à¸´à¸”/à¸›à¸´à¸” à¸à¸²à¸£à¹à¸ˆà¹‰à¸‡à¹€à¸•à¸·à¸­à¸™
â”‚   â”œâ”€â”€ à¹€à¸›à¹‰à¸²à¸«à¸¡à¸²à¸¢à¸•à¹ˆà¸­à¸§à¸±à¸™ (ml)
â”‚   â”œâ”€â”€ à¹€à¸•à¸·à¸­à¸™à¸—à¸¸à¸à¸à¸µà¹ˆà¸Šà¸±à¹ˆà¸§à¹‚à¸¡à¸‡
â”‚   â”œâ”€â”€ à¸Šà¹ˆà¸§à¸‡à¹€à¸§à¸¥à¸²à¹€à¸£à¸´à¹ˆà¸¡ (à¹€à¸Šà¹ˆà¸™ 07:00)
â”‚   â””â”€â”€ à¸Šà¹ˆà¸§à¸‡à¹€à¸§à¸¥à¸²à¸ªà¸´à¹‰à¸™à¸ªà¸¸à¸” (à¹€à¸Šà¹ˆà¸™ 21:00)
â”‚
â”œâ”€â”€ ğŸƒ à¹€à¸•à¸·à¸­à¸™à¸­à¸­à¸à¸à¸³à¸¥à¸±à¸‡à¸à¸²à¸¢
â”‚   â”œâ”€â”€ à¹€à¸›à¸´à¸”/à¸›à¸´à¸” à¸à¸²à¸£à¹à¸ˆà¹‰à¸‡à¹€à¸•à¸·à¸­à¸™
â”‚   â”œâ”€â”€ à¹€à¸§à¸¥à¸²à¸—à¸µà¹ˆà¸•à¹‰à¸­à¸‡à¸à¸²à¸£à¹ƒà¸«à¹‰à¹€à¸•à¸·à¸­à¸™
â”‚   â””â”€â”€ à¸§à¸±à¸™à¸—à¸µà¹ˆà¸•à¹‰à¸­à¸‡à¸à¸²à¸£ (à¸ˆ-à¸­à¸²)
â”‚
â”œâ”€â”€ ğŸ“Š à¸ªà¹ˆà¸‡à¸£à¸²à¸¢à¸‡à¸²à¸™à¸›à¸£à¸°à¸ˆà¸³à¸§à¸±à¸™
â”‚   â”œâ”€â”€ à¹€à¸›à¸´à¸”/à¸›à¸´à¸”
â”‚   â””â”€â”€ à¹€à¸§à¸¥à¸²à¸ªà¹ˆà¸‡ (à¹€à¸Šà¹ˆà¸™ 20:00)
â”‚
â””â”€â”€ ğŸš¨ à¹à¸ˆà¹‰à¸‡à¹€à¸•à¸·à¸­à¸™à¸‰à¸¸à¸à¹€à¸‰à¸´à¸™
    â”œâ”€â”€ à¹à¸ˆà¹‰à¸‡à¹€à¸•à¸·à¸­à¸™à¸–à¹‰à¸²à¹„à¸¡à¹ˆà¸¡à¸µ activity à¸™à¸²à¸™à¹€à¸à¸´à¸™ X à¸Šà¸¡.
    â””â”€â”€ à¹à¸ˆà¹‰à¸‡à¹„à¸›à¸¢à¸±à¸‡ caregiver
```

#### UI Components:

```typescript
// Reminder Card Component
interface ReminderCard {
  type: 'medication' | 'water' | 'exercise' | 'report' | 'emergency';
  enabled: boolean;
  settings: {
    // medication
    medications?: {
      id: string;
      name: string;
      times: string[]; // ["08:00", "20:00"]
      days: string[];  // ["mon", "tue", ...]
    }[];

    // water
    goalMl?: number;
    intervalHours?: number;
    startTime?: string;
    endTime?: string;

    // exercise
    reminderTime?: string;
    daysOfWeek?: string[];

    // report
    reportTime?: string;

    // emergency
    noActivityThresholdHours?: number;
    notifyCaregiver?: boolean;
  };
}
```

#### Database Tables Used:
- `reminders`
- `notification_settings`
- `medications`
- `water_intake_goals`
- `health_goals`

#### API Endpoints:
```
GET    /api/patient/[patientId]/reminders
POST   /api/patient/[patientId]/reminders
PUT    /api/patient/[patientId]/reminders/[reminderId]
DELETE /api/patient/[patientId]/reminders/[reminderId]
GET    /api/patient/[patientId]/notification-settings
PUT    /api/patient/[patientId]/notification-settings
```

---

### 5. âš™ï¸ à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸² (Settings)

**Purpose:** à¸à¸²à¸£à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸²à¸£à¸°à¸šà¸šà¸—à¸±à¹ˆà¸§à¹„à¸›, à¸„à¸§à¸²à¸¡à¹€à¸›à¹‡à¸™à¸ªà¹ˆà¸§à¸™à¸•à¸±à¸§, à¸šà¸±à¸à¸Šà¸µ

**Action Type:** `uri` â†’ LIFF Page

**LIFF URL:** `https://liff.line.me/{LIFF_ID}/settings`

#### Sub-sections:

```
âš™ï¸ à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸²
â”œâ”€â”€ ğŸŒ à¸ à¸²à¸©à¸²
â”‚   â”œâ”€â”€ à¹„à¸—à¸¢ (default)
â”‚   â””â”€â”€ English
â”‚
â”œâ”€â”€ ğŸ¤– à¸à¸²à¸£à¸•à¸­à¸šà¸à¸¥à¸±à¸šà¸‚à¸­à¸‡à¸­à¸¸à¹ˆà¸™à¹ƒà¸ˆ
â”‚   â”œâ”€â”€ à¹‚à¸—à¸™à¸à¸²à¸£à¸à¸¹à¸” (à¸ªà¸¸à¸ à¸²à¸/à¹€à¸›à¹‡à¸™à¸à¸±à¸™à¹€à¸­à¸‡)
â”‚   â””â”€â”€ à¸„à¸§à¸²à¸¡à¸¢à¸²à¸§à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡ (à¸ªà¸±à¹‰à¸™/à¸›à¸²à¸™à¸à¸¥à¸²à¸‡/à¸¥à¸°à¹€à¸­à¸µà¸¢à¸”)
â”‚
â”œâ”€â”€ ğŸ”” à¸à¸²à¸£à¹à¸ˆà¹‰à¸‡à¹€à¸•à¸·à¸­à¸™à¸—à¸±à¹ˆà¸§à¹„à¸›
â”‚   â”œâ”€â”€ à¹€à¸›à¸´à¸”/à¸›à¸´à¸” notification à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”
â”‚   â””â”€â”€ à¹‚à¸«à¸¡à¸”à¸«à¹‰à¸²à¸¡à¸£à¸šà¸à¸§à¸™ (à¹€à¸§à¸¥à¸²)
â”‚
â”œâ”€â”€ ğŸ‘¥ à¸œà¸¹à¹‰à¸”à¸¹à¹à¸¥ (Caregivers)
â”‚   â”œâ”€â”€ à¸”à¸¹à¸£à¸²à¸¢à¸Šà¸·à¹ˆà¸­à¸œà¸¹à¹‰à¸”à¸¹à¹à¸¥
â”‚   â”œâ”€â”€ à¹€à¸Šà¸´à¸à¸œà¸¹à¹‰à¸”à¸¹à¹à¸¥à¹ƒà¸«à¸¡à¹ˆ
â”‚   â”œâ”€â”€ à¸ˆà¸±à¸”à¸à¸²à¸£à¸ªà¸´à¸—à¸˜à¸´à¹Œ
â”‚   â””â”€â”€ à¸¥à¸šà¸œà¸¹à¹‰à¸”à¸¹à¹à¸¥
â”‚
â”œâ”€â”€ ğŸ”’ à¸„à¸§à¸²à¸¡à¹€à¸›à¹‡à¸™à¸ªà¹ˆà¸§à¸™à¸•à¸±à¸§
â”‚   â”œâ”€â”€ à¹ƒà¸„à¸£à¹€à¸«à¹‡à¸™à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸‚à¸­à¸‡à¸‰à¸±à¸™
â”‚   â”œâ”€â”€ à¹à¸Šà¸£à¹Œà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸à¸±à¸šà¸œà¸¹à¹‰à¸”à¸¹à¹à¸¥
â”‚   â””â”€â”€ à¸”à¸²à¸§à¸™à¹Œà¹‚à¸«à¸¥à¸”à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸‚à¸­à¸‡à¸‰à¸±à¸™
â”‚
â”œâ”€â”€ ğŸ“± à¹€à¸à¸µà¹ˆà¸¢à¸§à¸à¸±à¸šà¹à¸­à¸›
â”‚   â”œâ”€â”€ à¹€à¸§à¸­à¸£à¹Œà¸Šà¸±à¸™
â”‚   â”œâ”€â”€ à¸‚à¹‰à¸­à¸à¸³à¸«à¸™à¸”à¸à¸²à¸£à¹ƒà¸Šà¹‰à¸‡à¸²à¸™
â”‚   â””â”€â”€ à¸™à¹‚à¸¢à¸šà¸²à¸¢à¸„à¸§à¸²à¸¡à¹€à¸›à¹‡à¸™à¸ªà¹ˆà¸§à¸™à¸•à¸±à¸§
â”‚
â””â”€â”€ ğŸšª à¸šà¸±à¸à¸Šà¸µ
    â”œâ”€â”€ à¸­à¸­à¸à¸ˆà¸²à¸à¸£à¸°à¸šà¸š
    â””â”€â”€ à¸¥à¸šà¸šà¸±à¸à¸Šà¸µ
```

#### Database Tables Used:
- `users`
- `patient_profiles`
- `patient_caregivers`
- `caregiver_profiles`
- `notification_settings`

#### API Endpoints:
```
GET  /api/patient/[patientId]/settings
PUT  /api/patient/[patientId]/settings
GET  /api/patient/[patientId]/caregivers
POST /api/patient/[patientId]/caregivers/invite
PUT  /api/patient/[patientId]/caregivers/[caregiverId]
DELETE /api/patient/[patientId]/caregivers/[caregiverId]
GET  /api/patient/[patientId]/export-data
DELETE /api/patient/[patientId]/account
```

---

## ğŸ–¼ï¸ Rich Menu Configuration

### LINE Rich Menu JSON (5 Menus)

```json
{
  "size": {
    "width": 2500,
    "height": 843
  },
  "selected": true,
  "name": "OONJAI Main Menu v2",
  "chatBarText": "à¹€à¸¡à¸™à¸¹",
  "areas": [
    {
      "bounds": {
        "x": 0,
        "y": 0,
        "width": 500,
        "height": 843
      },
      "action": {
        "type": "uri",
        "uri": "https://liff.line.me/{LIFF_ID}/profile"
      }
    },
    {
      "bounds": {
        "x": 500,
        "y": 0,
        "width": 500,
        "height": 843
      },
      "action": {
        "type": "uri",
        "uri": "https://liff.line.me/{LIFF_ID}/health-log.html"
      }
    },
    {
      "bounds": {
        "x": 1000,
        "y": 0,
        "width": 500,
        "height": 843
      },
      "action": {
        "type": "message",
        "text": "#à¸£à¸²à¸¢à¸‡à¸²à¸™"
      }
    },
    {
      "bounds": {
        "x": 1500,
        "y": 0,
        "width": 500,
        "height": 843
      },
      "action": {
        "type": "uri",
        "uri": "https://liff.line.me/{LIFF_ID}/reminders"
      }
    },
    {
      "bounds": {
        "x": 2000,
        "y": 0,
        "width": 500,
        "height": 843
      },
      "action": {
        "type": "uri",
        "uri": "https://liff.line.me/{LIFF_ID}/settings"
      }
    }
  ]
}
```

### Rich Menu Image Specifications

```
Dimensions: 2500 x 843 pixels
Format: PNG or JPEG
Max file size: 1 MB

Layout (5 equal columns):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  500px   â”‚  500px   â”‚  500px   â”‚  500px   â”‚  500px   â”‚
â”‚          â”‚          â”‚          â”‚          â”‚          â”‚
â”‚    ğŸ‘¤    â”‚    ğŸ©º    â”‚    ğŸ“Š    â”‚    ğŸ””    â”‚    âš™ï¸    â”‚
â”‚  à¸‚à¹‰à¸­à¸¡à¸¹à¸¥   â”‚  à¸šà¸±à¸™à¸—à¸¶à¸   â”‚  à¸£à¸²à¸¢à¸‡à¸²à¸™   â”‚ à¹à¸ˆà¹‰à¸‡à¹€à¸•à¸·à¸­à¸™ â”‚  à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸²  â”‚
â”‚  à¸‚à¸­à¸‡à¸„à¸¸à¸“   â”‚  à¸ªà¸¸à¸‚à¸ à¸²à¸   â”‚  à¸ªà¸¸à¸‚à¸ à¸²à¸   â”‚          â”‚          â”‚
â”‚          â”‚          â”‚          â”‚          â”‚          â”‚
â”‚  843px   â”‚          â”‚          â”‚          â”‚          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Design Guidelines

```
Background: #FFFFFF or soft gradient
Icon size: ~180x180 px centered
Icon style: Flat, rounded, friendly
Text:
  - Font: Noto Sans Thai or similar
  - Size: ~40-48px
  - Color: #333333 or brand color
  - Position: Below icon, centered

Colors per menu:
- à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸‚à¸­à¸‡à¸„à¸¸à¸“: #4A90D9 (Blue)
- à¸šà¸±à¸™à¸—à¸¶à¸à¸ªà¸¸à¸‚à¸ à¸²à¸: #E74C3C (Red) â† NEW
- à¸£à¸²à¸¢à¸‡à¸²à¸™à¸ªà¸¸à¸‚à¸ à¸²à¸: #5CB85C (Green)
- à¹à¸ˆà¹‰à¸‡à¹€à¸•à¸·à¸­à¸™: #F0AD4E (Orange)
- à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸²: #6C757D (Gray)
```

---

## ğŸ“ LIFF Pages Structure

### File Structure

```
src/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ liff/
â”‚   â”‚   â”œâ”€â”€ profile/
â”‚   â”‚   â”‚   â””â”€â”€ page.tsx           # à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸‚à¸­à¸‡à¸„à¸¸à¸“
â”‚   â”‚   â”œâ”€â”€ symptoms/
â”‚   â”‚   â”‚   â””â”€â”€ page.tsx           # à¸šà¸±à¸™à¸—à¸¶à¸à¸­à¸²à¸à¸²à¸£ (LIFF form) â† NEW
â”‚   â”‚   â”œâ”€â”€ reports/
â”‚   â”‚   â”‚   â””â”€â”€ page.tsx           # à¸£à¸²à¸¢à¸‡à¸²à¸™à¸ªà¸¸à¸‚à¸ à¸²à¸ (à¸à¸£à¸²à¸Ÿ)
â”‚   â”‚   â”œâ”€â”€ reminders/
â”‚   â”‚   â”‚   â””â”€â”€ page.tsx           # à¹à¸ˆà¹‰à¸‡à¹€à¸•à¸·à¸­à¸™
â”‚   â”‚   â”œâ”€â”€ settings/
â”‚   â”‚   â”‚   â””â”€â”€ page.tsx           # à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸²
â”‚   â”‚   â””â”€â”€ layout.tsx             # LIFF Layout wrapper
â”‚   â””â”€â”€ ...
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ liff/
â”‚   â”‚   â”œâ”€â”€ ProfileForm.tsx
â”‚   â”‚   â”œâ”€â”€ SymptomForm.tsx        # â† NEW
â”‚   â”‚   â”œâ”€â”€ SymptomHistory.tsx     # â† NEW
â”‚   â”‚   â”œâ”€â”€ MedicationList.tsx
â”‚   â”‚   â”œâ”€â”€ ReminderCard.tsx
â”‚   â”‚   â”œâ”€â”€ ReportChart.tsx
â”‚   â”‚   â””â”€â”€ SettingsPanel.tsx
â”‚   â””â”€â”€ ...
â””â”€â”€ lib/
    â””â”€â”€ liff/
        â”œâ”€â”€ init.ts                # LIFF initialization
        â””â”€â”€ auth.ts                # LIFF authentication
```

### LIFF Initialization

```typescript
// lib/liff/init.ts
import liff from '@line/liff';

export async function initializeLiff(liffId: string) {
  try {
    await liff.init({ liffId });

    if (!liff.isLoggedIn()) {
      liff.login();
      return null;
    }

    const profile = await liff.getProfile();
    return {
      userId: profile.userId,
      displayName: profile.displayName,
      pictureUrl: profile.pictureUrl,
    };
  } catch (error) {
    console.error('LIFF initialization failed:', error);
    throw error;
  }
}

export function closeLiff() {
  liff.closeWindow();
}

export function sendMessage(message: string) {
  if (liff.isInClient()) {
    liff.sendMessages([{ type: 'text', text: message }]);
  }
}
```

---

## ğŸ”§ Environment Variables

```env
# LINE
LINE_CHANNEL_ACCESS_TOKEN=your_token
LINE_CHANNEL_SECRET=your_secret

# LIFF
LIFF_ID=your_liff_id
NEXT_PUBLIC_LIFF_ID=your_liff_id

# Supabase
SUPABASE_URL=your_url
SUPABASE_SERVICE_KEY=your_service_key
NEXT_PUBLIC_SUPABASE_URL=your_url
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_anon_key

# App
NEXT_PUBLIC_APP_URL=https://your-app.vercel.app
```

---

## ğŸ“ Implementation Checklist

### Rich Menu Setup
- [ ] à¸ªà¸£à¹‰à¸²à¸‡ Rich Menu image à¹ƒà¸«à¸¡à¹ˆ (2500x843px, 5 columns)
- [ ] Upload Rich Menu à¸œà¹ˆà¸²à¸™ LINE API
- [ ] à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸² Rich Menu areas à¹à¸¥à¸° actions (5 areas)
- [ ] Link Rich Menu à¸à¸±à¸š LINE Official Account

### LIFF Pages
- [ ] à¸ªà¸£à¹‰à¸²à¸‡ LIFF App à¹ƒà¸™ LINE Developers Console
- [ ] Implement `/liff/profile` page
- [ ] Implement `/liff/symptoms` page â† NEW
- [ ] Implement `/liff/reminders` page
- [ ] Implement `/liff/settings` page
- [ ] Implement `/liff/reports` page (graphs)

### API Endpoints
- [ ] Patient profile CRUD
- [ ] Medications CRUD
- [ ] **Symptoms CRUD** â† NEW
- [ ] Reminders CRUD
- [ ] Notification settings
- [ ] Reports generation (include symptoms)

### Message Handlers
- [ ] Handle `à¸šà¸±à¸™à¸—à¸¶à¸à¸ªà¸¸à¸‚à¸ à¸²à¸` command â†’ Flex Message health menu â† NEW
- [ ] Handle `#à¸£à¸²à¸¢à¸‡à¸²à¸™` command â†’ Flex Message à¹€à¸¥à¸·à¸­à¸à¸›à¸£à¸°à¹€à¸ à¸—
- [ ] Handle `#à¸£à¸²à¸¢à¸‡à¸²à¸™à¸§à¸±à¸™à¸™à¸µà¹‰` command â†’ Flex Message à¸£à¸²à¸¢à¸‡à¸²à¸™à¸§à¸±à¸™
- [ ] Handle `#à¸£à¸²à¸¢à¸‡à¸²à¸™à¸ªà¸±à¸›à¸”à¸²à¸«à¹Œ` command â†’ Flex Message à¸£à¸²à¸¢à¸‡à¸²à¸™à¸ªà¸±à¸›à¸”à¸²à¸«à¹Œ
- [ ] Handle `#à¸£à¸²à¸¢à¸‡à¸²à¸™à¹€à¸”à¸·à¸­à¸™` command â†’ Flex Message à¸£à¸²à¸¢à¸‡à¸²à¸™à¹€à¸”à¸·à¸­à¸™
- [ ] Handle health logging via chat (AI extraction)
- [ ] Handle symptom logging via chat (AI extraction) â† NEW
- [ ] Handle quick commands (`à¸à¸´à¸™à¸¢à¸²à¹à¸¥à¹‰à¸§`, `à¸„à¸§à¸²à¸¡à¸”à¸±à¸™ 120/80`)

---

## ğŸ¨ Visual Reference

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           OONJAI Rich Menu v2                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚             â”‚             â”‚             â”‚             â”‚                         â”‚
â”‚     ğŸ‘¤      â”‚     ğŸ©º      â”‚     ğŸ“Š      â”‚     ğŸ””      â”‚          âš™ï¸             â”‚
â”‚             â”‚             â”‚             â”‚             â”‚                         â”‚
â”‚   à¸‚à¹‰à¸­à¸¡à¸¹à¸¥     â”‚   à¸šà¸±à¸™à¸—à¸¶à¸    â”‚   à¸£à¸²à¸¢à¸‡à¸²à¸™    â”‚   à¹à¸ˆà¹‰à¸‡à¹€à¸•à¸·à¸­à¸™  â”‚        à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸²          â”‚
â”‚   à¸‚à¸­à¸‡à¸„à¸¸à¸“     â”‚   à¸ªà¸¸à¸‚à¸ à¸²à¸    â”‚   à¸ªà¸¸à¸‚à¸ à¸²à¸    â”‚             â”‚                         â”‚
â”‚             â”‚   (NEW!)    â”‚             â”‚             â”‚                         â”‚
â”‚   [LIFF]    â”‚   [LIFF]    â”‚  [Message]  â”‚   [LIFF]    â”‚        [LIFF]           â”‚
â”‚  /profile   â”‚ /health-log â”‚   #à¸£à¸²à¸¢à¸‡à¸²à¸™   â”‚  /reminders â”‚       /settings         â”‚
â”‚             â”‚             â”‚             â”‚             â”‚                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“… Changelog

| Date | Version | Changes |
|------|---------|---------|
| 2025-12-21 | v2.1 | à¹€à¸à¸´à¹ˆà¸¡ LIFF Pages: health-log.html (dashboard), log-medication.html, log-symptom.html - à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™ Rich Menu action à¸ˆà¸²à¸ message à¹€à¸›à¹‡à¸™ LIFF URI |
| 2025-12-21 | v2.0 | à¹€à¸à¸´à¹ˆà¸¡ "à¸šà¸±à¸™à¸—à¸¶à¸à¸ªà¸¸à¸‚à¸ à¸²à¸" à¹€à¸›à¹‡à¸™à¹€à¸¡à¸™à¸¹à¸—à¸µà¹ˆ 2 (5 menus) - à¸„à¸£à¸­à¸šà¸„à¸¥à¸¸à¸¡ à¸¢à¸², à¸„à¸§à¸²à¸¡à¸”à¸±à¸™, à¸™à¹‰à¸³, à¸­à¸­à¸à¸à¸³à¸¥à¸±à¸‡à¸à¸²à¸¢, à¸™à¸­à¸™, à¸­à¸²à¸à¸²à¸£, à¸­à¸²à¸£à¸¡à¸“à¹Œ |
| 2025-12-18 | v1.0 | Initial 4 menus layout |

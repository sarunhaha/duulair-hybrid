# Medication Reminder System

> Smart medication tracking and reminder system for elderly care

---

## Feature Name
Medication Reminder & Tracking System

## Overview
‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏¢‡∏≤‡∏≠‡∏±‡∏à‡∏â‡∏£‡∏¥‡∏¢‡∏∞‡∏ó‡∏µ‡πà‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ú‡∏π‡πâ‡∏™‡∏π‡∏á‡∏≠‡∏≤‡∏¢‡∏∏‡∏Å‡∏¥‡∏ô‡∏¢‡∏≤‡∏ï‡∏≤‡∏°‡πÄ‡∏ß‡∏•‡∏≤ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏Å‡∏¥‡∏ô‡∏¢‡∏≤
‡πÅ‡∏•‡∏∞‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ç‡∏≤‡∏ï‡∏¥‡∏´‡∏≤‡∏Å‡∏•‡∏∑‡∏°‡∏Å‡∏¥‡∏ô‡∏¢‡∏≤ ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏´‡∏•‡∏≤‡∏¢‡∏°‡∏∑‡πâ‡∏≠ ‡πÅ‡∏•‡∏∞ schedule ‡∏ó‡∏µ‡πà‡∏ã‡∏±‡∏ö‡∏ã‡πâ‡∏≠‡∏ô

## User Story
**As a** ‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏¥‡∏ô‡∏¢‡∏≤‡∏´‡∏•‡∏≤‡∏¢‡∏ä‡∏ô‡∏¥‡∏î
**I want** ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏Å‡∏¥‡∏ô‡∏¢‡∏≤‡∏ï‡∏≤‡∏°‡πÄ‡∏ß‡∏•‡∏≤‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
**So that** ‡πÑ‡∏°‡πà‡∏•‡∏∑‡∏°‡∏Å‡∏¥‡∏ô‡∏¢‡∏≤‡πÅ‡∏•‡∏∞‡∏ç‡∏≤‡∏ï‡∏¥‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡πÑ‡∏î‡πâ

## Requirements

### Functional Requirements
- [ ] FR-1: ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏¢‡∏≤‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏ß‡∏•‡∏≤‡∏Å‡∏¥‡∏ô‡∏¢‡∏≤ (‡πÄ‡∏ä‡πâ‡∏≤, ‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏ô, ‡πÄ‡∏¢‡πá‡∏ô, ‡∏Å‡πà‡∏≠‡∏ô‡∏ô‡∏≠‡∏ô)
- [ ] FR-2: ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö schedule ‡∏ã‡∏±‡∏ö‡∏ã‡πâ‡∏≠‡∏ô (‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô, ‡∏ß‡∏±‡∏ô‡πÄ‡∏ß‡πâ‡∏ô‡∏ß‡∏±‡∏ô, ‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏•‡∏∞‡∏Ñ‡∏£‡∏±‡πâ‡∏á)
- [ ] FR-3: ‡∏™‡πà‡∏á LINE notification ‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏Å‡∏¥‡∏ô‡∏¢‡∏≤‡∏•‡πà‡∏ß‡∏á‡∏´‡∏ô‡πâ‡∏≤ 15 ‡∏ô‡∏≤‡∏ó‡∏µ
- [ ] FR-4: ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ï‡∏≠‡∏ö‡∏£‡∏±‡∏ö‡∏ß‡πà‡∏≤‡∏Å‡∏¥‡∏ô‡∏¢‡∏≤‡πÅ‡∏•‡πâ‡∏ß‡∏ú‡πà‡∏≤‡∏ô Quick Reply
- [ ] FR-5: ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ç‡∏≤‡∏ï‡∏¥‡∏´‡∏≤‡∏Å‡πÑ‡∏°‡πà‡∏ï‡∏≠‡∏ö‡∏£‡∏±‡∏ö‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 30 ‡∏ô‡∏≤‡∏ó‡∏µ
- [ ] FR-6: ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏Å‡∏¥‡∏ô‡∏¢‡∏≤‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á (‡∏Å‡∏¥‡∏ô‡∏ï‡∏£‡∏á‡πÄ‡∏ß‡∏•‡∏≤/‡∏™‡∏≤‡∏¢/‡∏•‡∏∑‡∏°)
- [ ] FR-7: ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏Å‡∏¥‡∏ô‡∏¢‡∏≤‡∏£‡∏≤‡∏¢ ‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
- [ ] FR-8: ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏¢‡∏≤‡πÉ‡∏Å‡∏•‡πâ‡∏´‡∏°‡∏î (‡πÄ‡∏´‡∏•‡∏∑‡∏≠ 3 ‡∏ß‡∏±‡∏ô)
- [ ] FR-9: OCR ‡∏≠‡πà‡∏≤‡∏ô‡∏â‡∏•‡∏≤‡∏Å‡∏¢‡∏≤‡∏à‡∏≤‡∏Å‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û
- [ ] FR-10: ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö drug interaction (‡∏¢‡∏≤‡∏ó‡∏µ‡πà‡∏´‡πâ‡∏≤‡∏°‡∏Å‡∏¥‡∏ô‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ô)

### Technical Requirements
- [ ] TR-1: ‡πÉ‡∏ä‡πâ Supabase Cron Jobs ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö scheduled reminders
- [ ] TR-2: LINE Messaging API ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡πà‡∏á notifications
- [ ] TR-3: Claude API ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö OCR ‡πÅ‡∏•‡∏∞ NLP
- [ ] TR-4: Edge Functions ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö real-time notifications
- [ ] TR-5: Response time < 3 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ

### Non-Functional Requirements
- [ ] NFR-1: Notification ‡∏ï‡πâ‡∏≠‡∏á‡∏™‡πà‡∏á‡∏ï‡∏£‡∏á‡πÄ‡∏ß‡∏•‡∏≤ (¬±1 minute)
- [ ] NFR-2: ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö timezone ‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ
- [ ] NFR-3: Retry mechanism ‡∏´‡∏≤‡∏Å LINE API fail
- [ ] NFR-4: Audit log ‡∏ó‡∏∏‡∏Å medication event

## Implementation Details

### Files to Create
```
src/
  ‚îú‚îÄ‚îÄ agents/specialized/MedicationAgent.ts (NEW)
  ‚îú‚îÄ‚îÄ agents/specialized/MedicationAgent.test.ts (NEW)
  ‚îú‚îÄ‚îÄ services/medication.service.ts (NEW)
  ‚îú‚îÄ‚îÄ services/notification.service.ts (NEW)
  ‚îî‚îÄ‚îÄ types/medication.types.ts (NEW)
```

### Files to Modify
- `src/agents/core/OrchestratorAgent.ts` - Route medication intents
- `src/agents/specialized/HealthAgent.ts` - Integration
- `docs/database-schema.sql` - Add medication tables

### Dependencies
- [ ] No new npm packages (‡πÉ‡∏ä‡πâ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà)
- [ ] Supabase Cron/Edge Functions (already available)
- [ ] LINE Messaging API (already integrated)
- [ ] Claude API (already integrated)

## Data Model

### Database Schema
```sql
-- Medications table
CREATE TABLE medications (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  patient_id UUID REFERENCES patients(id) NOT NULL,
  name VARCHAR(255) NOT NULL,
  dosage VARCHAR(100), -- "1 ‡πÄ‡∏°‡πá‡∏î", "10 mg"
  type VARCHAR(50), -- "tablet", "capsule", "syrup"
  purpose TEXT, -- ‡πÑ‡∏ß‡πâ‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏≠‡∏∞‡πÑ‡∏£
  side_effects TEXT[],
  warnings TEXT[],
  image_url TEXT, -- ‡∏£‡∏π‡∏õ‡∏¢‡∏≤
  stock_quantity INTEGER DEFAULT 0,
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW()
);

-- Medication schedules
CREATE TABLE medication_schedules (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  medication_id UUID REFERENCES medications(id) NOT NULL,
  time_of_day TIME NOT NULL, -- "08:00", "12:00", "18:00", "21:00"
  frequency VARCHAR(50) NOT NULL, -- "daily", "alternate_days", "weekly"
  days_of_week INTEGER[], -- [1,2,3,4,5,6,7] for daily, [1,3,5] for MWF
  remind_before_minutes INTEGER DEFAULT 15,
  is_active BOOLEAN DEFAULT TRUE,
  created_at TIMESTAMP DEFAULT NOW()
);

-- Medication intake logs
CREATE TABLE medication_logs (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  medication_id UUID REFERENCES medications(id) NOT NULL,
  schedule_id UUID REFERENCES medication_schedules(id),
  patient_id UUID REFERENCES patients(id) NOT NULL,
  scheduled_time TIMESTAMP NOT NULL,
  taken_at TIMESTAMP,
  status VARCHAR(20) CHECK (status IN ('taken', 'missed', 'late', 'pending')),
  notes TEXT,
  reminded_at TIMESTAMP,
  confirmed_at TIMESTAMP,
  created_at TIMESTAMP DEFAULT NOW()
);

-- Medication interactions (drug-drug interaction)
CREATE TABLE medication_interactions (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  medication_a_name VARCHAR(255) NOT NULL,
  medication_b_name VARCHAR(255) NOT NULL,
  severity VARCHAR(20) CHECK (severity IN ('minor', 'moderate', 'major')),
  description TEXT,
  recommendation TEXT
);

-- Indexes
CREATE INDEX idx_medication_patient ON medications(patient_id);
CREATE INDEX idx_schedule_medication ON medication_schedules(medication_id);
CREATE INDEX idx_logs_patient_time ON medication_logs(patient_id, scheduled_time DESC);
CREATE INDEX idx_logs_status ON medication_logs(status, scheduled_time);
```

### TypeScript Types
```typescript
interface Medication {
  id: string;
  patientId: string;
  name: string;
  dosage: string;
  type: 'tablet' | 'capsule' | 'syrup' | 'injection' | 'other';
  purpose?: string;
  sideEffects?: string[];
  warnings?: string[];
  imageUrl?: string;
  stockQuantity: number;
  createdAt: Date;
  updatedAt: Date;
}

interface MedicationSchedule {
  id: string;
  medicationId: string;
  timeOfDay: string; // "HH:mm" format
  frequency: 'daily' | 'alternate_days' | 'weekly' | 'custom';
  daysOfWeek?: number[]; // 1-7 (Mon-Sun)
  remindBeforeMinutes: number;
  isActive: boolean;
  createdAt: Date;
}

interface MedicationLog {
  id: string;
  medicationId: string;
  scheduleId?: string;
  patientId: string;
  scheduledTime: Date;
  takenAt?: Date;
  status: 'taken' | 'missed' | 'late' | 'pending';
  notes?: string;
  remindedAt?: Date;
  confirmedAt?: Date;
  createdAt: Date;
}

interface MedicationReminder {
  medication: Medication;
  schedule: MedicationSchedule;
  scheduledTime: Date;
  message: string;
}

interface MedicationStats {
  total: number;
  taken: number;
  missed: number;
  late: number;
  adherenceRate: number; // percentage
  trend: 'improving' | 'stable' | 'declining';
}
```

## API Design

### Agent Methods
```typescript
class MedicationAgent extends BaseAgent {
  /**
   * Add new medication
   */
  async addMedication(params: {
    patientId: string;
    name: string;
    dosage: string;
    schedules: MedicationSchedule[];
  }): Promise<Medication>

  /**
   * Add medication from OCR (photo of label)
   */
  async addMedicationFromImage(params: {
    patientId: string;
    imageUrl: string;
  }): Promise<Medication>

  /**
   * Log medication intake
   */
  async logIntake(params: {
    medicationId: string;
    scheduledTime: Date;
    status: 'taken' | 'missed' | 'late';
    notes?: string;
  }): Promise<MedicationLog>

  /**
   * Get upcoming medications (next 24 hours)
   */
  async getUpcomingMedications(
    patientId: string
  ): Promise<MedicationReminder[]>

  /**
   * Get medication adherence stats
   */
  async getAdherenceStats(
    patientId: string,
    days: number = 30
  ): Promise<MedicationStats>

  /**
   * Check drug interactions
   */
  async checkInteractions(
    patientId: string,
    newMedicationName?: string
  ): Promise<Interaction[]>

  /**
   * Send reminder notification
   */
  private async sendReminder(
    reminder: MedicationReminder
  ): Promise<void>

  /**
   * Process confirmation (when user replies "‡∏Å‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß")
   */
  async processConfirmation(params: {
    patientId: string;
    medicationId: string;
  }): Promise<MedicationLog>
}
```

### Notification Service
```typescript
class NotificationService {
  /**
   * Send LINE notification
   */
  async sendLineNotification(params: {
    userId: string;
    message: string;
    quickReplies?: QuickReply[];
  }): Promise<void>

  /**
   * Schedule notification
   */
  async scheduleNotification(params: {
    userId: string;
    scheduledTime: Date;
    message: string;
    type: 'medication' | 'appointment' | 'checkup';
  }): Promise<void>

  /**
   * Send to caregiver
   */
  async notifyCaregiver(params: {
    patientId: string;
    message: string;
    severity: 'info' | 'warning' | 'urgent';
  }): Promise<void>
}
```

## Testing Strategy

### Unit Tests
- Test medication creation and scheduling
- Test adherence calculation
- Test drug interaction checking
- Test OCR parsing (mock Claude API)
- Test notification scheduling

### Integration Tests
- Test with real LINE API (dev account)
- Test Supabase cron jobs
- Test full reminder flow
- Test caregiver notifications

### Test Scenarios
1. **Happy Path**: ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏Å‡∏¥‡∏ô‡∏¢‡∏≤‡∏ï‡∏£‡∏á‡πÄ‡∏ß‡∏•‡∏≤ ‚Üí Log as "taken"
2. **Late**: ‡∏Å‡∏¥‡∏ô‡∏¢‡∏≤‡∏ä‡πâ‡∏≤ 1 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á ‚Üí Log as "late"
3. **Missed**: ‡πÑ‡∏°‡πà‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö 2 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á ‚Üí Log as "missed" + notify caregiver
4. **Multiple Meds**: ‡∏Å‡∏¥‡∏ô‡∏¢‡∏≤‡∏´‡∏•‡∏≤‡∏¢‡∏ä‡∏ô‡∏¥‡∏î‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ô ‚Üí Group notifications
5. **OCR**: ‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ‡∏â‡∏•‡∏≤‡∏Å‡∏¢‡∏≤ ‚Üí Parse ‡∏ä‡∏∑‡πà‡∏≠, ‡∏Ç‡∏ô‡∏≤‡∏î, ‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ
6. **Interaction**: ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏¢‡∏≤‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏µ‡πà‡∏°‡∏µ interaction ‚Üí ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
7. **Low Stock**: ‡∏¢‡∏≤‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏ô‡πâ‡∏≠‡∏¢ ‚Üí ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠

## Acceptance Criteria

### Definition of Done
- [ ] MedicationAgent created ‡πÅ‡∏•‡∏∞‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏Ñ‡∏£‡∏ö
- [ ] Database tables created ‡πÅ‡∏•‡∏∞ indexed
- [ ] Notification service integrated
- [ ] OCR ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏â‡∏•‡∏≤‡∏Å‡∏¢‡∏≤‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ
- [ ] Unit tests >85% coverage
- [ ] Integration tests ‡∏ú‡πà‡∏≤‡∏ô‡∏´‡∏°‡∏î
- [ ] Documentation complete

### Success Metrics
- [ ] Reminder ‡∏™‡πà‡∏á‡∏ï‡∏£‡∏á‡πÄ‡∏ß‡∏•‡∏≤ >99%
- [ ] Notification delivery rate >95%
- [ ] OCR accuracy >90%
- [ ] Response time <3s
- [ ] Adherence tracking accurate

## Timeline

### Estimated Effort
- Planning: 2 hours
- Implementation: 12 hours
  - MedicationAgent: 4 hours
  - Database & Services: 3 hours
  - Notifications: 3 hours
  - OCR Integration: 2 hours
- Testing: 4 hours
- Documentation: 2 hours
- **Total**: 20 hours (2.5 days)

### Milestones
- [ ] M1: Database schema & basic CRUD (Day 1)
- [ ] M2: Scheduling & reminders working (Day 2)
- [ ] M3: OCR & interactions (Day 2)
- [ ] M4: Tests & docs complete (Day 3)

## Examples

### Input Examples

```typescript
// LINE message: ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏¢‡∏≤
"‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏¢‡∏≤ Metformin 500mg ‡∏Å‡∏¥‡∏ô‡∏ß‡∏±‡∏ô‡∏•‡∏∞ 2 ‡πÄ‡∏°‡πá‡∏î ‡πÄ‡∏ä‡πâ‡∏≤-‡πÄ‡∏¢‡πá‡∏ô"

// LINE message: ‡∏™‡πà‡∏á‡∏£‡∏π‡∏õ‡∏¢‡∏≤
[Image of medication label]

// LINE message: ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏¥‡∏ô‡∏¢‡∏≤
"‡∏Å‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß" or "‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏Å‡∏¥‡∏ô"

// Quick Reply options
["‚úÖ ‡∏Å‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß", "‚è∞ ‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á", "‚ùå ‡∏Ç‡πâ‡∏≤‡∏°"]
```

### Output Examples

```typescript
// Reminder notification
{
  type: "flex",
  altText: "‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏Å‡∏¥‡∏ô‡∏¢‡∏≤: Metformin",
  contents: {
    type: "bubble",
    header: {
      type: "box",
      contents: [{
        type: "text",
        text: "‚è∞ ‡πÄ‡∏ß‡∏•‡∏≤‡∏Å‡∏¥‡∏ô‡∏¢‡∏≤‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏∞",
        weight: "bold"
      }]
    },
    body: {
      type: "box",
      contents: [
        { type: "text", text: "üíä Metformin 500mg" },
        { type: "text", text: "üìã 1 ‡πÄ‡∏°‡πá‡∏î ‡∏´‡∏•‡∏±‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÄ‡∏¢‡πá‡∏ô" },
        { type: "text", text: "üïê 18:00 ‡∏ô." }
      ]
    }
  },
  quickReply: {
    items: [
      { action: { type: "message", label: "‚úÖ ‡∏Å‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß", text: "‡∏Å‡∏¥‡∏ô‡∏¢‡∏≤ Metformin ‡πÅ‡∏•‡πâ‡∏ß" }},
      { action: { type: "message", label: "‚è∞ ‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á", text: "‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏≠‡∏µ‡∏Å 15 ‡∏ô‡∏≤‡∏ó‡∏µ" }},
      { action: { type: "message", label: "‚ùå ‡∏Ç‡πâ‡∏≤‡∏°‡∏°‡∏∑‡πâ‡∏≠‡∏ô‡∏µ‡πâ", text: "‡∏Ç‡πâ‡∏≤‡∏°‡∏¢‡∏≤ Metformin" }}
    ]
  }
}

// Adherence stats
{
  period: "30 days",
  medications: [
    {
      name: "Metformin",
      total: 60,
      taken: 58,
      missed: 2,
      adherenceRate: 96.7
    }
  ],
  overall: {
    adherenceRate: 94.5,
    trend: "stable"
  }
}

// Drug interaction warning
{
  severity: "moderate",
  medications: ["Warfarin", "Aspirin"],
  warning: "‡∏¢‡∏≤ Warfarin ‡πÅ‡∏•‡∏∞ Aspirin ‡∏≠‡∏≤‡∏à‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏î‡∏≠‡∏≠‡∏Å",
  recommendation: "‡∏Ñ‡∏ß‡∏£‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤‡πÅ‡∏û‡∏ó‡∏¢‡πå‡∏Å‡πà‡∏≠‡∏ô‡πÉ‡∏ä‡πâ‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ô"
}
```

## Notes

### Timezone Handling
- ‡πÄ‡∏Å‡πá‡∏ö schedule ‡πÄ‡∏õ‡πá‡∏ô local time ‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ
- Convert ‡πÄ‡∏õ‡πá‡∏ô UTC ‡πÄ‡∏°‡∏∑‡πà‡∏≠ schedule cron jobs
- ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÄ‡∏õ‡πá‡∏ô local time

### Notification Best Practices
- Group multiple meds ‡πÉ‡∏ô‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô
- ‡πÑ‡∏°‡πà spam notification (max 3 reminders)
- Escalate to caregiver ‡∏´‡∏≤‡∏Å‡πÑ‡∏°‡πà‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö

### OCR Considerations
- ‡πÉ‡∏ä‡πâ Claude Vision API
- Extract: ‡∏ä‡∏∑‡πà‡∏≠‡∏¢‡∏≤, ‡∏Ç‡∏ô‡∏≤‡∏î, ‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ, ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏£‡∏£‡∏∞‡∏ß‡∏±‡∏á
- Validate ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡πà‡∏≠‡∏ô‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å

---

**Created**: 2024-01-16
**Author**: Auto-spec
**Priority**: High (Core feature for elderly care)
**Status**: Ready for implementation

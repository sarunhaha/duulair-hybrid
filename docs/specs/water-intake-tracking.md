# Water Intake Tracking

> Smart water drinking reminder and tracking system

---

## Feature Name
Water Intake Tracking & Reminder

## Overview
‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏ô‡πâ‡∏≥‡∏ó‡∏µ‡πà‡∏î‡∏∑‡πà‡∏°‡∏ï‡πà‡∏≠‡∏ß‡∏±‡∏ô ‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏î‡∏∑‡πà‡∏°‡∏ô‡πâ‡∏≥‡∏™‡∏°‡πà‡∏≥‡πÄ‡∏™‡∏°‡∏≠ ‡πÅ‡∏•‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏î‡∏∑‡πà‡∏°‡∏ô‡πâ‡∏≥
‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏™‡∏π‡∏á‡∏≠‡∏≤‡∏¢‡∏∏‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏°‡∏ô‡πâ‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠‡∏ï‡πà‡∏≠‡∏ß‡∏±‡∏ô

## User Story
**As a** ‡∏ú‡∏π‡πâ‡∏™‡∏π‡∏á‡∏≠‡∏≤‡∏¢‡∏∏
**I want** ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÅ‡∏•‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏î‡∏∑‡πà‡∏°‡∏ô‡πâ‡∏≥
**So that** ‡∏î‡∏∑‡πà‡∏°‡∏ô‡πâ‡∏≥‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠ 2000ml/‡∏ß‡∏±‡∏ô ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏†‡∏≤‡∏ß‡∏∞‡∏Ç‡∏≤‡∏î‡∏ô‡πâ‡∏≥

## Requirements

### Functional Requirements
- [ ] FR-1: ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏ô‡πâ‡∏≥‡∏ó‡∏µ‡πà‡∏î‡∏∑‡πà‡∏°‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Ñ‡∏£‡∏±‡πâ‡∏á (ml)
- [ ] FR-2: ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏¢‡πà‡∏≠ ‡πÄ‡∏ä‡πà‡∏ô "‡∏î‡∏∑‡πà‡∏°‡∏ô‡πâ‡∏≥ 1 ‡πÅ‡∏Å‡πâ‡∏ß" = 250ml
- [ ] FR-3: ‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏î‡∏∑‡πà‡∏°‡∏ô‡πâ‡∏≥‡∏ï‡πà‡∏≠‡∏ß‡∏±‡∏ô (default 2000ml, ‡∏õ‡∏£‡∏±‡∏ö‡πÑ‡∏î‡πâ‡∏ï‡∏≤‡∏°‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å/‡∏≠‡∏≤‡∏¢‡∏∏)
- [ ] FR-4: ‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏î‡∏∑‡πà‡∏°‡∏ô‡πâ‡∏≥‡∏ó‡∏∏‡∏Å 2 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á (customize ‡πÑ‡∏î‡πâ)
- [ ] FR-5: ‡πÅ‡∏™‡∏î‡∏á progress bar ‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏ô‡πâ‡∏≥‡∏ï‡πà‡∏≠‡∏ß‡∏±‡∏ô
- [ ] FR-6: ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô/‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
- [ ] FR-7: ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ñ‡πâ‡∏≤‡∏î‡∏∑‡πà‡∏°‡∏ô‡πâ‡∏≥‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤ 50% ‡∏Ç‡∏≠‡∏á‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢
- [ ] FR-8: Integration ‡∏Å‡∏±‡∏ö weather API (‡∏î‡∏∑‡πà‡∏°‡∏°‡∏≤‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡∏£‡πâ‡∏≠‡∏ô)

### Technical Requirements
- [ ] TR-1: ‡πÉ‡∏ä‡πâ Supabase ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏Å‡πá‡∏ö logs
- [ ] TR-2: Real-time update progress
- [ ] TR-3: Cache daily total ‡∏•‡∏î queries
- [ ] TR-4: Notification scheduling

## Implementation Details

### Files to Create
```
src/
  ‚îî‚îÄ‚îÄ agents/specialized/WaterIntakeAgent.ts (NEW)
```

### Files to Modify
- `src/agents/specialized/HealthAgent.ts` - Add water tracking

## Data Model

### Database Schema
```sql
CREATE TABLE water_intake_logs (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  patient_id UUID REFERENCES patients(id) NOT NULL,
  amount_ml INTEGER NOT NULL,
  logged_at TIMESTAMP DEFAULT NOW(),
  type VARCHAR(50), -- 'water', 'juice', 'coffee', 'other'
  source VARCHAR(50), -- 'manual', 'quick_reply', 'reminder'
  notes TEXT,
  created_at TIMESTAMP DEFAULT NOW()
);

CREATE TABLE water_intake_settings (
  patient_id UUID PRIMARY KEY REFERENCES patients(id),
  daily_goal_ml INTEGER DEFAULT 2000,
  reminder_interval_hours INTEGER DEFAULT 2,
  reminder_start_time TIME DEFAULT '07:00',
  reminder_end_time TIME DEFAULT '21:00',
  weight_kg DECIMAL(5,2), -- ‡πÉ‡∏ä‡πâ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢
  updated_at TIMESTAMP DEFAULT NOW()
);

CREATE INDEX idx_water_logs_patient_date ON water_intake_logs(patient_id, DATE(logged_at));
```

### TypeScript Types
```typescript
interface WaterIntakeLog {
  id: string;
  patientId: string;
  amountMl: number;
  loggedAt: Date;
  type: 'water' | 'juice' | 'coffee' | 'tea' | 'other';
  source: 'manual' | 'quick_reply' | 'reminder';
  notes?: string;
}

interface WaterIntakeSettings {
  patientId: string;
  dailyGoalMl: number;
  reminderIntervalHours: number;
  reminderStartTime: string;
  reminderEndTime: string;
  weightKg?: number;
}

interface WaterIntakeStats {
  today: {
    total: number;
    goal: number;
    percentage: number;
    remaining: number;
  };
  week: {
    average: number;
    daysMetGoal: number;
    trend: 'increasing' | 'stable' | 'decreasing';
  };
}

// Preset amounts
const WATER_PRESETS = {
  '1 ‡πÅ‡∏Å‡πâ‡∏ß': 250,
  '‡∏Ñ‡∏£‡∏∂‡πà‡∏á‡πÅ‡∏Å‡πâ‡∏ß': 125,
  '1 ‡∏Ç‡∏ß‡∏î': 500,
  '1 ‡∏•‡∏¥‡∏ï‡∏£': 1000
};
```

## API Design

```typescript
class WaterIntakeAgent extends BaseAgent {
  async logWater(params: {
    patientId: string;
    amountMl: number;
    type?: string;
  }): Promise<WaterIntakeLog>

  async getTodayStats(patientId: string): Promise<WaterIntakeStats>

  async updateGoal(params: {
    patientId: string;
    dailyGoalMl?: number;
    reminderInterval?: number;
  }): Promise<WaterIntakeSettings>

  // Calculate goal based on weight (30ml per kg)
  async calculateRecommendedGoal(weightKg: number): Promise<number>
}
```

## Testing Strategy

### Test Scenarios
1. **Basic**: "‡∏î‡∏∑‡πà‡∏°‡∏ô‡πâ‡∏≥ 250" ‚Üí ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å 250ml
2. **Preset**: "‡∏î‡∏∑‡πà‡∏°‡∏ô‡πâ‡∏≥ 1 ‡πÅ‡∏Å‡πâ‡∏ß" ‚Üí 250ml
3. **Multiple**: ‡∏î‡∏∑‡πà‡∏°‡∏´‡∏•‡∏≤‡∏¢‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ï‡πà‡∏≠‡∏ß‡∏±‡∏ô ‚Üí ‡∏£‡∏ß‡∏°‡∏¢‡∏≠‡∏î
4. **Goal Met**: ‡∏î‡∏∑‡πà‡∏°‡∏Ñ‡∏£‡∏ö 2000ml ‚Üí ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏¥‡∏ô‡∏î‡∏µ
5. **Reminder**: ‡πÑ‡∏°‡πà‡∏î‡∏∑‡πà‡∏° 2 ‡∏ä‡∏° ‚Üí ‡∏™‡πà‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô

## Timeline

**Estimated**: 6 hours (1 day)

## Examples

### Input
```
"‡∏î‡∏∑‡πà‡∏°‡∏ô‡πâ‡∏≥ 250"
"‡∏î‡∏∑‡πà‡∏°‡∏ô‡πâ‡∏≥ 1 ‡πÅ‡∏Å‡πâ‡∏ß"
"‡∏î‡∏∑‡πà‡∏°‡∏ô‡πâ‡∏≥ 1 ‡∏Ç‡∏ß‡∏î"
```

### Output
```json
{
  "message": "‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏∞ ‡∏î‡∏∑‡πà‡∏°‡∏ô‡πâ‡∏≥‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß 1,250ml ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ üéØ",
  "progress": {
    "current": 1250,
    "goal": 2000,
    "percentage": 62.5,
    "remaining": 750
  }
}
```

---

**Created**: 2024-01-16
**Priority**: Medium
**Status**: Ready for implementation
